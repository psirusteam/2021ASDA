<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.6 Funciones mutate, summarise y group_by en encuestas de hogares | 03-Basesdedatos.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content="1.6 Funciones mutate, summarise y group_by en encuestas de hogares | 03-Basesdedatos.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.6 Funciones mutate, summarise y group_by en encuestas de hogares | 03-Basesdedatos.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="el-operador-pipe.html"/>
<link rel="next" href="medidas-descriptivos-y-reflexiones.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Análisis de encuestas con R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="manejando-una-base-de-encuestas-de-hogares-con-r.html"><a href="manejando-una-base-de-encuestas-de-hogares-con-r.html"><i class="fa fa-check"></i><b>1</b> Manejando una base de encuestas de hogares con R</a>
<ul>
<li class="chapter" data-level="1.1" data-path=""><a href="#fundamentos-b%C3%A1sicos-de-r-y-rstudio"><i class="fa fa-check"></i><b>1.1</b> Fundamentos básicos de R y Rstudio</a></li>
<li class="chapter" data-level="1.2" data-path=""><a href="#algunas-librer%C3%ADas-de-inter%C3%A9s"><i class="fa fa-check"></i><b>1.2</b> Algunas librerías de interés</a></li>
<li class="chapter" data-level="1.3" data-path=""><a href="#craci%C3%B3n-de-proyectos-en-r"><i class="fa fa-check"></i><b>1.3</b> Cración de proyectos en <code>R</code></a></li>
<li class="chapter" data-level="1.4" data-path=""><a href="#lectura-de-las-bases-de-datos-y-manipulaci%C3%B3n"><i class="fa fa-check"></i><b>1.4</b> Lectura de las bases de datos y manipulación</a></li>
<li class="chapter" data-level="1.5" data-path="el-operador-pipe.html"><a href="el-operador-pipe.html"><i class="fa fa-check"></i><b>1.5</b> El operador <code>pipe</code></a></li>
<li class="chapter" data-level="1.6" data-path="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html"><i class="fa fa-check"></i><b>1.6</b> Funciones <strong>mutate, summarise y group_by</strong> en encuestas de hogares</a></li>
<li class="chapter" data-level="1.7" data-path="medidas-descriptivos-y-reflexiones.html"><a href="medidas-descriptivos-y-reflexiones.html"><i class="fa fa-check"></i><b>1.7</b> Medidas descriptivos y reflexiones</a></li>
<li class="chapter" data-level="1.8" data-path="algunas-reflexiones-generales.html"><a href="algunas-reflexiones-generales.html"><i class="fa fa-check"></i><b>1.8</b> Algunas reflexiones generales</a></li>
<li class="chapter" data-level="1.9" data-path=""><a href="#observaci%C3%B3n-importante"><i class="fa fa-check"></i><b>1.9</b> <strong>¡Observación importante!</strong></a></li>
<li class="chapter" data-level="1.10" data-path="medias-y-totales.html"><a href="medias-y-totales.html"><i class="fa fa-check"></i><b>1.10</b> Medias y totales</a></li>
<li class="chapter" data-level="1.11" data-path="medianas-y-percentiles.html"><a href="medianas-y-percentiles.html"><i class="fa fa-check"></i><b>1.11</b> Medianas y percentiles</a></li>
<li class="chapter" data-level="1.12" data-path=""><a href="#varianza-desviaci%C3%B3n-est%C3%A1ndar-y-rangos"><i class="fa fa-check"></i><b>1.12</b> Varianza, desviación estándar y rangos</a></li>
</ul></li>
<li class="divider"></li>
<li><a Análisis de encuestas con R </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares" class="section level2 hasAnchor" number="1.6">
<h2><span class="header-section-number">1.6</span> Funciones <strong>mutate, summarise y group_by</strong> en encuestas de hogares<a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html#funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Las funciones <code>mutate</code>, <code>summarise</code> y <code>group_by</code> están cargadas en el paquete <code>tidyverse</code> y son muy importantes al momento de realizar análisis en encuestas de hogares. En primer lugar, la función <code>mutate</code> permite computar transformaciones de variables en una base de datos. Usualmente, en las encuestas de hogares es necesario crear nuevas variables, por ejemplo, si el hogar está en estado de pobreza extrema o no la cual se calcula a partir de los ingresos del hogar, la función <code>mutate</code> proporciona una interface clara para realizar este tipo de operaciones. A modo de ejemplo, utilizaremos la base de ejemplo para crear una nueva variable llamada <em>ingreso2</em> la cual es el doble de los ingresos por persona dentro de un hogar. Los códigos computacionales se muestran a continuación:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html#cb31-1" tabindex="-1"></a>datablue2 <span class="ot">&lt;-</span> datablue <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html#cb31-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ingreso2 =</span> <span class="dv">2</span> <span class="sc">*</span> ingcorte)</span>
<span id="cb31-3"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html#cb31-3" tabindex="-1"></a>datablue2 <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##   id_pers edad   sexo ingcorte ingreso2
## 1       1   23 Hombre    800.0   1600.0
## 2       1   23  Mujer   1150.0   2300.0
## 3       1   35  Mujer    904.4   1808.8
## 4       2   34 Hombre    904.4   1808.8
## 5       3   11  Mujer    904.4   1808.8
## 6       4    7  Mujer    904.4   1808.8</code></pre>
<p>No solo se puede crear una nueva variable, si es necesario, se pueden crear más de una variable en la base de datos. Cabe recalcar que la función <code>mutate</code> reconoce sistemáticamente las variables que van siendo creadas de manera ordenada. A continuación, se presenta cómo crear más de una nueva variable en la base de datos:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html#cb33-1" tabindex="-1"></a>datacat <span class="ot">&lt;-</span> datablue <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html#cb33-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ingreso2 =</span> <span class="dv">2</span> <span class="sc">*</span> ingcorte,</span>
<span id="cb33-3"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html#cb33-3" tabindex="-1"></a>         <span class="at">ingreso4 =</span> <span class="dv">2</span> <span class="sc">*</span> ingreso2)</span>
<span id="cb33-4"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html#cb33-4" tabindex="-1"></a>datacat <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##   id_pers edad   sexo ingcorte ingreso2 ingreso4
## 1       1   23 Hombre    800.0   1600.0   3200.0
## 2       1   23  Mujer   1150.0   2300.0   4600.0
## 3       1   35  Mujer    904.4   1808.8   3617.6
## 4       2   34 Hombre    904.4   1808.8   3617.6
## 5       3   11  Mujer    904.4   1808.8   3617.6
## 6       4    7  Mujer    904.4   1808.8   3617.6</code></pre>
<p>Ahora bien, la función <code>summarise</code> funciona de forma similar a la función <code>mutate</code>, excepto que en lugar de añadir nuevas columnas crea un nuevo data frame. Como se mencionó anteriormente esta función sirve para resumir o “colapsar filas”. Toma un grupo de valores como input y devuelve un solo valor; por ejemplo, hallar la media de los ingresos, percentiles o medidas de dispersión.</p>
<p>Por otro lado, la función <code>group_by</code> permite agrupar información de acuerdo con una(s) variable(s) de interés. El siguiente código permite generar el número de encuestas efectivas en cada uno de los estados de Brasil. El comando <code>group_by</code> agrupa los datos por estados, el comando <code>summarise</code> hace los cálculos requeridos y el comando <code>arrange</code> ordena los resultados</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html#cb35-1" tabindex="-1"></a>data2 <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html#cb35-2" tabindex="-1"></a>  <span class="fu">group_by</span>(estados) <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html#cb35-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   estados          n
##   &lt;fct&gt;        &lt;int&gt;
## 1 SaoPaulo     40008
## 2 MinasGerais  32933
## 3 RioGrandeSur 26259
## 4 Bahia        26155
## 5 RioJaneiro   25858
## 6 Para         22489</code></pre>
<p>Hay otro tipos de análisis que se quieren realizar en encuestas de hogares, por ejemplo, generar el número de encuestas efectivas discriminado por el sexo del respondiente. A continuación, se presenta el código computacional:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html#cb37-1" tabindex="-1"></a>data2 <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html#cb37-2" tabindex="-1"></a>  <span class="fu">group_by</span>(sexo) <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html#cb37-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) </span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   sexo        n
##   &lt;fct&gt;   &lt;int&gt;
## 1 Mujer  183681
## 2 Hombre 173223</code></pre>
<p>Si ahora se desea realizar la consulta del número de encuestas efectivas por área geográfica, se realiza de la siguiente manera:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html#cb39-1" tabindex="-1"></a>data2 <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html#cb39-2" tabindex="-1"></a>  <span class="fu">group_by</span>(area_ee) <span class="sc">%&gt;%</span> </span>
<span id="cb39-3"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html#cb39-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   area_ee          n
##   &lt;fct&gt;        &lt;int&gt;
## 1 Area urbana 304564
## 2 Area rural   52340</code></pre>
<p>Otras consultas que se realizan de manera frecuente en encuestas de hogares es reporta el número efectivo de encuestas clasificado por parentezco (jefe de hogar, hijos, conyugues, etc)</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html#cb41-1" tabindex="-1"></a>data2 <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html#cb41-2" tabindex="-1"></a>  <span class="fu">group_by</span>(paren_ee) <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html#cb41-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) </span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   paren_ee                n
##   &lt;fct&gt;               &lt;int&gt;
## 1 Hijos              126206
## 2 Jefe               117939
## 3 Cónyuge             73725
## 4 Otros parientes     36508
## 5 Otros no parientes   2342
## 6 Servicio doméstico    184</code></pre>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="el-operador-pipe.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="medidas-descriptivos-y-reflexiones.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": true,
    "facebook": false,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/psirusteam/2021ASDA/%s",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": false,
  "toc": {
    "collapse": "section"
  },
  "tconfig": null
});
});
</script>

</body>

</html>
