[["index.html", "Análisis de encuestas con R Prefacio", " Análisis de encuestas con R Andrés Gutiérrez1,Stalyn Guerrero2, Cristian Téllez3, Giovany Babativa4 2025-09-25 Prefacio La versión online de este libro está licenciada bajo una Licencia Internacional de Creative Commons para compartir con atribución no comercial 4.0. Este libro es el resultado de un compendio de las experiencias internacionales prácticas adquiridas por el autor como Experto Regional en Estadísticas Sociales de la CEPAL. Experto Regional en Estadísticas Sociales - Comisión Económica para América Latina y el Caribe (CEPAL) - andres.gutierrez@cepal.org↩︎ Consultor - Comisión Económica para América Latina y el Caribe (CEPAL), guerrerostalyn@gmail.com↩︎ Consultor - Comisión Económica para América Latina y el Caribe (CEPAL), cftellezp@unal.edu.co↩︎ Consultor - Comisión Económica para América Latina y el Caribe (CEPAL), gbabativam@gmail.com↩︎ "],["análisis-de-las-variables-continuas-en-encuestas-de-hogares.html", "Capítulo 1 Análisis de las variables continuas en encuestas de hogares", " Capítulo 1 Análisis de las variables continuas en encuestas de hogares Los desarrollos estadísticos están en permanente evolución, surgiendo nuevas metodologías y desarrollando nuevos enfoques en el análisis de encuestas. Estos desarrollos parten de la academia, luego son adoptados por las empresas (privadas o estatales) y entidades estatales, las cuales crean la necesidad que estos desarrollos sean incluidos en software estadísticos licenciados, proceso que puede llevar mucho tiempo. Algunos investigadores para acortar los tiempos y poner al servicio de la comunidad sus descubrimientos y desarrollos, hacen la implementación de sus metodologías en paquetes estadísticos de código abierto como R o Python. Teniendo R un mayor número de desarrollos en el procesamiento de las encuestas. Como se ha venido mencionando anteriormente, dentro del software R se disponen de múltiples librerías para el procesamiento de encuestas, estas varían dependiendo del enfoque de programación desarrollado por el autor o la necesidad que se busque suplir. Como es el objetivo de este libro y como se ha venido trabajando en los capítulos anteriores nos centraremos en las libreria survey y srvyr. Se incluiran más librerías de acuerdo a las necesidades que se presenten. "],["lectura-de-bases-de-datos-y-definición-del-diseño-muestral.html", "1.1 Lectura de bases de datos y definición del diseño muestral", " 1.1 Lectura de bases de datos y definición del diseño muestral Las bases de datos (tablas de datos) pueden estar disponibles en una variedad de formatos (.xlsx, .dat, .csv, .sav, .txt, etc.). Sin embargo, por experiencia es recomendable leer cualquiera de estos formatos y proceder inmediatamente a guardarlos en un archivo de extensión .rds, que es nativa de R. Los archivos .rds permiten almacenar cualquier objeto o información en R, como marcos de datos, vectores, matrices, listas, entre otros. Se caracterizan por su flexibilidad y compatibilidad completa con R, lo que facilita su reutilización en análisis posteriores. Por otro lado, existen otros tipos de archivos propios de R, como .Rdata. La diferencia principal es que los archivos .rds contienen un solo objeto, mientras que .Rdata puede almacenar múltiples objetos. Por ello, se recomienda trabajar preferentemente con archivos .rds. Para ejemplificar la sintaxis que se utilizará en R, se tomará la misma base del capítulo anterior, que contiene una muestra de 2,427 registros y proviene de un muestreo complejo. A continuación, se muestra cómo cargar un archivo con extensión .rds: library(tidyverse) encuesta &lt;- readRDS(&quot;Data/encuesta.rds&quot;) head(encuesta) ## HHID Stratum NIh nIh dI PersonID PSU Zone Sex Age MaritalST ## 1 idHH00031 idStrt001 9 2 4.5 idPer01 PSU0003 Rural Male 68 Married ## 2 idHH00031 idStrt001 9 2 4.5 idPer02 PSU0003 Rural Female 56 Married ## 3 idHH00031 idStrt001 9 2 4.5 idPer03 PSU0003 Rural Female 24 Married ## 4 idHH00031 idStrt001 9 2 4.5 idPer04 PSU0003 Rural Male 26 Married ## 5 idHH00031 idStrt001 9 2 4.5 idPer05 PSU0003 Rural Female 3 &lt;NA&gt; ## 6 idHH00041 idStrt001 9 2 4.5 idPer01 PSU0003 Rural Female 61 Widowed ## Income Expenditure Employment Poverty dki dk wk Region CatAge ## 1 409.87 346.34 Employed NotPoor 8 36 34.50371 Norte Más de 60 ## 2 409.87 346.34 Employed NotPoor 8 36 33.63761 Norte 46-60 ## 3 409.87 346.34 Employed NotPoor 8 36 33.63761 Norte 16-30 ## 4 409.87 346.34 Employed NotPoor 8 36 34.50371 Norte 16-30 ## 5 409.87 346.34 &lt;NA&gt; NotPoor 8 36 33.63761 Norte 0-5 ## 6 823.75 392.24 Employed NotPoor 8 36 33.63761 Norte Más de 60 Según Naciones Unidas (2005, sec. 7.8), es fundamental que la estructura de los diseños de muestreo complejos se tenga en cuenta en el proceso de inferencia al estimar estadísticas oficiales basadas en encuestas de hogares. Ignorar este aspecto puede generar estimaciones sesgadas y errores de muestreo subestimados. En este contexto, los programas estadísticos ofrecen funcionalidades clave para el manejo de datos provenientes de este tipo de diseños (Heeringa, West y Berglund, 2017, Apéndice A). De manera general, herramientas estadísticas como R, Stata, SAS y SPSS cuentan con módulos y bibliotecas que optimizan la estimación de varianzas en muestras complejas, incorporando métodos de replicación para varianzas basadas en el diseño. Mientras que R es de acceso libre, los otros programas requieren licencias de pago. Estas plataformas permiten calcular estadísticas descriptivas (medias, totales, proporciones, percentiles, razones) y ajustar modelos de regresión considerando la estructura del diseño de la encuesta. Los programas especializados generan automáticamente el efecto del diseño, facilitando la interpretación de la variabilidad de las estimaciones. El uso de estos paquetes implica que el usuario suministre información clave del diseño muestral, como factores de expansión, estratificación e identificadores de conglomerados. A continuación, se ofrece un resumen general, aunque no exhaustivo, de las funciones y posibilidades que brindan los principales programas estadísticos para el análisis de encuestas complejas. Una vez cargada la muestra de hogares en R, el siguiente paso es definir el diseño muestral del cual proviene dicha muestra. Para ello se utilizará el paquete srvyr, que como se mencionó anteriormente, surge como un complemento de survey. Estas librerías permiten definir objetos tipo survey.design, a los que se aplican las funciones de estimación y análisis de encuestas, y que pueden ser combinadas con la programación de tubería (%&gt;%) del paquete tidyverse. A manera de ejemplificar los conceptos mencionados, a continuación se define en R el diseño de muestreo del cual proviene la muestra contenida en el objeto encuesta: options(survey.lonely.psu = &quot;adjust&quot;) library(srvyr) diseno &lt;- encuesta %&gt;% as_survey_design( strata = Stratum, ids = PSU, weights = wk, nest = T) En el código anterior se puede observar que, en primera instancia se debe definir la base de datos en la cual se encuentra la muestra seleccionada. Seguido de eso, se debe definir el tipo de objeto en R con el cual se trabajará, para nuestro caso, será un objeto survey_design el cual se define usando la función as_survey_design. ahora bien, una vez definido el tipo de objeto se procede a definir los parámetros del diseño definido. Para este caso fue un diseño de muestreo estratificado y en varias etapas. Estos argumentos se definen dentro de la función as_survey_design como sigue. Para definir los estratos de utiliza el argumento strata y se define en qué columna están los estratos en mi base de datos. Ahora bien, para definir las UPM´s, en el argumento ids se definen la columna donde se encuntran los conglomerados seleccionados en la primera etapa. También, se definen los pesos de muestreo en el argumento weights y, por último, con el argumento nest=T se define que las UPM´s están dentro de los estratos. "],["análisis-gráfico-histogramas-y-boxplot.html", "1.2 Análisis gráfico: Histogramas y Boxplot", " 1.2 Análisis gráfico: Histogramas y Boxplot Una vez cargada la muestra a R y definido el diseño muestral del cual proviene se pueden hacer los primeros análisis. Como es natural, se inician con análisis gráficos. A continuación, se muestran los códigos computacionales con los cuales se hacen histogramas en R para la variable ingresos teniendo en cuenta el diseño muestral y los factores de expansión haciendo uso la función svyhist de la librería survey. library(survey) library(srvyr) svyhist( ~ Income , diseno, main = &quot;Ingresos por hogar&quot;, col = &quot;grey80&quot;, xlab = &quot;Ingreso&quot;, probability = FALSE ) Como se pudo observar en el código anterior, para generar un histograma teniendo en cuenta el diseño muestral se usó la función svyhist. En primer lugar, se definió la variable a graficar, que para nuestro caso fue Income. Seguido, se define el diseño muestral utilizado en la encuesta. Luego, se definen los argumentos relacionados con la estética del gráfico como lo son: el título principal (main), el color (col) y el título horizontal (xlab). Finalmente, se define si el histograma es de frecuencias o probabilidades con el argumento probability. Para este ejemplo, se tomó la opción probability = False indicando que es un histograma de frecuencias. Una pregunta que surge de manera natural es ¿cuál es la diferencia entre los histogramas sin usar los factores de expansión y utilizándolo? A continuación, se generan 3 histogramas, en el primero se grafica la variable ingreso utilizando los factores de expansión, en el segundo se grafica la misma variable sin usar los factores de expansión y en el tercero, se hace el gráfico poblacional. library(survey) data(&quot;BigCity&quot;, package = &quot;TeachingSampling&quot;) par(mfrow = c(1,3)) svyhist(~ Income, diseno, main = &quot;Ponderado&quot;, col = &quot;green&quot;, breaks = 50) hist( encuesta$Income, main = &quot;Sin ponderar&quot;, col = &quot;red&quot;, prob = TRUE, breaks = 50) hist(BigCity$Income, main = &quot;Poblacional&quot;, col = &quot;purple&quot;, prob = TRUE, xlim = c(0, 2500), breaks = 500) Uno de los análisis gráficos más comunes que se realizan ene encuestas de hogares están relacionados con subgrupos geográficos como lo son las zonas (urbano - rural) o también realizar desagregaciones temáticas como lo son por sexo (hombre mujer). A continuación, se muestra la sintaxis en R como se realizan histogramas para hombres y mujeres mayores de 18 años: sub_Mujer &lt;- diseno %&gt;% filter(Sex == &quot;Female&quot;) sub_Hombre &lt;- diseno %&gt;% filter(Sex == &quot;Male&quot;) par(mfrow = c(1,2)) svyhist( ~ Income , design = subset(sub_Mujer, Age &gt;= 18), main = &quot;Mujer&quot;, breaks = 30, col = &quot;grey80&quot;, xlab = &quot;Ingreso&quot;) svyhist( ~ Income , design = subset(sub_Hombre, Age &gt;= 18), main = &quot;Hombre&quot;, breaks = 30, col = &quot;grey80&quot;, xlab = &quot;Ingreso&quot;) Como se puede observar, los argumentos utilizando para realizar los gráficos son los mismo que se utilizaron y ejemplificaron anteriormente. Cabe notar que la función subset permite hacer un subconjunto de la población, que para nuetro caso son aquellos hombres y mujeres mayores o iguales a 18 años. Si el objetivo ahora es realizar análisis de localización y variablidad, por ejemplo, graficar Bloxplot teniendo en cuenta los factores de expansión, a continuación, se muestran las sintaxis de como realizarlo en R. sub_Urbano &lt;- diseno %&gt;% filter(Zone == &quot;Urban&quot;) sub_Rural &lt;- diseno %&gt;% filter(Zone == &quot;Rural&quot;) par(mfrow = c(1,2)) svyboxplot( Income~1 , sub_Urbano, col = &quot;grey80&quot;, ylab = &quot;Ingreso&quot;, xlab = &quot;Urbano&quot;) svyboxplot( Income ~ 1 , sub_Rural, col = &quot;grey80&quot;, ylab = &quot;Ingreso&quot;, xlab = &quot;Rural&quot;) Los argumentos usados en la función svyboxplot para generar el gráfico son muy similares a los usados en la función svyhist. Algo a recalcar el los argumentos de esta función es que el símbolo “Income ~ 1” hace referencia a que todas las personas pertenecen a un solo grupo que puede ser urbano o rural dependiendo del caso y por eso se requiere indicarle a R esa restricción, lo cual se hace con el símbolo “~1”. "],["estimación-de-totales-medias-y-razones.html", "1.3 Estimación de totales, medias y razones", " 1.3 Estimación de totales, medias y razones Al trabajar con encuestas de hogares, el análisis de datos numéricos implica con frecuencia calcular estadísticas descriptivas como medias, totales y razones, ya que estas permiten sintetizar las principales características de la población y sirven de base para la toma de decisiones. Dichas estimaciones pueden calcularse para la población en su conjunto o para subgrupos específicos, según los objetivos de la investigación. Tal como destacan Heeringa, West y Berglund (2017), el cálculo de totales y medias poblacionales, junto con sus varianzas, ha sido esencial para el desarrollo de la teoría del muestreo probabilístico y la interpretación adecuada de los resultados de encuestas de hogares. 1.3.1 Estimación puntual Una vez exploradas las tendencias de las variables continuas mediante análisis gráfico, el siguiente paso consiste en obtener las estimaciones puntuales de los parámetros medidos. Estas estimaciones pueden calcularse de forma general o desagregada por niveles de análisis, dependiendo de las necesidades de la investigación. En el contexto de encuestas de hogares, las estimaciones puntuales comprenden el cálculo de totales, promedios, razones y otras medidas agregadas. Heeringa et al. (2017) señalan que la estimación del total o promedio de una población y su varianza muestral es fundamental en la teoría del muestreo probabilístico, ya que permite obtener valores precisos sobre la situación de los hogares estudiados, facilitando la toma de decisiones informadas en políticas públicas. 1.3.2 Estimación de totales e intervalos de confianza Una vez definido el diseño muestral (como se hizo en la sección anterior), se procede a realizar los procesos de estimación de los parámetros de interés. Para efectos de este texto, se iniciará con la estimación del total de los ingresos de los hogares. En su mayoría, los paquetes estadísticos actuales no implementan técnicas avanzadas como estimadores generales de regresión (GREG) o métodos de calibración. Sin embargo, Valliant et al. (2000) desarrollaron una librería en S-plus que permite realizar estos procedimientos de estimación, los cuales también pueden implementarse en R (Valliant et al., 2013). Para la estimación de totales con diseños muestrales complejos que incluyen estratificación (\\(h=1,2,...,H\\)) y muestreo por conglomerados (cuyos conglomerados están dentro del estrato \\(h\\), indexados por \\(\\alpha=1,2,...,a\\_h\\)), el estimador del total se puede expresar como: \\[ \\hat{Y}_{\\omega} = \\sum_{h=1}^{H}\\sum_{\\alpha=1}^{a_h}\\sum_{i=1}^{n_{h\\alpha}}\\omega_{h\\alpha i} y_{h\\alpha i} \\] El estimador insesgado de la varianza para este total es: \\[ \\text{var}\\left(\\hat{Y}_{\\omega}\\right) = \\sum_{h=1}^{H} \\frac{a_h}{a_h - 1} \\left[ \\sum_{\\alpha=1}^{a_h} \\left( \\sum_{i=1}^{n_{h\\alpha}} \\omega_{h\\alpha i} y_{h\\alpha i} \\right)^2 - \\frac{\\left( \\sum_{\\alpha=1}^{a_h} \\omega_{h\\alpha i} y_{h\\alpha i} \\right)^2}{a_h} \\right] \\] La determinación de los totales poblacionales constituye uno de los pilares del análisis de encuestas. Tanto las medias como las proporciones y las razones derivan de los totales. Un total se define como la suma de una variable específica (por ejemplo, ingreso o gasto) a nivel de toda la población. Para estimar el ingreso total de todos los hogares de un país, se combinan los datos de la muestra aplicando los pesos muestrales que reflejan el diseño y aseguran representatividad. En el caso de variables numéricas simples, las estimaciones básicas son los totales y medias, mientras que las razones permiten establecer comparaciones entre dos variables numéricas. Estos cálculos pueden realizarse para toda la población o de manera desagregada por dominios de estudio, dependiendo de las preguntas de investigación. Para encuestas con estratificación (\\(h=1,2,...,H\\)) y submuestreo en las UPM (ubicadas dentro de cada estrato \\(h\\), identificadas por \\(i\\)), el total poblacional se estima mediante: \\[ \\hat{Y} = \\sum_{h=1}^{H} \\sum_{i \\in s_{1h}} \\sum_{k \\in s_{hi}} w_{hik} \\, y_{hik} \\] Cuando se cuenta con respuesta completa, la varianza de \\(\\hat{Y}\\) puede calcularse usando el estimador de Ultimate Cluster. El intervalo de confianza de nivel \\(1-\\alpha\\) para el total poblacional \\(Y\\) se calcula como: \\[ \\hat{Y} \\pm t_{1-\\alpha/2, df} \\times \\sqrt{\\hat{V}_{UC}(\\hat{Y})} \\] A medida que los grados de libertad aumentan, la distribución \\(t\\) de Student tiende a la normal, lo que explica por qué muchas Oficinas Nacionales de Estadística (ONE) utilizan esta aproximación para reportar intervalos de confianza. No obstante, es importante considerar que esta aproximación puede ser menos fiable cuando el tamaño de la muestra es reducido, aunque suele ofrecer buenos resultados en encuestas de hogares extensas. Como se puede observar, calcular la estimación del total y su varianza estimada es complejo. 1.3.2.1 Enfoques para la estimación de la varianza Tal como se mencionó anteriormente, al trabajar con encuestas de hogares es fundamental proporcionar no solo estimaciones puntuales, sino también cuantificar la incertidumbre asociada a dichas estimaciones. Comprender y estimar esta incertidumbre constituye una parte crítica del análisis de los datos provenientes de encuestas de hogares. Mediante la aplicación de métodos apropiados, los usuarios pueden medir la precisión de sus estimaciones. Existen diversos métodos para estimar dicha precisión y, con el apoyo de software moderno, estos enfoques pueden implementarse de manera eficiente para respaldar análisis rigurosos y significativos. Entre los principales métodos se encuentran: Ecuaciones de estimación: ofrecen un marco flexible para estimar totales, medias, razones y otros parámetros, así como sus varianzas correspondientes, integrando una idea unificadora de la teoría de muestreo (Binder, 1983). Linealización de Taylor: consiste en aproximar estadísticas no lineales complejas mediante expresiones lineales y posteriormente estimar la varianza de esta cantidad aproximada. Método del Clúster Último: utilizado con frecuencia en encuestas que emplean muestreo estratificado en múltiples etapas; se basa en calcular la varianza a partir de las diferencias entre las estimaciones obtenidas a nivel de las unidades primarias de muestreo (PSU). Suele combinarse con la Linealización de Taylor para estimar la varianza de estadísticas no lineales, como medias o razones. Bootstrap y otros métodos de replicación: se fundamentan en tomar repetidas submuestras del conjunto de datos observado, calcular estimaciones para cada réplica y luego utilizar la variabilidad entre estas estimaciones replicadas para inferir la varianza del estimador principal. Ecuaciones de estimación y linealización de Taylor Como se mencionó en el apartado anterior, uno de los enfoques más utilizados para cuantificar la incertidumbre en encuestas de hogares se basa en la formulación de ecuaciones de estimación y en la aplicación de la linealización de Taylor. Estos métodos proporcionan un marco general que permite definir los parámetros de interés, obtener sus estimadores muestrales y, a partir de ellos, aproximar sus varianzas. Muchos parámetros poblacionales pueden expresarse como soluciones de ecuaciones de estimación que involucran totales poblacionales. Aunque los detalles técnicos pueden ser complejos, la idea fundamental es que los mismos principios utilizados para estimar totales pueden aplicarse también para la estimación de varianzas. Este marco general hace que el método sea sencillo y versátil, permitiendo una implementación eficiente en software especializado. Una ecuación de estimación poblacional genérica se expresa como: \\[ \\sum_{k\\in U} z_k(\\theta)=0, \\] donde \\(z_k(\\cdot)\\) es una función de estimación evaluada para la unidad \\(k\\) y \\(\\theta\\) representa el parámetro poblacional de interés. Estas ecuaciones proporcionan un marco general para definir y calcular diversos parámetros de la población, como totales, medias y razones. Para el total poblacional: \\(z_k(\\theta)=y_k-\\theta/N\\). La ecuación de estimación es \\(\\sum_{k\\in U}(y_k-\\theta/N)=0\\), cuya solución es \\(\\theta=\\sum_{k\\in U} y_k = Y\\). Para la media poblacional: \\(z_k(\\theta)=y_k-\\theta\\). La ecuación es \\(\\sum_{k\\in U}(y_k-\\theta)=0\\), cuya solución es \\(\\theta=\\left(\\sum_{k\\in U} y_k\\right)/N = \\overline{Y}\\). Para razones de totales: \\(z_k(\\theta)=y_k-\\theta x_k\\). La ecuación \\(\\sum_{k\\in U}(y_k-\\theta x_k)=0\\) conduce a la razón poblacional \\(\\theta=\\dfrac{\\sum_{k\\in U} y_k}{\\sum_{k\\in U} x_k} = R\\). La idea de definir parámetros poblacionales como soluciones de ecuaciones de estimación a nivel de población conduce naturalmente a un método general para obtener los estimadores muestrales. En este caso, se utilizan ecuaciones de la forma: \\[ \\sum_{k\\in s} d_k\\, z_k(\\theta)=0, \\] donde \\(d_k\\) son los pesos de diseño y \\(z_k(\\theta)\\) la función de estimación evaluada para cada unidad de la muestra. Bajo un muestreo probabilístico y asumiendo respuesta completa, la suma muestral \\(\\sum_{k\\in s} d_k\\, z_k(\\theta)\\) es insesgada respecto a su análoga poblacional, lo que garantiza que las soluciones de estas ecuaciones sean estimadores consistentes de los parámetros poblacionales. La linealización de Taylor constituye un complemento natural a este marco, ya que permite aproximar la varianza de estimadores no lineales. El procedimiento consiste en aplicar una expansión de Taylor de primer orden alrededor del parámetro estimado, con el fin de reemplazar el estimador no lineal por una expresión lineal. De esta manera, se facilita el cálculo de varianzas en situaciones donde no existen fórmulas exactas o su derivación resulta demasiado compleja. Un estimador consistente de la varianza, derivado mediante linealización de Taylor para soluciones de ecuaciones de estimación muestrales, puede expresarse como: \\[ \\hat{V}_{TL}(\\hat{\\theta}) = [\\hat{J}(\\hat{\\theta})]^{-1} \\, \\hat{V}_p \\Bigg[\\sum_{k\\in s} d_k\\, z_k(\\hat{\\theta})\\Bigg] \\, [\\hat{J}(\\hat{\\theta})]^{-1} \\] donde \\(\\hat{J}(\\hat{\\theta}) = \\sum_{k\\in s} d_k \\left[ \\frac{\\partial z_k(\\theta)}{\\partial \\theta} \\right]_{\\theta=\\hat{\\theta}}\\). Este resultado muestra cómo la linealización de Taylor convierte la estimación de varianzas de parámetros complejos en un problema de estimación de totales, lo que explica su amplia adopción en software especializado para el análisis de encuestas. Ultimate Cluster El método del Ultimate Cluster constituye un enfoque directo y robusto para estimar la varianza de totales en encuestas que emplean diseños de muestreo por conglomerados estratificados en múltiples etapas. Propuesto por Hansen, Hurwitz y Madow (1953), este método simplifica la complejidad de los diseños multinivel al centrarse únicamente en la variación entre las Unidades Primarias de Muestreo (PSU). Se asume que, dentro de cada estrato de muestreo, las PSU fueron seleccionadas de manera independiente con reemplazo (posiblemente con probabilidades desiguales), aunque en la práctica la selección suele realizarse sin reemplazo. El método se basa en la variación entre las estadísticas calculadas a nivel de PSU. Cuando se aplica correctamente, refleja implícitamente cualquier submuestreo realizado dentro de las PSU, permitiendo estimaciones de varianza más simples pero confiables. Es especialmente útil en diseños complejos que incluyen estratificación y probabilidades desiguales de selección tanto de PSU como de unidades de niveles inferiores (hogares e individuos). Los requisitos para aplicar este método son: Disponibilidad de estimaciones insesgadas de totales para las variables de interés en cada PSU muestreada. Al menos dos PSU muestreadas por estrato, si la muestra se estratifica en la primera etapa. Información completa sobre PSU, estratos y pesos en el conjunto de datos de la encuesta. Considere un diseño de muestreo en múltiples etapas donde se seleccionan \\(n_h\\) PSU en el estrato \\(h\\), \\(h=1,\\dots,H\\). Sea \\[ \\hat{Y}_{hi} = \\sum_{k\\in s_{hi}} d_{hik} y_{hik} \\] una estimación del total poblacional \\(Y_{hi}\\) de la PSU \\(i\\) en el estrato \\(h\\). Un estimador insesgado del total poblacional \\(Y = \\sum_{h=1}^H \\sum_{i \\in U_{1h}} Y_{hi}\\) se expresa como \\[ \\hat{Y}_{UC} = \\sum_{h=1}^H \\hat{Y}_h, \\quad \\text{donde} \\quad \\hat{Y}_h = \\frac{1}{n_h} \\sum_{i\\in s_{1h}} \\hat{Y}_{hi}. \\] El estimador Ultimate Cluster de la varianza correspondiente se calcula mediante: \\[ \\hat{V}_{UC}(\\hat{Y}) = \\sum_{h=1}^H \\frac{n_h}{n_h-1} \\sum_{i \\in s_{1h}} (\\hat{Y}_{hi} - \\hat{Y}_h)^2 \\] Para más detalles, véase Hansen, Hurwitz y Madow (1953, vol. I, p. 257) o Wolter (2007). Aunque originalmente se diseñó para calcular varianzas de estimadores de totales, el método puede combinarse con linealización de Taylor o ecuaciones de estimación para derivar varianzas de otros parámetros poblacionales formulables como soluciones de ecuaciones de estimación. Esta flexibilidad hace que el método sea aplicable a diversos contextos de análisis de encuestas de hogares. Un supuesto clave es que, dentro de cada estrato, las PSU se eligen de forma independiente y con reemplazo. En la práctica, la mayoría de las encuestas selecciona PSU sin reemplazo, generando diseños más eficientes. Así, las varianzas calculadas bajo la hipótesis de independencia constituyen aproximaciones de las verdaderas varianzas de muestreo. Cuando la fracción muestral es pequeña (por ejemplo, &lt;5 %), estas aproximaciones suelen ser suficientemente precisas para su uso por oficinas nacionales de estadística o analistas secundarios. El método Ultimate Cluster destaca por su simplicidad y robustez, lo que lo hace muy atractivo en la práctica. Aunque los métodos más sofisticados que consideran todas las etapas del diseño pueden ofrecer estimaciones de varianza ligeramente más precisas, su aplicación requiere información más detallada y mayor complejidad computacional. Por el contrario, el método Ultimate Cluster proporciona una aproximación confiable y eficiente, especialmente útil al estimar totales o medias en encuestas de hogares. Para un análisis detallado sobre la precisión de esta aproximación y posibles alternativas, véase Särndal, Swensson y Wretman (1992, p. 153). Bootstrap En muchos casos, los microdatos de encuestas públicas omiten información esencial del diseño, como identificadores de estratos o de unidades primarias de muestreo (UPM), para proteger la confidencialidad de los encuestados. Esta omisión limita la capacidad de los usuarios para calcular varianzas válidas. En tales situaciones, se recomienda que las oficinas nacionales de estadística (NSO) proporcionen pesos de replicación, lo que permite a los analistas estimar errores estándar de manera correcta. Sin estos datos, los usuarios secundarios no pueden reproducir los errores estándar publicados ni considerar adecuadamente el diseño complejo de la encuesta. Los métodos de replicación estiman la varianza generando subconjuntos de la muestra original, calculando estimaciones para cada uno y utilizando la variabilidad observada entre estas estimaciones para aproximar la varianza del estimador principal. Son particularmente útiles cuando no se dispone de información sobre estratos o UPM, situación en la que no se puede aplicar el método de Ultimate Cluster. El Bootstrap es una herramienta de replicación robusta y versátil. Originalmente introducido por Efron (1979) para datos que no provenían de encuestas, su adaptación más usada para encuestas de hogares es el Bootstrap de Reescalamiento Rao-Wu-Yue (Rao, Wu y Yue, 1992). Este método se ajusta de manera óptima a diseños de muestreo estratificados y multietápicos, y es ampliamente empleado para la estimación de varianzas en encuestas complejas. El procedimiento consiste en generar muchas réplicas de la muestra original, simulando extracciones repetidas de la población. Cada réplica se construye mediante la creación de columnas adicionales de pesos de replicación en la base de datos, siguiendo este proceso: Para cada estrato, se seleccionan aleatoriamente las UPM con reemplazo; algunas pueden repetirse y otras no aparecer. Cada UPM elegida se incorpora con todas sus observaciones. Si el tamaño de la muestra de primera etapa en el estrato \\(h\\) es mayor que dos (\\(n_h &gt; 2\\)), el número de UPM seleccionadas por réplica es \\(n_h - 1\\). Este proceso se repite muchas veces, habitualmente cientos, generando un gran número de réplicas. La cantidad de veces que una UPM \\(i\\) del estrato \\(h\\) aparece en la réplica \\(r\\) se denota \\(n_{hi}^{(r)}\\), variando entre 0 y \\(n_h - 1\\). A partir de cada réplica se calculan nuevos pesos bootstrap para todas las unidades, reflejando cuántas veces fue seleccionada su UPM. El peso de la unidad \\(k\\) en la réplica \\(r\\) se calcula como: \\[ w_{hik}^{(r)} = w_{hik} \\times \\frac{n_h}{n_h - 1} \\times n_{hi}^{(r)} \\] Si los pesos originales incluyen ajustes por no respuesta o calibración, estos deben aplicarse también a cada conjunto de pesos bootstrap. Cuando la NSO proporciona únicamente pesos de replicación Bootstrap, los analistas pueden estimar errores estándar correctamente, aun sin identificadores de estratos o UPM. Para cada réplica \\(r\\), se calcula el parámetro de interés \\(\\hat{\\theta}^{(r)}\\) usando los pesos bootstrap \\(w_{hik}^{(r)}\\). La varianza del estimador original se aproxima mediante la variabilidad entre todas las réplicas: \\[ \\hat{V}_B(\\hat{\\theta}) = \\frac{1}{R} \\sum_{r=1}^{R} \\left(\\hat{\\theta}^{(r)} - \\tilde{\\theta}\\right)^2, \\quad \\tilde{\\theta} = \\frac{1}{R} \\sum_{r=1}^{R} \\hat{\\theta}^{(r)} \\] Este enfoque asegura que la dispersión entre réplicas capture fielmente la incertidumbre del parámetro. El Bootstrap ofrece múltiples ventajas. A pesar de requerir un mayor procesamiento computacional, es eficaz para diseños de encuesta complejos y permite estimar parámetros difíciles de calcular con métodos tradicionales, como medianas u otras estadísticas no lineales. Es especialmente útil para analistas que trabajan con bases de datos sin identificadores de estratos y UPM, pero con pesos de replicación. La simplicidad del método facilita su aplicación incluso sin software estadístico especializado. Sin embargo, la mayoría de los paquetes estadísticos modernos ya incluyen procedimientos para aplicar Bootstrap y calcular varianzas, ampliando su disponibilidad y robustez. No obstante, su uso no es recomendable en encuestas repetidas con muestras superpuestas ni en situaciones con fracciones de muestreo grandes y tamaños de muestra pequeños (Bruch, 2011). En este ejemplo se muestra cómo estimar totales y sus intervalos de confianza para diferentes variables de interés en R, utilizando dos funciones de la librería survey: la función svytotal para calcular los totales y la función confint para obtener los intervalos de confianza. A continuación, se presentan los códigos correspondientes: total_Ingresos&lt;- svytotal(~Income, diseno, deff=T, ) total_Ingresos ## total SE DEff ## Income 85793667 4778675 11 confint(total_Ingresos, level = 0.95) ## 2.5 % 97.5 % ## Income 76427637 95159697 Los argumentos que utiliza de la función svytotal con muy sencillos. Para el ejemplo, se le introduce primero la variable en la cual está la información que se desea estimar (Income). Posterior a esto, se introduce el diseño muestral del cual proviene la muestra y, por último, se indica si desea que se reporte el deff de la estimación o no. Por otro lado, para el cálculo del intervalo de confianza, lo único que requiere es indicarle a la función confint el estimador y la confianza requerida. Paras seguir ilustrando el uso de la función svytotal y de confint, estimemos el total de gastos de los hogares, pero ahora el intervalo de confianza se calculará al 90% de confianza. Los siguientes códigos realizan las estimaciones: total_gastos&lt;- svytotal (~Expenditure, diseno, deff=T) total_gastos ## total SE DEff ## Expenditure 55677504 2604139 10.222 confint(total_gastos, level = 0.9) ## 5 % 95 % ## Expenditure 51394077 59960931 Si el objetivo ahora es estimar el total de los ingreso de los hogares pero discriminado por sexo, se utilizará ahora la función cascadede la libraría srvyr, la cual permite agregar la suma de las categorías al final la tabla. También se utilizará la función group_by la cual permite obtener resultados agrupados por los niveles de interés. diseno %&gt;% group_by(Sex) %&gt;% cascade(Total = survey_total( Income, level = 0.95, vartype = c(&quot;se&quot;, &quot;ci&quot;)), .fill = &quot;Total ingreso&quot;) ## # A tibble: 3 × 5 ## Sex Total Total_se Total_low Total_upp ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 Female 44153820. 2324452. 39551172. 48756467. ## 2 Male 41639847. 2870194. 35956576. 47323118. ## 3 Total ingreso 85793667. 4778674. 76331414. 95255920. Como se pudo observar en lo códigos anteriores, otra forma de obtener las estimaciones del total, su desviación estándar y el intervalo de confianza es usando el argumento vartype e indicándole las opciones “se”, “ci” respectivamente. 1.3.3 Estimación de la media e intervalo de confianza La estimación de la media poblacional es un parámetro muy importante en las encuestas de hogares, dado que, por ejemplo, uno de los indicadores trazadores en este tipo de encuestas son los ingresos medios por hogar. Además, este tipo de parámetros no permiten describir y analizar las tendencias centrales de estas variables en poblaciones de interés. Según Gutiérrez (2016) un estimador de la media poblacional se puede escribir como una razón no lineal de dos totales de población finitas estimados como sigue: \\[\\begin{eqnarray*} \\bar{Y}_{\\omega} &amp; = &amp; \\frac{\\sum_{h=1}^{H}\\sum_{\\alpha=1}^{a_{h}}\\sum_{i=1}^{n_{h\\alpha}}\\omega_{h\\alpha i}y_{h\\alpha i}}{\\sum_{h=1}^{H}\\sum_{\\alpha=1}^{a_{h}}\\sum_{i=1}^{n_{h\\alpha}}\\omega_{h\\alpha i}}\\\\ &amp; = &amp; \\frac{\\hat{Y}}{\\hat{N}}. \\end{eqnarray*}\\] Como una observación tenga en cuenta que, si \\(y\\) es una variable binaria, la media ponderada estima la proporción de la población. Por otro lado, como \\(\\bar{Y}_{\\omega}\\) no es una estadística lineal, no existe una fórmula cerrada para la varianza de este estimador. Es por lo anterior que, se deben recurrir a usar métodos de remuestreo o series de Taylor. Para este caso en particular, usando series de Taylor el estimador insesgado de la varianza para este estimador es: \\[\\begin{eqnarray*} var\\left(\\bar{Y}_{\\omega}\\right) &amp; \\dot{=} &amp; \\frac{var\\left(\\hat{Y}\\right)+\\bar{Y}_{\\omega}^{2}\\times var\\left(\\hat{N}\\right)-2\\times\\bar{Y}_{\\omega}\\times cov\\left(\\hat{Y},\\hat{N}\\right)}{\\hat{N}^{2}} \\end{eqnarray*}\\] Como se puede observar, el cálculo de la estimación de la varianza tiene componentes complejos de calcular de manera analítica, como la covarianza entre el total estimado y el tamaño poblacional estimado. Sin embargo, R tiene funciones que incorpora estos estimadores. A continuación, se presenta la sintaxis para hacer dichos cálculos. Media_ingresos&lt;- svymean(~Income, diseno, deff=T) Media_ingresos ## mean SE DEff ## Income 570.945 28.478 8.8211 confint(Media_ingresos, level = 0.95) ## 2.5 % 97.5 % ## Income 515.1299 626.7607 Como se puede observar, los argumentos que utiliza la función svymean para realizar la estimación de la media de los ingresos de los hogares y la desviación estándar estimada del estimador son similares a los utilizando con la función svytotal. Similarmente ocurre con el intervalo de confianza. Por otro lado, tal como se realizó con el total, a manera de ejemplo, se estima la media de los gastos en los hogares como sigue a continuación: Media_gastos&lt;- svymean (~Expenditure, diseno, deff=T) Media_gastos ## mean SE DEff ## Expenditure 370.526 13.294 6.0156 confint(Media_gastos) ## 2.5 % 97.5 % ## Expenditure 344.4697 396.5829 "],["referencias.html", "Capítulo 2 Referencias", " Capítulo 2 Referencias Asparouhov, T., &amp; Muthen, B. (2006, August). Multilevel modeling of complex survey data. In Proceedings of the joint statistical meeting in Seattle (pp. 2718-2726). Asparouhov, T. (2006). General multi-level modeling with sampling weights. Communications in Statistics—Theory and Methods, 35(3), 439-460. Pfeffermann, D., Skinner, C. J., Holmes, D. J., Goldstein, H., &amp; Rasbash, J. (1998). Weighting for unequal selection probabilities in multilevel models. Journal of the Royal Statistical Society: series B (statistical methodology), 60(1), 23-40. Cai, T. (2013). Investigation of ways to handle sampling weights for multilevel model analyses. Sociological Methodology, 43(1), 178-219. Finch, W. H., Bolin, J. E., &amp; Kelley, K. (2019). Multilevel modeling using R. Crc Press. Merlo, J., Chaix, B., Ohlsson, H., Beckman, A., Johnell, K., Hjerpe, P., … &amp; Larsen, K. (2006). A brief conceptual tutorial of multilevel analysis in social epidemiology: using measures of clustering in multilevel logistic regression to investigate contextual phenomena. Journal of Epidemiology &amp; Community Health, 60(4), 290-297. Sarndal, C., Swensson, B. &amp;Wretman, J. (1992), Model Assisted Survey Sampling, Springer, New York. Rojas, H. A. G. (2016). Estrategias de muestreo: diseño de encuestas y estimación de parámetros. Ediciones de la U. Santana Sepúlveda, S., &amp; Mateos Farfán, E. (2014). El arte de programar en R: un lenguaje para la estadística. Lumley, T. (2011). Complex surveys: a guide to analysis using R. John Wiley &amp; Sons. Bache, S. M., Wickham, H., Henry, L., &amp; Henry, M. L. (2022). Package ‘magrittr’. Tellez Piñerez, C. F., &amp; Lemus Polanía, D. F. (2015). Estadística Descriptiva y Probabilidad con aplicaciones en R. Fundación Universitaria Los Libertadore. Groves, R. M., Fowler Jr, F. J., Couper, M. P., Lepkowski, J. M., Singer, E., &amp; Tourangeau, R. (2011). Survey methodology. John Wiley &amp; Sons. Tille, Y. &amp; Ardilly, P. (2006), Sampling Methods: Exercises and Solutions, Springer. Gambino, J. G., &amp; do Nascimento Silva, P. L. (2009). Sampling and estimation in household surveys. In Handbook of Statistics (Vol. 29, pp. 407-439). Elsevier. Cochran, W. G. (1977) Sampling Techniques. John Wiley and Sons. Gutiérrez, H. A. (2017) TeachingSampling. R package. Wickham, H., Chang, W., &amp; Wickham, M. H. (2016). Package ‘ggplot2’. Create elegant data visualisations using the grammar of graphics. Version, 2(1), 1-189. Lumley, T. (2020). Package ‘survey’. Available at the following link: https://cran. r-project. org. Hansen, M. H., &amp; Steinberg, J. (1956). Control of errors in surveys. Biometrics, 12(4), 462-474. Heeringa, S. G., West, B. T., &amp; Berglund, P. A. (2017). Applied survey data analysis. chapman and hall/CRC. Valliant, R., Dever, J.A., and Kreuter, F., Practical Tools for Designing and Weighting Survey Samples, Springer, New York, 2013. Valliant, R., Dorfman, A.H., and Royall, R.M., Finite Population Sampling and Inference: A Prediction Approach, John Wiley &amp; Sons, New York, 2000. Loomis, D., Richardson, D.B., and Elliott, L., Poisson regression analysis of ungrouped data, Occupational and Environmental Medicine, 62, 325–329, 2005. Kovar, J.G., Rao, J.N.K., and Wu, C.F.J., Bootstrap and other methods to measure errors in survey estimates, Canadian Journal of Statistics, 16(Suppl.), 25–45, 1988. Binder, D.A. and Kovacevic, M.S., Estimating some measures of income inequality from survey data: An application of the estimating equations approach, Survey Methodology, 21(2), 137–145, 1995. Kovacevic, M. S., &amp; Binder, D. A. (1997). Variance estimation for measures of income inequality and polarization-the estimating equations approach. Journal of Official Statistics, 13(1), 41. Bautista, J. (1998), Diseños de muestreo estadístico, Universidad Nacional de Colombia. Monroy, L. G. D., Rivera, M. A. M., &amp; Dávila, L. R. L. (2018). Análisis estadístico de datos categóricos. Universidad Nacional de Colombia. Kish, L. and Frankel, M.R., Inference from complex samples, Journal of the Royal Statistical Society, Series B, 36, 1–37, 1974. Fuller, W.A., Regression analysis for sample survey, Sankyha, Series C, 37, 117–132, 1975. Shah, B.V., Holt, M.M., and Folsom, R.F., Inference about regression models from sample survey data, Bulletin of the International Statistical Institute, 41(3), 43–57, 1977. Skinner, C.J., Holt, D., and Smith, T.M.F., Analysis of Complex Surveys, John Wiley &amp; Sons, New York, 1989. Binder, D.A., On the variances of asymptotically normal estimators from complex surveys, International Statistical Review, 51, 279–292, 1983. Fuller, W.A., Regression estimation for survey samples (with discussion), Survey Methodology, 28(1), 5–23, 2002. Pfeffermann, D., Modelling of complex survey data: Why model? Why is it a problem? How can we approach it? Survey Methodology, 37(2), 115–136, 2011. Wolter, K.M., Introduction to Variance Estimation (2nd ed.), Springer-Verlag, New York, 2007. Tellez, C. F., &amp; Morales, M. A. (2016). Modelos Estadísticos lineales con aplicaciones en R. Ediciones de la U. Fay, R.E., On adjusting the Pearson Chi-square statistic for cluster sampling, In Proceedings of the Social Statistics Section, American Statistical Association, Washington, DC, 402–405, 1979. Fay, R.E., A jack-knifed chi-squared test for complex samples, Journal of the American Statistical Association, 80, 148–157, 1985. Fellegi, I.P., Approximate tests of independence and goodness of fit based on stratified multistage samples, Journal of the American Statistical Association, 75, 261–268, 1980. Thomas, D.R. and Rao, J.N.K., Small-sample comparisons of level and power for simple goodness-of-fit statistics under cluster sampling, Journal of the American Statistical Association, 82, 630–636, 1987. Rao, J.N.K. and Scott, A.J., On chi-squared test for multiway contingency tables with cell proportions estimated from survey data, The Annals of Statistics, 12, 46–60, 1984. Van Buuren, S., Flexible Imputation of Missing Data, Chapman &amp; Hall, Boca Raton, FL, 2012. Carpenter, J.R. and Kenward, M.G., Multiple Imputation and Its Application, John Wiley &amp; Sons, Chichester, West Sussex, UK, 2013. Berglund, P.A. and Heeringa, S.G., Multiple Imputation of Missing Data Using SAS®, SAS Institute Inc., Cary, NC, 2014. Chambers, R.L., Steel, D.G., Wang, S., and Welsh, A.H., Maximum Likelihood Estimation for Sample Surveys, Chapman &amp; Hall, Boca Raton, FL, 2012. Zhou, H., Elliott, M.R., and Raghunathan, T.E., Multiple imputation in two-stage cluster samples using the weighted finite population Bayesian Bootstrap, Journal of Survey Statistics and Methodology, 4, 139–170, 2016a. Zhou, H., Elliott, M.R., and Raghunathan, T.E., Synthetic multiple-imputation procedure for multistage complex samples, Journal of Official Statistics, 32(1), 231–256, 2016b. Kim, J.K. and Shao, J., Statistical Methods for Handling Incomplete Data, Chapman &amp; Hall, Boca Raton, FL, 2014. Kim, J.K. and Fuller, W.A., Fractional Hotdeck imputation, Biometrika, 89, 470–477, 2004. StataCorp., Release 14, P Manual, STATA Survey Data Manual, Stata Press, College Station, TX, 2015. Raghunathan, T.E., Missing Data Analysis in Practice, Chapman &amp; Hall/CRC Interdisciplinary Statistics, Boca Raton, FL, 2016. Rubin, D. B. (1987). Multiple imputation for survey nonresponse. Goldstein, H. (2011). Multilevel statistical models (Vol. 922). John Wiley &amp; Sons. Data analysis using regression and multilevel/hierarchical models” de Andrew Gelman y Jennifer Hill (2006) Sophia, R. H., &amp; Skrondal, A. (2012). Multilevel and longitudinal modeling using Stata. STATA press. Browne, W. J., &amp; Draper, D. (2006). A comparison of Bayesian and likelihood-based methods for fitting multilevel models. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
