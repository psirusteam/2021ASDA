<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.3 Estimación de totales, medias y razones | Análisis de encuestas con R</title>
  <meta name="description" content="Este es el repositorio del libro Análisis de encuestas con R." />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="1.3 Estimación de totales, medias y razones | Análisis de encuestas con R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Este es el repositorio del libro Análisis de encuestas con R." />
  <meta name="github-repo" content="psirusteam/2021ASDA" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.3 Estimación de totales, medias y razones | Análisis de encuestas con R" />
  
  <meta name="twitter:description" content="Este es el repositorio del libro Análisis de encuestas con R." />
  

<meta name="author" content="Andrés Gutiérrez,Stalyn Guerrero, Cristian Téllez, Giovany Babativa" />


<meta name="date" content="2025-09-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="análisis-gráfico-histogramas-y-boxplot.html"/>
<link rel="next" href="referencias.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Análisis de encuestas con R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefacio</a></li>
<li class="chapter" data-level="1" data-path="04-Continuas_v0.html"><a href="#an%C3%A1lisis-de-las-variables-continuas-en-encuestas-de-hogares"><i class="fa fa-check"></i><b>1</b> Análisis de las variables continuas en encuestas de hogares</a>
<ul>
<li class="chapter" data-level="1.1" data-path="04-Continuas_v0.html"><a href="#lectura-de-bases-de-datos-y-definici%C3%B3n-del-dise%C3%B1o-muestral"><i class="fa fa-check"></i><b>1.1</b> Lectura de bases de datos y definición del diseño muestral</a></li>
<li class="chapter" data-level="1.2" data-path="04-Continuas_v0.html"><a href="#an%C3%A1lisis-gr%C3%A1fico-histogramas-y-boxplot"><i class="fa fa-check"></i><b>1.2</b> Análisis gráfico: Histogramas y Boxplot</a></li>
<li class="chapter" data-level="1.3" data-path="04-Continuas_v0.html"><a href="#estimaci%C3%B3n-de-totales-medias-y-razones"><i class="fa fa-check"></i><b>1.3</b> Estimación de totales, medias y razones</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="04-Continuas_v0.html"><a href="#estimaci%C3%B3n-puntual"><i class="fa fa-check"></i><b>1.3.1</b> Estimación puntual</a></li>
<li class="chapter" data-level="1.3.2" data-path="04-Continuas_v0.html"><a href="#estimaci%C3%B3n-de-totales-e-intervalos-de-confianza"><i class="fa fa-check"></i><b>1.3.2</b> Estimación de totales e intervalos de confianza</a></li>
<li class="chapter" data-level="1.3.3" data-path="04-Continuas_v0.html"><a href="#estimaci%C3%B3n-de-la-media-e-intervalo-de-confianza"><i class="fa fa-check"></i><b>1.3.3</b> Estimación de la media e intervalo de confianza</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i><b>2</b> Referencias</a></li>
<li class="divider"></li>
<li><a Análisis de encuestas con R </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Análisis de encuestas con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="estimación-de-totales-medias-y-razones" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Estimación de totales, medias y razones<a href="#estimaci%C3%B3n-de-totales-medias-y-razones" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Al trabajar con encuestas de hogares, el análisis de datos numéricos implica con frecuencia calcular estadísticas descriptivas como medias, totales y razones, ya que estas permiten sintetizar las principales características de la población y sirven de base para la toma de decisiones. Dichas estimaciones pueden calcularse para la población en su conjunto o para subgrupos específicos, según los objetivos de la investigación. Tal como destacan Heeringa, West y Berglund (2017), el cálculo de totales y medias poblacionales, junto con sus varianzas, ha sido esencial para el desarrollo de la teoría del muestreo probabilístico y la interpretación adecuada de los resultados de encuestas de hogares.</p>
<div id="estimación-puntual" class="section level3 hasAnchor" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> Estimación puntual<a href="#estimaci%C3%B3n-puntual" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una vez exploradas las tendencias de las variables continuas mediante análisis gráfico, el siguiente paso consiste en obtener las estimaciones puntuales de los parámetros medidos. Estas estimaciones pueden calcularse de forma general o desagregada por niveles de análisis, dependiendo de las necesidades de la investigación. En el contexto de encuestas de hogares, las estimaciones puntuales comprenden el cálculo de totales, promedios, razones y otras medidas agregadas.</p>
<p>Heeringa et al. (2017) señalan que la estimación del total o promedio de una población y su varianza muestral es fundamental en la teoría del muestreo probabilístico, ya que permite obtener valores precisos sobre la situación de los hogares estudiados, facilitando la toma de decisiones informadas en políticas públicas.</p>
</div>
<div id="estimación-de-totales-e-intervalos-de-confianza" class="section level3 hasAnchor" number="1.3.2">
<h3><span class="header-section-number">1.3.2</span> Estimación de totales e intervalos de confianza<a href="#estimaci%C3%B3n-de-totales-e-intervalos-de-confianza" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una vez definido el diseño muestral (como se hizo en la sección anterior), se procede a realizar los procesos de estimación de los parámetros de interés. Para efectos de este texto, se iniciará con la estimación del total de los ingresos de los hogares.</p>
<p>En su mayoría, los paquetes estadísticos actuales no implementan técnicas avanzadas como estimadores generales de regresión (GREG) o métodos de calibración. Sin embargo, Valliant et al. (2000) desarrollaron una librería en <em>S-plus</em> que permite realizar estos procedimientos de estimación, los cuales también pueden implementarse en R (Valliant et al., 2013).</p>
<p>Para la estimación de totales con diseños muestrales complejos que incluyen estratificación (<span class="math inline">\(h=1,2,...,H\)</span>) y muestreo por conglomerados (cuyos conglomerados están dentro del estrato <span class="math inline">\(h\)</span>, indexados por <span class="math inline">\(\alpha=1,2,...,a\_h\)</span>), el estimador del total se puede expresar como:</p>
<p><span class="math display">\[
\hat{Y}_{\omega} = \sum_{h=1}^{H}\sum_{\alpha=1}^{a_h}\sum_{i=1}^{n_{h\alpha}}\omega_{h\alpha i} y_{h\alpha i}
\]</span></p>
<p>El estimador insesgado de la varianza para este total es:</p>
<p><span class="math display">\[
\text{var}\left(\hat{Y}_{\omega}\right) = \sum_{h=1}^{H} \frac{a_h}{a_h - 1} \left[ \sum_{\alpha=1}^{a_h} \left( \sum_{i=1}^{n_{h\alpha}} \omega_{h\alpha i} y_{h\alpha i} \right)^2 - \frac{\left( \sum_{\alpha=1}^{a_h} \omega_{h\alpha i} y_{h\alpha i} \right)^2}{a_h} \right]
\]</span></p>
<p>La determinación de los totales poblacionales constituye uno de los pilares del análisis de encuestas. Tanto las medias como las proporciones y las razones derivan de los totales. Un total se define como la suma de una variable específica (por ejemplo, ingreso o gasto) a nivel de toda la población. Para estimar el ingreso total de todos los hogares de un país, se combinan los datos de la muestra aplicando los pesos muestrales que reflejan el diseño y aseguran representatividad.</p>
<p>En el caso de variables numéricas simples, las estimaciones básicas son los totales y medias, mientras que las razones permiten establecer comparaciones entre dos variables numéricas. Estos cálculos pueden realizarse para toda la población o de manera desagregada por dominios de estudio, dependiendo de las preguntas de investigación.</p>
<p>Para encuestas con estratificación (<span class="math inline">\(h=1,2,...,H\)</span>) y submuestreo en las UPM (ubicadas dentro de cada estrato <span class="math inline">\(h\)</span>, identificadas por <span class="math inline">\(i\)</span>), el total poblacional se estima mediante:</p>
<p><span class="math display">\[
\hat{Y} = \sum_{h=1}^{H} \sum_{i \in s_{1h}} \sum_{k \in s_{hi}} w_{hik} \, y_{hik}
\]</span></p>
<p>Cuando se cuenta con respuesta completa, la varianza de <span class="math inline">\(\hat{Y}\)</span> puede calcularse usando el estimador de Ultimate Cluster.</p>
<p>El intervalo de confianza de nivel <span class="math inline">\(1-\alpha\)</span> para el total poblacional <span class="math inline">\(Y\)</span> se calcula como:</p>
<p><span class="math display">\[
\hat{Y} \pm t_{1-\alpha/2, df} \times \sqrt{\hat{V}_{UC}(\hat{Y})}
\]</span></p>
<p>A medida que los grados de libertad aumentan, la distribución <span class="math inline">\(t\)</span> de Student tiende a la normal, lo que explica por qué muchas Oficinas Nacionales de Estadística (ONE) utilizan esta aproximación para reportar intervalos de confianza. No obstante, es importante considerar que esta aproximación puede ser menos fiable cuando el tamaño de la muestra es reducido, aunque suele ofrecer buenos resultados en encuestas de hogares extensas.</p>
<p>Como se puede observar, calcular la estimación del total y su varianza estimada es complejo.</p>
<div id="enfoques-para-la-estimación-de-la-varianza" class="section level4 hasAnchor" number="1.3.2.1">
<h4><span class="header-section-number">1.3.2.1</span> Enfoques para la estimación de la varianza<a href="#enfoques-para-la-estimaci%C3%B3n-de-la-varianza" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Tal como se mencionó anteriormente, al trabajar con encuestas de hogares es fundamental proporcionar no solo estimaciones puntuales, sino también cuantificar la incertidumbre asociada a dichas estimaciones. Comprender y estimar esta incertidumbre constituye una parte crítica del análisis de los datos provenientes de encuestas de hogares. Mediante la aplicación de métodos apropiados, los usuarios pueden medir la precisión de sus estimaciones.</p>
<p>Existen diversos métodos para estimar dicha precisión y, con el apoyo de software moderno, estos enfoques pueden implementarse de manera eficiente para respaldar análisis rigurosos y significativos. Entre los principales métodos se encuentran:</p>
<ul>
<li><p><strong>Ecuaciones de estimación:</strong> ofrecen un marco flexible para estimar totales, medias, razones y otros parámetros, así como sus varianzas correspondientes, integrando una idea unificadora de la teoría de muestreo (Binder, 1983).</p></li>
<li><p><strong>Linealización de Taylor:</strong> consiste en aproximar estadísticas no lineales complejas mediante expresiones lineales y posteriormente estimar la varianza de esta cantidad aproximada.</p></li>
<li><p><strong>Método del Clúster Último:</strong> utilizado con frecuencia en encuestas que emplean muestreo estratificado en múltiples etapas; se basa en calcular la varianza a partir de las diferencias entre las estimaciones obtenidas a nivel de las unidades primarias de muestreo (PSU). Suele combinarse con la Linealización de Taylor para estimar la varianza de estadísticas no lineales, como medias o razones.</p></li>
<li><p><strong>Bootstrap y otros métodos de replicación:</strong> se fundamentan en tomar repetidas submuestras del conjunto de datos observado, calcular estimaciones para cada réplica y luego utilizar la variabilidad entre estas estimaciones replicadas para inferir la varianza del estimador principal.</p></li>
</ul>
</div>
<div id="ecuaciones-de-estimación-y-linealización-de-taylor" class="section level4 unnumbered hasAnchor">
<h4>Ecuaciones de estimación y linealización de Taylor<a href="#ecuaciones-de-estimaci%C3%B3n-y-linealizaci%C3%B3n-de-taylor" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Como se mencionó en el apartado anterior, uno de los enfoques más utilizados para cuantificar la incertidumbre en encuestas de hogares se basa en la formulación de <strong>ecuaciones de estimación</strong> y en la aplicación de la <strong>linealización de Taylor</strong>. Estos métodos proporcionan un marco general que permite definir los parámetros de interés, obtener sus estimadores muestrales y, a partir de ellos, aproximar sus varianzas.</p>
<p>Muchos parámetros poblacionales pueden expresarse como soluciones de ecuaciones de estimación que involucran totales poblacionales. Aunque los detalles técnicos pueden ser complejos, la idea fundamental es que los mismos principios utilizados para estimar totales pueden aplicarse también para la estimación de varianzas. Este marco general hace que el método sea sencillo y versátil, permitiendo una implementación eficiente en software especializado.</p>
<p>Una ecuación de estimación poblacional genérica se expresa como:</p>
<p><span class="math display">\[
\sum_{k\in U} z_k(\theta)=0,
\]</span></p>
<p>donde <span class="math inline">\(z_k(\cdot)\)</span> es una función de estimación evaluada para la unidad <span class="math inline">\(k\)</span> y <span class="math inline">\(\theta\)</span> representa el parámetro poblacional de interés. Estas ecuaciones proporcionan un marco general para definir y calcular diversos parámetros de la población, como totales, medias y razones.</p>
<ul>
<li><p><strong>Para el total poblacional:</strong>
<span class="math inline">\(z_k(\theta)=y_k-\theta/N\)</span>. La ecuación de estimación es <span class="math inline">\(\sum_{k\in U}(y_k-\theta/N)=0\)</span>, cuya solución es <span class="math inline">\(\theta=\sum_{k\in U} y_k = Y\)</span>.</p></li>
<li><p><strong>Para la media poblacional:</strong>
<span class="math inline">\(z_k(\theta)=y_k-\theta\)</span>. La ecuación es <span class="math inline">\(\sum_{k\in U}(y_k-\theta)=0\)</span>, cuya solución es <span class="math inline">\(\theta=\left(\sum_{k\in U} y_k\right)/N = \overline{Y}\)</span>.</p></li>
<li><p><strong>Para razones de totales:</strong>
<span class="math inline">\(z_k(\theta)=y_k-\theta x_k\)</span>. La ecuación <span class="math inline">\(\sum_{k\in U}(y_k-\theta x_k)=0\)</span> conduce a la razón poblacional <span class="math inline">\(\theta=\dfrac{\sum_{k\in U} y_k}{\sum_{k\in U} x_k} = R\)</span>.</p></li>
</ul>
<p>La idea de definir parámetros poblacionales como soluciones de ecuaciones de estimación a nivel de población conduce naturalmente a un método general para obtener los <strong>estimadores muestrales</strong>. En este caso, se utilizan ecuaciones de la forma:</p>
<p><span class="math display">\[
\sum_{k\in s} d_k\, z_k(\theta)=0,
\]</span></p>
<p>donde <span class="math inline">\(d_k\)</span> son los pesos de diseño y <span class="math inline">\(z_k(\theta)\)</span> la función de estimación evaluada para cada unidad de la muestra. Bajo un muestreo probabilístico y asumiendo respuesta completa, la suma muestral <span class="math inline">\(\sum_{k\in s} d_k\, z_k(\theta)\)</span> es insesgada respecto a su análoga poblacional, lo que garantiza que las soluciones de estas ecuaciones sean estimadores consistentes de los parámetros poblacionales.</p>
<p>La <strong>linealización de Taylor</strong> constituye un complemento natural a este marco, ya que permite aproximar la varianza de estimadores no lineales. El procedimiento consiste en aplicar una expansión de Taylor de primer orden alrededor del parámetro estimado, con el fin de reemplazar el estimador no lineal por una expresión lineal. De esta manera, se facilita el cálculo de varianzas en situaciones donde no existen fórmulas exactas o su derivación resulta demasiado compleja.</p>
<p>Un estimador consistente de la varianza, derivado mediante linealización de Taylor para soluciones de ecuaciones de estimación muestrales, puede expresarse como:</p>
<p><span class="math display">\[
\hat{V}_{TL}(\hat{\theta}) = [\hat{J}(\hat{\theta})]^{-1} \, \hat{V}_p \Bigg[\sum_{k\in s} d_k\, z_k(\hat{\theta})\Bigg] \, [\hat{J}(\hat{\theta})]^{-1}
\]</span></p>
<p>donde <span class="math inline">\(\hat{J}(\hat{\theta}) = \sum_{k\in s} d_k \left[ \frac{\partial z_k(\theta)}{\partial \theta} \right]_{\theta=\hat{\theta}}\)</span>.</p>
<p>Este resultado muestra cómo la linealización de Taylor convierte la estimación de varianzas de parámetros complejos en un problema de estimación de totales, lo que explica su amplia adopción en software especializado para el análisis de encuestas.</p>
</div>
<div id="ultimate-cluster" class="section level4 unnumbered hasAnchor">
<h4>Ultimate Cluster<a href="estimación-de-totales-medias-y-razones.html#ultimate-cluster" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>El método del Ultimate Cluster constituye un enfoque directo y robusto para estimar la varianza de totales en encuestas que emplean diseños de muestreo por conglomerados estratificados en múltiples etapas. Propuesto por Hansen, Hurwitz y Madow (1953), este método simplifica la complejidad de los diseños multinivel al centrarse únicamente en la variación entre las Unidades Primarias de Muestreo (PSU). Se asume que, dentro de cada estrato de muestreo, las PSU fueron seleccionadas de manera independiente con reemplazo (posiblemente con probabilidades desiguales), aunque en la práctica la selección suele realizarse sin reemplazo.</p>
<p>El método se basa en la variación entre las estadísticas calculadas a nivel de PSU. Cuando se aplica correctamente, refleja implícitamente cualquier submuestreo realizado dentro de las PSU, permitiendo estimaciones de varianza más simples pero confiables. Es especialmente útil en diseños complejos que incluyen estratificación y probabilidades desiguales de selección tanto de PSU como de unidades de niveles inferiores (hogares e individuos).</p>
<p>Los requisitos para aplicar este método son:</p>
<ul>
<li>Disponibilidad de estimaciones insesgadas de totales para las variables de interés en cada PSU muestreada.</li>
<li>Al menos dos PSU muestreadas por estrato, si la muestra se estratifica en la primera etapa.</li>
<li>Información completa sobre PSU, estratos y pesos en el conjunto de datos de la encuesta.</li>
</ul>
<p>Considere un diseño de muestreo en múltiples etapas donde se seleccionan <span class="math inline">\(n_h\)</span> PSU en el estrato <span class="math inline">\(h\)</span>, <span class="math inline">\(h=1,\dots,H\)</span>. Sea</p>
<p><span class="math display">\[
\hat{Y}_{hi} = \sum_{k\in s_{hi}} d_{hik} y_{hik}
\]</span></p>
<p>una estimación del total poblacional <span class="math inline">\(Y_{hi}\)</span> de la PSU <span class="math inline">\(i\)</span> en el estrato <span class="math inline">\(h\)</span>. Un estimador insesgado del total poblacional <span class="math inline">\(Y = \sum_{h=1}^H \sum_{i \in U_{1h}} Y_{hi}\)</span> se expresa como</p>
<p><span class="math display">\[
\hat{Y}_{UC} = \sum_{h=1}^H \hat{Y}_h, \quad \text{donde} \quad \hat{Y}_h = \frac{1}{n_h} \sum_{i\in s_{1h}} \hat{Y}_{hi}.
\]</span></p>
<p>El estimador Ultimate Cluster de la varianza correspondiente se calcula mediante:</p>
<p><span class="math display">\[
\hat{V}_{UC}(\hat{Y}) = \sum_{h=1}^H \frac{n_h}{n_h-1} \sum_{i \in s_{1h}} (\hat{Y}_{hi} - \hat{Y}_h)^2
\]</span></p>
<p>Para más detalles, véase Hansen, Hurwitz y Madow (1953, vol. I, p. 257) o Wolter (2007).</p>
<p>Aunque originalmente se diseñó para calcular varianzas de estimadores de totales, el método puede combinarse con linealización de Taylor o ecuaciones de estimación para derivar varianzas de otros parámetros poblacionales formulables como soluciones de ecuaciones de estimación. Esta flexibilidad hace que el método sea aplicable a diversos contextos de análisis de encuestas de hogares.</p>
<p>Un supuesto clave es que, dentro de cada estrato, las PSU se eligen de forma independiente y con reemplazo. En la práctica, la mayoría de las encuestas selecciona PSU sin reemplazo, generando diseños más eficientes. Así, las varianzas calculadas bajo la hipótesis de independencia constituyen aproximaciones de las verdaderas varianzas de muestreo. Cuando la fracción muestral es pequeña (por ejemplo, &lt;5 %), estas aproximaciones suelen ser suficientemente precisas para su uso por oficinas nacionales de estadística o analistas secundarios.</p>
<p>El método Ultimate Cluster destaca por su simplicidad y robustez, lo que lo hace muy atractivo en la práctica. Aunque los métodos más sofisticados que consideran todas las etapas del diseño pueden ofrecer estimaciones de varianza ligeramente más precisas, su aplicación requiere información más detallada y mayor complejidad computacional. Por el contrario, el método Ultimate Cluster proporciona una aproximación confiable y eficiente, especialmente útil al estimar totales o medias en encuestas de hogares. Para un análisis detallado sobre la precisión de esta aproximación y posibles alternativas, véase Särndal, Swensson y Wretman (1992, p. 153).</p>
</div>
<div id="bootstrap" class="section level4 unnumbered hasAnchor">
<h4>Bootstrap<a href="estimación-de-totales-medias-y-razones.html#bootstrap" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>En muchos casos, los microdatos de encuestas públicas omiten información esencial del diseño, como identificadores de estratos o de unidades primarias de muestreo (UPM), para proteger la confidencialidad de los encuestados. Esta omisión limita la capacidad de los usuarios para calcular varianzas válidas. En tales situaciones, se recomienda que las oficinas nacionales de estadística (NSO) proporcionen pesos de replicación, lo que permite a los analistas estimar errores estándar de manera correcta. Sin estos datos, los usuarios secundarios no pueden reproducir los errores estándar publicados ni considerar adecuadamente el diseño complejo de la encuesta.</p>
<p>Los métodos de replicación estiman la varianza generando subconjuntos de la muestra original, calculando estimaciones para cada uno y utilizando la variabilidad observada entre estas estimaciones para aproximar la varianza del estimador principal. Son particularmente útiles cuando no se dispone de información sobre estratos o UPM, situación en la que no se puede aplicar el método de Ultimate Cluster.</p>
<p>El Bootstrap es una herramienta de replicación robusta y versátil. Originalmente introducido por Efron (1979) para datos que no provenían de encuestas, su adaptación más usada para encuestas de hogares es el Bootstrap de Reescalamiento Rao-Wu-Yue (Rao, Wu y Yue, 1992). Este método se ajusta de manera óptima a diseños de muestreo estratificados y multietápicos, y es ampliamente empleado para la estimación de varianzas en encuestas complejas.</p>
<p>El procedimiento consiste en generar muchas réplicas de la muestra original, simulando extracciones repetidas de la población. Cada réplica se construye mediante la creación de columnas adicionales de pesos de replicación en la base de datos, siguiendo este proceso:</p>
<ul>
<li>Para cada estrato, se seleccionan aleatoriamente las UPM con reemplazo; algunas pueden repetirse y otras no aparecer. Cada UPM elegida se incorpora con todas sus observaciones. Si el tamaño de la muestra de primera etapa en el estrato <span class="math inline">\(h\)</span> es mayor que dos (<span class="math inline">\(n_h &gt; 2\)</span>), el número de UPM seleccionadas por réplica es <span class="math inline">\(n_h - 1\)</span>.</li>
<li>Este proceso se repite muchas veces, habitualmente cientos, generando un gran número de réplicas. La cantidad de veces que una UPM <span class="math inline">\(i\)</span> del estrato <span class="math inline">\(h\)</span> aparece en la réplica <span class="math inline">\(r\)</span> se denota <span class="math inline">\(n_{hi}^{(r)}\)</span>, variando entre 0 y <span class="math inline">\(n_h - 1\)</span>.</li>
<li>A partir de cada réplica se calculan nuevos pesos bootstrap para todas las unidades, reflejando cuántas veces fue seleccionada su UPM. El peso de la unidad <span class="math inline">\(k\)</span> en la réplica <span class="math inline">\(r\)</span> se calcula como:</li>
</ul>
<p><span class="math display">\[
w_{hik}^{(r)} = w_{hik} \times \frac{n_h}{n_h - 1} \times n_{hi}^{(r)}
\]</span></p>
<p>Si los pesos originales incluyen ajustes por no respuesta o calibración, estos deben aplicarse también a cada conjunto de pesos bootstrap.</p>
<p>Cuando la NSO proporciona únicamente pesos de replicación Bootstrap, los analistas pueden estimar errores estándar correctamente, aun sin identificadores de estratos o UPM. Para cada réplica <span class="math inline">\(r\)</span>, se calcula el parámetro de interés <span class="math inline">\(\hat{\theta}^{(r)}\)</span> usando los pesos bootstrap <span class="math inline">\(w_{hik}^{(r)}\)</span>. La varianza del estimador original se aproxima mediante la variabilidad entre todas las réplicas:</p>
<p><span class="math display">\[
\hat{V}_B(\hat{\theta}) = \frac{1}{R} \sum_{r=1}^{R} \left(\hat{\theta}^{(r)} - \tilde{\theta}\right)^2, \quad
\tilde{\theta} = \frac{1}{R} \sum_{r=1}^{R} \hat{\theta}^{(r)}
\]</span></p>
<p>Este enfoque asegura que la dispersión entre réplicas capture fielmente la incertidumbre del parámetro.</p>
<p>El Bootstrap ofrece múltiples ventajas. A pesar de requerir un mayor procesamiento computacional, es eficaz para diseños de encuesta complejos y permite estimar parámetros difíciles de calcular con métodos tradicionales, como medianas u otras estadísticas no lineales. Es especialmente útil para analistas que trabajan con bases de datos sin identificadores de estratos y UPM, pero con pesos de replicación.</p>
<p>La simplicidad del método facilita su aplicación incluso sin software estadístico especializado. Sin embargo, la mayoría de los paquetes estadísticos modernos ya incluyen procedimientos para aplicar Bootstrap y calcular varianzas, ampliando su disponibilidad y robustez. No obstante, su uso no es recomendable en encuestas repetidas con muestras superpuestas ni en situaciones con fracciones de muestreo grandes y tamaños de muestra pequeños (Bruch, 2011).</p>
<p>En este ejemplo se muestra cómo estimar totales y sus intervalos de confianza para diferentes variables de interés en R, utilizando dos funciones de la librería survey: la función svytotal para calcular los totales y la función confint para obtener los intervalos de confianza. A continuación, se presentan los códigos correspondientes:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="estimación-de-totales-medias-y-razones.html#cb8-1" tabindex="-1"></a>total_Ingresos<span class="ot">&lt;-</span> <span class="fu">svytotal</span>(<span class="sc">~</span>Income, diseno, <span class="at">deff=</span>T, )</span>
<span id="cb8-2"><a href="estimación-de-totales-medias-y-razones.html#cb8-2" tabindex="-1"></a>total_Ingresos</span></code></pre></div>
<pre><code>##           total       SE DEff
## Income 85793667  4778675   11</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="estimación-de-totales-medias-y-razones.html#cb10-1" tabindex="-1"></a><span class="fu">confint</span>(total_Ingresos, <span class="at">level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##           2.5 %   97.5 %
## Income 76427637 95159697</code></pre>
<p>Los argumentos que utiliza de la función <code>svytotal</code> con muy sencillos. Para el ejemplo, se le introduce primero la variable en la cual está la información que se desea estimar (Income). Posterior a esto, se introduce el diseño muestral del cual proviene la muestra y, por último, se indica si desea que se reporte el deff de la estimación o no.</p>
<p>Por otro lado, para el cálculo del intervalo de confianza, lo único que requiere es indicarle a la función <code>confint</code> el estimador y la confianza requerida.</p>
<p>Paras seguir ilustrando el uso de la función <code>svytotal</code> y de <code>confint</code>, estimemos el total de gastos de los hogares, pero ahora el intervalo de confianza se calculará al 90% de confianza. Los siguientes códigos realizan las estimaciones:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="estimación-de-totales-medias-y-razones.html#cb12-1" tabindex="-1"></a>total_gastos<span class="ot">&lt;-</span> <span class="fu">svytotal</span> (<span class="sc">~</span>Expenditure, diseno, <span class="at">deff=</span>T)</span>
<span id="cb12-2"><a href="estimación-de-totales-medias-y-razones.html#cb12-2" tabindex="-1"></a>total_gastos</span></code></pre></div>
<pre><code>##                total       SE   DEff
## Expenditure 55677504  2604139 10.222</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="estimación-de-totales-medias-y-razones.html#cb14-1" tabindex="-1"></a><span class="fu">confint</span>(total_gastos, <span class="at">level =</span> <span class="fl">0.9</span>)</span></code></pre></div>
<pre><code>##                  5 %     95 %
## Expenditure 51394077 59960931</code></pre>
<p>Si el objetivo ahora es estimar el total de los ingreso de los hogares pero discriminado por sexo, se utilizará ahora la función <code>cascade</code>de la libraría <code>srvyr</code>, la cual permite agregar
la suma de las categorías al final la tabla. También se utilizará la función <code>group_by</code> la cual permite obtener resultados agrupados por los niveles de interés.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="estimación-de-totales-medias-y-razones.html#cb16-1" tabindex="-1"></a>diseno <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Sex) <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="estimación-de-totales-medias-y-razones.html#cb16-2" tabindex="-1"></a>  <span class="fu">cascade</span>(<span class="at">Total =</span> <span class="fu">survey_total</span>(</span>
<span id="cb16-3"><a href="estimación-de-totales-medias-y-razones.html#cb16-3" tabindex="-1"></a>    Income, <span class="at">level =</span> <span class="fl">0.95</span>,</span>
<span id="cb16-4"><a href="estimación-de-totales-medias-y-razones.html#cb16-4" tabindex="-1"></a>    <span class="at">vartype =</span>  <span class="fu">c</span>(<span class="st">&quot;se&quot;</span>, <span class="st">&quot;ci&quot;</span>)),</span>
<span id="cb16-5"><a href="estimación-de-totales-medias-y-razones.html#cb16-5" tabindex="-1"></a>          <span class="at">.fill =</span> <span class="st">&quot;Total ingreso&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 5
##   Sex               Total Total_se Total_low Total_upp
##   &lt;chr&gt;             &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 Female        44153820. 2324452. 39551172. 48756467.
## 2 Male          41639847. 2870194. 35956576. 47323118.
## 3 Total ingreso 85793667. 4778674. 76331414. 95255920.</code></pre>
<p>Como se pudo observar en lo códigos anteriores, otra forma de obtener las estimaciones del total, su desviación estándar y el intervalo de confianza es usando el argumento <code>vartype</code> e indicándole las opciones “se”, “ci” respectivamente.</p>
</div>
</div>
<div id="estimación-de-la-media-e-intervalo-de-confianza" class="section level3 hasAnchor" number="1.3.3">
<h3><span class="header-section-number">1.3.3</span> Estimación de la media e intervalo de confianza<a href="#estimaci%C3%B3n-de-la-media-e-intervalo-de-confianza" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La estimación de la media poblacional es un parámetro muy importante en las encuestas de hogares, dado que, por ejemplo, uno de los indicadores trazadores en este tipo de encuestas son los ingresos medios por hogar. Además, este tipo de parámetros no permiten describir y analizar las tendencias centrales de estas variables en poblaciones de interés. Según <strong>Gutiérrez (2016)</strong> un estimador de la media poblacional se puede escribir como una razón no lineal de dos totales de población finitas estimados como sigue:</p>
<p><span class="math display">\[\begin{eqnarray*}
\bar{Y}_{\omega} &amp; = &amp; \frac{\sum_{h=1}^{H}\sum_{\alpha=1}^{a_{h}}\sum_{i=1}^{n_{h\alpha}}\omega_{h\alpha i}y_{h\alpha i}}{\sum_{h=1}^{H}\sum_{\alpha=1}^{a_{h}}\sum_{i=1}^{n_{h\alpha}}\omega_{h\alpha i}}\\
&amp; = &amp; \frac{\hat{Y}}{\hat{N}}.
\end{eqnarray*}\]</span></p>
<p>Como una observación tenga en cuenta que, si <span class="math inline">\(y\)</span> es una variable
binaria, la media ponderada estima la proporción de la población.
Por otro lado, como <span class="math inline">\(\bar{Y}_{\omega}\)</span> no es una estadística lineal,
no existe una fórmula cerrada para la varianza de este estimador.
Es por lo anterior que, se deben recurrir a usar métodos de remuestreo
o series de Taylor. Para este caso en particular, usando series de
Taylor el estimador insesgado de la varianza para este estimador es:</p>
<p><span class="math display">\[\begin{eqnarray*}
var\left(\bar{Y}_{\omega}\right) &amp; \dot{=} &amp; \frac{var\left(\hat{Y}\right)+\bar{Y}_{\omega}^{2}\times var\left(\hat{N}\right)-2\times\bar{Y}_{\omega}\times cov\left(\hat{Y},\hat{N}\right)}{\hat{N}^{2}}
\end{eqnarray*}\]</span></p>
<p>Como se puede observar, el cálculo de la estimación de la varianza tiene componentes complejos de calcular de manera analítica, como la covarianza entre el total estimado y el tamaño poblacional estimado. Sin embargo, <code>R</code> tiene funciones que incorpora estos estimadores. A continuación, se presenta la sintaxis para hacer dichos cálculos.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="estimación-de-totales-medias-y-razones.html#cb18-1" tabindex="-1"></a>Media_ingresos<span class="ot">&lt;-</span> <span class="fu">svymean</span>(<span class="sc">~</span>Income, diseno, <span class="at">deff=</span>T)</span>
<span id="cb18-2"><a href="estimación-de-totales-medias-y-razones.html#cb18-2" tabindex="-1"></a>Media_ingresos</span></code></pre></div>
<pre><code>##           mean      SE   DEff
## Income 570.945  28.478 8.8211</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="estimación-de-totales-medias-y-razones.html#cb20-1" tabindex="-1"></a><span class="fu">confint</span>(Media_ingresos, <span class="at">level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##           2.5 %   97.5 %
## Income 515.1299 626.7607</code></pre>
<p>Como se puede observar, los argumentos que utiliza la función <code>svymean</code> para realizar la estimación de la media de los ingresos de los hogares y la desviación estándar estimada del estimador son similares a los utilizando con la función <code>svytotal</code>. Similarmente ocurre con el intervalo de confianza.</p>
<p>Por otro lado, tal como se realizó con el total, a manera de ejemplo, se estima la media de los gastos en los hogares como sigue a continuación:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="estimación-de-totales-medias-y-razones.html#cb22-1" tabindex="-1"></a>Media_gastos<span class="ot">&lt;-</span> <span class="fu">svymean</span> (<span class="sc">~</span>Expenditure, diseno, <span class="at">deff=</span>T)</span>
<span id="cb22-2"><a href="estimación-de-totales-medias-y-razones.html#cb22-2" tabindex="-1"></a>Media_gastos</span></code></pre></div>
<pre><code>##                mean      SE   DEff
## Expenditure 370.526  13.294 6.0156</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="estimación-de-totales-medias-y-razones.html#cb24-1" tabindex="-1"></a><span class="fu">confint</span>(Media_gastos)</span></code></pre></div>
<pre><code>##                2.5 %   97.5 %
## Expenditure 344.4697 396.5829</code></pre>
<!-- También se pueden realizar estimaciones de la media por subgrupos siguiendo el mismo esquema mostrado para la función `svytotal`. Particularmente, los gastos de los hogares discriminados por sexo es: -->
<!-- ```{r} -->
<!-- diseno %>% group_by(Sex) %>% -->
<!--   cascade( -->
<!--     Media = survey_mean( -->
<!--       Expenditure, level = 0.95, -->
<!--        vartype =  c("se", "ci")),  -->
<!--         .fill = "El gasto medio"  ) %>% -->
<!--   arrange(desc(Sex)) -->
<!-- ``` -->
<!-- Por zona, -->
<!-- ```{r} -->
<!-- diseno %>% group_by(Zone) %>% -->
<!--   cascade( -->
<!--     Media = survey_mean( -->
<!--       Expenditure, level = 0.95, -->
<!--        vartype =  c("se", "ci")),  -->
<!--         .fill = "El gasto medio")%>% -->
<!--   arrange(desc(Zone)) -->
<!-- ``` -->
<!-- Por sexo y zona, -->
<!-- ```{r} -->
<!-- diseno %>% group_by(Zone, Sex) %>% -->
<!--   cascade( -->
<!--     Media = survey_mean( -->
<!--       Expenditure, level = 0.95, -->
<!--        vartype =  c("se", "ci")), -->
<!--         .fill = "El gasto medio") %>% -->
<!--   arrange(desc(Zone), desc(Sex)) %>% -->
<!--   data.frame() -->
<!-- ``` -->
<!-- Las medias o promedios poblacionales son esenciales para describir la tendencia central de una variable. Por ejemplo, el gasto promedio de los hogares es un indicador representativo del comportamiento económico de la población. Su cálculo consiste en dividir el total estimado de la variable entre el tamaño poblacional estimado, de modo que su precisión depende de la exactitud en ambos componentes. -->
<!-- El estimador de la media poblacional se puede expresar como: -->
<!-- $$ -->
<!-- \widehat{\bar{Y}} = \frac{\displaystyle \sum_{h=1}^{H} \sum_{i \in s_{1h}} \sum_{k \in s_{hi}} w_{hik} y_{hik}} {\displaystyle \sum_{h=1}^{H} \sum_{i \in s_{1h}} \sum_{k \in s_{hi}} w_{hik}} = \frac{\hat{Y}}{\hat{N}} -->
<!-- $$ -->
<!-- Dado que $\widehat{\bar{Y}}$ es un estimador no lineal, su varianza exacta no puede expresarse en forma cerrada. Por ello, los paquetes estadísticos especializados en encuestas complejas emplean métodos como el remuestreo o la aproximación de Taylor, que se implementan automáticamente para facilitar su cálculo. -->
<!-- ### Estimación de medidas de dispersión y localización -->
<!-- En las encuestas de hogares siempre es necesario estimar medidas de dispersión de las variables estudiadas. Esto con el fin de, por ejemplo, ver qué tan disímiles son los ingresos medios de los hogares en un país determinado y con esto poder tomar acciones de política pública. Por lo anterior, es importante estudiar este parámetro en este texto. A continuación, se presenta el estimador de la desviación estándar: -->
<!-- \begin{eqnarray} -->
<!-- s\left(y\right){}_{\omega} & = & \frac{\sum_{h=1}^{H}\sum_{\alpha=1}^{a_{h}}\sum_{i=1}^{n_{h\alpha}}\omega_{h\alpha i}\left(y_{h\alpha i}-\bar{Y}_{\omega}\right)^{2}}{\sum_{h=1}^{H}\sum_{\alpha=1}^{a_{h}}\sum_{i=1}^{n_{h\alpha}}\omega_{h\alpha i}-1} -->
<!-- \end{eqnarray} -->
<!-- Para llevar a cabo la estimación en `R` de la desviación estándar en encuestas de hogares, se utilizan la función `survey_var` la cual se ejemplifica a continuación: -->
<!-- ```{r} -->
<!-- (sd_Est <- diseno %>% group_by(Zone) %>%  -->
<!--    summarise(Sd = sqrt( -->
<!--   survey_var( -->
<!--     Income, -->
<!--     level = 0.95, -->
<!--     vartype =  c("se", "ci"), -->
<!--   ) ))) -->
<!-- ``` -->
<!-- Como se pudo ver en el ejemplo anterior, se estimó la desviación estándar de los ingresos por zona reportando el error estándar en la estimación y un intervalo de confianza al 95%. Los argumentos que utiliza la función `survey_var` son similares a los usados en las funciones anteriores para estimar medias y totales. -->
<!-- Si el interés ahora se centra en estimar la desviación estándar clasificando por sexo y zona, los códigos computacionales son los siguientes: -->
<!-- ```{r} -->
<!-- (sd_Est <- diseno %>% group_by(Zone, Sex) %>%  -->
<!--    summarise(Sd = sqrt( -->
<!--   survey_var( -->
<!--     Income, -->
<!--     level = 0.95, -->
<!--     vartype =  c("se", "ci"), -->
<!--    ) -->
<!-- ))) %>% data.frame() -->
<!-- ``` -->
<!-- Las medidas de posición no central (Percentiles) se diseñaron con el fin de conocer otros puntos característicos de la distribución de los datos que no son los valores centrales. Entre las medidas de posición no central más importantes están la mediana, cuartiles y percentiles. En la mayoría de las encuestas de hogares no solo estiman totales, medias y proporciones. En algunos indicadores es necesario estimar otros parámetros, por ejemplo, medianas y percentiles. Como lo menciona **Tellez et al (2015)** la mediana una medida de tendencia central la cual, a diferencia del promedio, no es fácilmente influenciada por datos atípicos y, por esto, se conoce como una medida robusta. La mediana es el valor que divide la población en dos partes iguales. Lo que implica que, la mitad de las observaciones de la característica de interés está por encima de la media y la otra mitad está por debajo.  -->
<!-- Por otro lado, la estimación de percentiles de ingresos en un país determinado puede definir el inicio de una política pública. por ejemplo, poner a tributar aquellas personas naturales que son el 10% más alto de la distribución de los ingresos o por el contrario, generar subsidios de transporte a aquellas familias que están en el 15% inferior de la distribución de los ingresos. -->
<!-- La estimación de cuantiles **(Loomis et al., 2005)** se basa en los resultados relacionados con el estimador ponderado para totales, empleando una estimación de la función de distribución (CDF, por sus siglas en inglés) acumulada de la población. Específicamente, la CDF para una variable y en una población finita dada de tamaño $N$ se define de la siguiente manera: -->
<!-- \begin{eqnarray*} -->
<!-- F\left(x\right) & = & \frac{{ \sum_{i=1}^{N}}I\left(y_{i}\leq x\right)}{N} -->
<!-- \end{eqnarray*} -->
<!-- Donde, $I\left(y_{i}\leq x\right)$ es una variable indicadora la -->
<!-- cual es igual a 1 si $y_{i}$ es menor o igual a un valor específico -->
<!-- $x$, 0 en otro caso. Un estimador de la CDF en un diseño complejo -->
<!-- (encuesta de hogares) de tamaño $n$ está dado por: -->
<!-- \begin{eqnarray*} -->
<!-- \hat{F}\left(x\right) & = & \frac{\sum_{h=1}^{H}\sum_{\alpha=1}^{a_{h}}\sum_{i=1}^{n_{h\alpha}}\omega_{h\alpha i}I\left(y_{i}\leq x\right)}{\sum_{h=1}^{H}\sum_{\alpha=1}^{a_{h}}\sum_{i=1}^{n_{h\alpha}}\omega_{h\alpha i}} -->
<!-- \end{eqnarray*} -->
<!-- Una vez estimada la CDF utilizando los pesos del diseño muestral, el cuantil q-ésimo de una variable $y$ es el valor más pequeño de $y$ tal que la CDF de la población es mayor o igual que $q$. Como es bien sabido, la mediana es aquel valor donde la CDF es mayor o igual a 0.5 y, por tanto, la media estimada es aquel valor donde la estimación de CDF es mayor o igual a 0.5. -->
<!-- Siguiendo las recomendaciones de *Heeringa et al (2017)* para estimar cuantiles, primero se considera las estadísticas de orden que se denotan como $y_{1},\ldots,y_{n}$, y encuentra el valor de $j$ $(j=1,\ldots,n)$ tal que: -->
<!-- \begin{eqnarray*} -->
<!--  & \hat{F}\left(y_{j}\right)\leq q\leq\hat{F}\left(y_{j+1}\right) -->
<!-- \end{eqnarray*} -->
<!-- Ahora bien, la estimación del q-ésimo cuantil $Y_{q}$ en un diseño de muestreo complejo está dado por: -->
<!-- \begin{eqnarray*} -->
<!-- \hat{Y}_{q} & = & y_{j}+\frac{q-\hat{F}\left(y_{j}\right)}{\hat{F}\left(y_{j+1}\right)-\hat{F}\left(y_{j}\right)}\left(y_{j+1}-y_{j}\right) -->
<!-- \end{eqnarray*} -->
<!-- Para la estimación de la varianza e intervalos de confianza de cuantiles, **Kovar et al. (1988)** muestra los resultados de un estudio de simulación en donde recomienda el uso de Balanced Repeated Replication (BRR) para estimarla.  -->
<!-- Los estimadores y procedimientos antes mencionados para la estimación de percentiles y sus varianzas están implementados en `R`. Particularmente, la estimación de la mediana se realiza usando la función `survey_median`. A continuación, se muestra la sintaxis de cómo calcular la mediana de los gastos, la desviación estándar y el intervalo de confianza al 95% de los hogares en la base de datos de ejemplo. -->
<!-- ```{r} -->
<!-- diseno %>% summarise(Mediana =  -->
<!--   survey_median( -->
<!--     Expenditure, -->
<!--     level = 0.95, -->
<!--     vartype =  c("se", "ci"), -->
<!--    )) -->
<!-- ``` -->
<!-- Como se puede observar, los argumentos de la función `survey_median` son similares a los del total y la media. -->
<!-- Ahora bien, al igual que con los demás parámetros, si el objetivo ahora es estimar la mediana de los gastos de los hogares, pero esta vez discriminada por zona y también por sexo, el código computacional sería el siguiente: -->
<!-- ```{r} -->
<!-- diseno %>% group_by(Zone) %>%  -->
<!--   summarise(Mediana =  -->
<!--   survey_median( -->
<!--     Expenditure, -->
<!--     level = 0.95, -->
<!--     vartype =  c("se", "ci"), -->
<!--    )) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- diseno %>% group_by(Sex) %>%  -->
<!--   summarise(Mediana =  -->
<!--   survey_median( -->
<!--     Expenditure, -->
<!--     level = 0.95, -->
<!--     vartype =  c("se", "ci"), -->
<!--    )) -->
<!-- ``` -->
<!-- Si el objetivo ahora es estimar cuantiles, por ejemplo, el cuantil 0.25 de los gastos de los hogares, se realizaría usando la función `survey_quantile` como sigue: -->
<!-- ```{r} -->
<!-- diseno %>%  -->
<!--   summarise( -->
<!--     Q =  survey_quantile( -->
<!--     Expenditure, -->
<!--     quantiles = 0.5, -->
<!--     level = 0.95, -->
<!--     vartype =  c("se", "ci"), -->
<!--     interval_type = "score" -->
<!--    )) -->
<!-- ``` -->
<!-- si ahora se desea estimar el cuantil 0.25 pero discriminando por sexo y por zona se realizaría como sigue: -->
<!-- ```{r} -->
<!-- diseno %>% group_by(Sex) %>%  -->
<!--   summarise( -->
<!--     Q =  survey_quantile( -->
<!--     Expenditure, -->
<!--     quantiles = 0.25, -->
<!--     level = 0.95, -->
<!--     vartype =  c("se", "ci"), -->
<!--     interval_type = "score" -->
<!--    )) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- diseno %>% group_by(Zone) %>%  -->
<!--   summarise( -->
<!--     Q =  survey_quantile( -->
<!--     Expenditure, -->
<!--     quantiles = 0.25, -->
<!--     level = 0.95, -->
<!--     vartype =  c("se", "ci"), -->
<!--     interval_type = "score" -->
<!--    )) -->
<!-- ``` -->
<!-- ## Estimación del coeficiente de Gini en encuestas de hogares -->
<!-- Para iniciar esta sección tengamos en cuenta la siguiente reflexión: *Definir lo justo siempre será difícil y es algo a lo que quizá sea poco realista aspirar a conseguir. Sin embargo, si estamos un poco más conscientes de cómo la desigualdad afecta nuestra libertad y cómo se refleja en el bienestar y calidad de vida de las personas, podremos poner en contexto una discusión que tendremos cada vez más presente en el mundo y en el país.* -->
<!-- La desigualdad es un problema común en todos los países del mundo. En el ámbito económico, representa uno de los desafíos más relevantes para gobiernos y organismos internacionales. De hecho, Naciones Unidas lo reconoce explícitamente dentro de los Objetivos de Desarrollo Sostenible (ODS). -->
<!-- Entre las métricas más utilizadas para medir la desigualdad económica se encuentra el coeficiente de Gini (CG), el cual compara la distribución de ingresos observada con una distribución perfectamente equitativa. Su valor oscila entre 0 (igualdad perfecta) y 1 (máxima desigualdad). Así, un valor de $G = 0$ implica que todos los hogares tienen el mismo nivel de ingresos, mientras que valores más altos reflejan concentraciones crecientes de ingresos en una fracción menor de la población. Este indicador es clave para: -->
<!-- * Evaluar los cambios en la distribución del ingreso a lo largo del tiempo. -->
<!-- * Comparar los niveles de desigualdad entre regiones o países. -->
<!-- * Contextualizar políticas públicas y sociales orientadas a la equidad. -->
<!-- En encuestas de hogares, el cálculo del coeficiente de Gini debe incorporar los pesos muestrales ajustados al diseño de la encuesta, que con frecuencia se normalizan para simplificar el procesamiento. -->
<!-- De acuerdo con Binder y Kovacevic (1995), el estimador del coeficiente de Gini puede expresarse como: -->
<!-- $$ -->
<!-- \hat{G} = \frac{2\sum_{h=1}^{H}\sum_{\alpha=1}^{a_{h}}\sum_{i=1}^{n_{h\alpha}}\omega_{h\alpha i}^{*}\hat{F}_{h\alpha i}y_{h\alpha i}-1}{\bar{y}_{\omega}} -->
<!-- $$ -->
<!-- donde: -->
<!-- * $\omega_{h\alpha i}^{*}=\dfrac{\omega_{h\alpha i}}{\sum\_{h=1}^{H}\sum\_{\alpha=1}^{a_{h}}\sum\_{i=1}^{n\_{h\alpha}}\omega_{h\alpha i}}$ es el peso normalizado. -->
<!-- * $\hat{F}\_{h\alpha i}$ representa la función de distribución acumulada (CDF) estimada en el conglomerado $\alpha$ del estrato $h$. -->
<!-- * $\bar{y}\_{\omega}$ corresponde a la media ponderada de los ingresos. -->
<!-- Autores como Osier (2009) y Langel y Tillé (2013) profundizan en aspectos técnicos adicionales relacionados con la estimación de la varianza de este estimador en el contexto de encuestas complejas. -->
<!-- Para calcular el índice de Gini y su varianza estimada en una encuesta de hogares, `R` tiene cargados los procedimientos en la librería `convey`.  A continuación, se muestra la sintaxis de cómo se realiza la estimación del índice de Gini para los hogares en la base de ejemplo de este capítulo.  -->
<!-- ```{r, eval=T} -->
<!-- library(convey) -->
<!--  diseno_gini <- convey_prep(diseno) -->
<!-- svygini( ~Income, design = diseno_gini) %>% -->
<!--   data.frame() -->
<!-- ``` -->
<!-- En primer lugar, se carga el diseño de muestreo con la función `convey_prep`. Luego, se estima el índice Gini con la función `svygini`. En los argumentos de esta última función se introducen la variable ingresos y el diseño muestral complejo. -->
<!-- Por otro lado, si el interés ahora es estimar la **curva de Lorenz**. La cual, según *Kovacevic, M. S. et. al (1997)* para una distribución dada de ingresos, traza el porcentaje acumulado de la población (desplegado desde el más pobre hasta el más rico) frente a su participación en el ingreso total. El área entre la curva de Lorenz y la línea de 45 grados se conoce como el área de Lorenz. El índice de Gini es igual al doble del área de Lorenz. Una población con la curva de Lorenz más cerca de la línea de 45 grados tiene una distribución de ingresos más equitativa. Si todos los ingresos son iguales, la curva de Lorenz degenera a la línea de 45 grados. -->
<!-- Para realizar la curva de Lorenz en `R` se utiliza la función `svylorenz`. A continuación, se muestran los códigos computacionales para realizar la curva de Lorenz para los ingresos: -->
<!-- ```{r, out.width="70%", fig.align="center"} -->
<!-- library(convey) -->
<!-- svylorenz(formula = ~Income,  -->
<!--           design = diseno_gini,  -->
<!--           quantiles = seq(0,1,.05),  -->
<!--           alpha = .01 ) -->
<!-- ``` -->
<!-- Los argumentos que requiere la función son, inicialmente, los ingresos de los hogares y el diseño muestral complejo. Adicionalmente, se definen una secuencia de probabilidades que define la suma de los cuantiles a calcular (quantiles) y por último, un número que especifica el nivel de confianza para el gráfico (alpha). -->
<!-- ## Análisis de correlación en encuestas de hogares   -->
<!-- En el estudio de encuestas de hogares, además de describir variables de forma individual, resulta fundamental analizar cómo se relacionan entre sí. Una de las herramientas más utilizadas es el coeficiente de correlación de Pearson, que mide la fuerza y la dirección de la relación lineal entre dos variables numéricas. Sus valores oscilan entre –1 y 1:   -->
<!-- - Un valor positivo indica que ambas variables tienden a aumentar al mismo tiempo.   -->
<!-- - Un valor negativo señala que cuando una variable crece, la otra tiende a disminuir.   -->
<!-- - Valores próximos a cero sugieren una relación lineal débil o inexistente.   -->
<!-- Por ejemplo, puede ser de interés analizar si el ingreso de los hogares está asociado con su nivel de gasto, y en qué magnitud.   -->
<!-- ### Ajuste al diseño muestral   -->
<!-- En encuestas complejas, la correlación no puede calcularse como en una muestra simple. Es necesario incorporar los pesos muestrales para que la estimación sea representativa de la población. Este ajuste tiene en cuenta la estratificación, la conglomeración y las probabilidades de selección desiguales.   -->
<!-- El cálculo ponderado implica evaluar la covarianza entre las dos variables y dividirla entre el producto de sus desviaciones estándar ponderadas, eliminando así la influencia de las unidades de medida.   -->
<!-- ### Expresión formal   -->
<!-- El coeficiente de correlación de Pearson ajustado por pesos se expresa como:   -->
<!-- $$\hat{\rho}_{xy} = \frac{\displaystyle \sum_{h=1}^{H} \sum_{i \in s_{1h}} \sum_{k \in s_{hi}} w_{hik} (y_{hik} - \widehat{\bar{Y}})(x_{hik} - \widehat{\bar{X}})} {\sqrt{\displaystyle \sum_{h=1}^{H} \sum_{i \in s_{1h}} \sum_{k \in s_{hi}} w_{hik} (y_{hik} - \widehat{\bar{Y}})^2} \sqrt{\displaystyle \sum_{h=1}^{H} \sum_{i \in s_{1h}} \sum_{k \in s_{hi}} w_{hik} (x_{hik} - \widehat{\bar{X}})^2}}$$   -->
<!-- Cuando las variables son categóricas u ordinales, se deben emplear otras medidas de asociación (como el coeficiente de contingencia o de correlación policórica).   -->
<!-- ### Implementación en R   -->
<!-- El paquete `survey` cuenta con la función `svyvar` que permite obtener matrices de covarianzas ponderadas, a partir de las cuales se puede calcular la correlación. Otra opción más directa es usar `svycor` de paquetes complementarios como `svycor` o implementar el cálculo manualmente.   -->
<!-- Ejemplo con ingreso y gasto de los hogares:   -->
<!-- ```{r} -->
<!-- # Covarianza ponderada -->
<!-- svy_cov <- svyvar(~Income + Expenditure, design = diseno) -->
<!-- ``` -->
<!-- El resultado entrega la matriz de correlaciones entre las variables analizadas bajo el diseño complejo.   -->
<!-- ## Análisis de la relación entre dos variable continuas -->
<!-- En muchos análisis de variables relacionadas con encuestas de hogares no solo basta con analizar el comportamiento de variables de manera individual, por ejemplo, ingresos medios de hombres y mujeres en un país sino también, analizar la diferencia entre los ingresos de los hombres y las mujeres. Esto último con el fin de ir cerrando la brecha salarial que existe.  -->
<!-- En este capítulo se estudiará la prueba de hipótesis para diferencia de medias, se darán las herramientas computacionales para estimar razones y contrastes. -->
<!-- ## Pruebas para la comparación de grupos -->
<!-- El análisis de diferencias entre grupos es un objetivo frecuente en las encuestas de hogares. Un ejemplo clásico es la pregunta: *¿Existen diferencias estadísticamente significativas en el ingreso medio entre hogares dirigidos por hombres y aquellos dirigidos por mujeres?* -->
<!-- Para responder a este tipo de interrogantes se aplican **pruebas de hipótesis**, procedimientos estadísticos que contrastan afirmaciones sobre parámetros poblacionales a partir de evidencia muestral. En el contexto de encuestas, estas pruebas deben ajustarse al diseño de muestreo (estratificación, conglomerados y ponderación) para garantizar inferencias válidas. -->
<!-- ### Planteamiento general de hipótesis -->
<!-- Una prueba de hipótesis parte de dos proposiciones antagónicas: -->
<!-- $$ -->
<!-- \begin{cases} -->
<!-- H_{0}: & \theta = \theta_0 \quad \text{(hipótesis nula)} \\ -->
<!-- H_{1}: & \theta \neq \theta_0 \quad \text{(hipótesis alternativa, bilateral)}  -->
<!-- \end{cases} -->
<!-- $$ -->
<!-- Dependiendo del contexto, $H_1$ puede plantearse de manera unilateral ($\theta > \theta_0$ o $\theta < \theta_0$). El proceso consiste en evaluar si la evidencia contenida en la muestra es suficiente para rechazar $H_0$ en favor de $H_1$. -->
<!-- En muchos casos, los parámetros de interés (medias, proporciones, totales o razones) pueden expresarse como **combinaciones lineales de estadísticas descriptivas**: -->
<!-- $$ -->
<!-- f(\theta_1,\ldots,\theta_J) = \sum_{j=1}^J a_j \theta_j -->
<!-- $$ -->
<!-- con estimador: -->
<!-- $$ -->
<!-- \hat{f} = \sum_{j=1}^J a_j \hat{\theta}_j -->
<!-- $$ -->
<!-- y varianza: -->
<!-- $$ -->
<!-- Var(\hat{f}) = \sum_{j=1}^J a_j^2 Var(\hat{\theta}_j) \;+\; 2\sum_{j=1}^{J-1}\sum_{k>j}^J a_j a_k \, Cov(\hat{\theta}_j,\hat{\theta}_k). -->
<!-- $$ -->
<!-- Este marco general abarca, entre otros casos, la **diferencia entre medias poblacionales**. -->
<!-- ### Diferencia de medias poblacionales -->
<!-- Sea $\mu_{(y,d)}$ la media poblacional del dominio $d$, con $d=1,2$. El parámetro de interés es: -->
<!-- $$ -->
<!-- \Delta = \mu_{(y,1)} - \mu_{(y,2)}. -->
<!-- $$ -->
<!-- Por ejemplo, $\mu_{(y,1)}$ podría ser el ingreso medio en hogares con jefatura masculina y $\mu_{(y,2)}$ el ingreso medio en hogares con jefatura femenina. -->
<!-- El estimador de la diferencia es: -->
<!-- $$ -->
<!-- \hat{\Delta} = \hat{\bar{Y}}_1 - \hat{\bar{Y}}_2, -->
<!-- $$ -->
<!-- cuyo error estándar se calcula como: -->
<!-- $$ -->
<!-- \hat{se}(\hat{\Delta}) = \sqrt{ \hat{Var}(\hat{\bar{Y}}_1) + \hat{Var}(\hat{\bar{Y}}_2) - 2 \hat{Cov}(\hat{\bar{Y}}_1, \hat{\bar{Y}}_2)}. -->
<!-- $$ -->
<!-- ### Estadístico de prueba e intervalo de confianza -->
<!-- El contraste se realiza con el estadístico: -->
<!-- $$ -->
<!-- t = \frac{\hat{\Delta}}{\hat{se}(\hat{\Delta})}, \quad t \sim t_{(df)}, -->
<!-- $$ -->
<!-- donde los grados de libertad se aproximan como $df = n - H$ (número de UPMs menos número de estratos). -->
<!-- El intervalo de confianza para $\Delta$ al nivel $(1-\alpha)$ se define como: -->
<!-- $$ -->
<!-- \hat{\Delta} \;\pm\; t_{(1-\alpha/2,df)} \, \hat{se}(\hat{\Delta}). -->
<!-- $$ -->
<!-- ### Ejemplo aplicado en `R` -->
<!-- En encuestas complejas, estas pruebas se implementan con la función `svyttest()` del paquete survey, que incorpora automáticamente los ajustes del diseño. -->
<!-- **Ejemplo 1. Diferencia de ingresos por sexo (población total):** -->
<!-- ```{r, eval=TRUE} -->
<!-- svyttest(Income ~ Sex, design = diseno, level = 0.95)  -->
<!-- ``` -->
<!-- **Resultados (ejemplo ficticio):** -->
<!-- * Estadístico t = -1.48 -->
<!-- * p-valor = 0.14 -->
<!-- * Intervalo de confianza (95%): (-77.35 , 11.41) -->
<!-- Interpretación: con un 95% de confianza no existe evidencia estadística suficiente para afirmar que los ingresos medios difieren por sexo. -->
<!-- **Ejemplo 2. Diferencia de ingresos por sexo en zona urbana:** -->
<!-- ```{r, eval=TRUE} -->
<!-- svyttest(Income ~ Sex, design = sub_Urbano, level = 0.95)  -->
<!-- ``` -->
<!-- Resultado: nuevamente no se rechaza $H_0$, lo que indica ausencia de diferencias significativas en el ingreso medio por sexo en la zona urbana. -->
<!-- **Ejemplo 3. Diferencia de ingresos por sexo, restringido a mayores de 18 años:** -->
<!-- ```{r, eval=TRUE} -->
<!-- svyttest(Income ~ Sex,  -->
<!--          design = diseno %>% filter(Age > 18),  -->
<!--          level = 0.95) -->
<!-- ``` -->
<!-- Conclusión: tampoco se rechaza $H_0$. Es decir, no se observa evidencia estadística de diferencias en los ingresos medios entre hombres y mujeres mayores de 18 años. -->
<!-- El procedimiento descrito no se limita a las medias, sino que también puede aplicarse a proporciones, totales, razones o cualquier función diferenciable de totales. En todos los casos, el contraste se fundamenta en la estimación puntual, su varianza (incluyendo covarianzas cuando corresponde) y la comparación con la distribución t ajustada al diseño muestral. -->
<!-- ## Estimando razones en encuestas de hogares -->
<!-- Un caso particular de una función no lineal de totales es la **razón poblacional**, definida como el cociente de dos totales poblacionales de características de interés. En encuestas de hogares, este parámetro es relevante cuando, por ejemplo, se requiere conocer la cantidad de hombres por cada mujer, la proporción de ocupados respecto a la población en edad de trabajar, o la cantidad de mascotas por cada hogar. Puesto que la razón es un cociente de totales, tanto el numerador como el denominador son cantidades desconocidas y, por lo tanto, deben estimarse *(Bautista, 1998)*. Formalmente, la razón poblacional se define como: -->
<!-- $$ -->
<!-- R = \frac{Y}{X} -->
<!-- $$ -->
<!-- y su estimador puntual en el marco de un muestreo complejo se expresa como: -->
<!-- $$ -->
<!-- \hat{R} = \frac{\hat{Y}}{\hat{X}} -->
<!-- = \frac{\sum_{h=1}^{H}\sum_{\alpha=1}^{a_{h}}\sum_{i=1}^{n_{h\alpha}}\omega_{h\alpha i} y_{h\alpha i}} -->
<!--        {\sum_{h=1}^{H}\sum_{\alpha=1}^{a_{h}}\sum_{i=1}^{n_{h\alpha}}\omega_{h\alpha i} x_{h\alpha i}}. -->
<!-- $$ -->
<!-- Sin embargo, dado que \$\hat{R}\$ es un cociente entre dos estimadores —es decir, dos variables aleatorias— el cálculo de su varianza no es trivial. Para ello se emplea la linealización de Taylor, como lo muestra *Gutiérrez (2016)*, o bien métodos de remuestreo. En términos de la función de estimación, se define: -->
<!-- $$ -->
<!-- z_{hik} = y_{hik} - \hat{R}x_{hik}, -->
<!-- $$ -->
<!-- y a partir de esta expresión se aplica el estimador de varianza descrito en la Sección 9.2. -->
<!-- ### Implementación computacional en `R` {-} -->
<!-- En la práctica, estos cálculos se facilitan gracias a los paquetes especializados. En particular, la función `survey_ratio` implementa la estimación de razones y sus varianzas en el marco de encuestas complejas. Para ello es necesario especificar claramente: -->
<!-- * La variable del **Expenditure** (`numerator`), -->
<!-- * La variable del **Income** (`denominator`), -->
<!-- * El nivel de confianza (`level`) para los intervalos, y -->
<!-- * Las estadísticas de resumen deseadas (`vartype`). -->
<!-- A continuación, se ilustra cómo estimar la razón entre el gasto y el ingreso de los hogares: -->
<!-- ```{r, eval=TRUE} -->
<!-- diseno %>% summarise( -->
<!--     Razon =  survey_ratio( -->
<!--       numerator = Expenditure, -->
<!--       denominator = Income, -->
<!--       level = 0.95, -->
<!--     vartype =  c("se", "ci") -->
<!--     )) -->
<!-- ``` -->
<!-- ### Interpretación aplicada {-} -->
<!-- Las razones permiten expresar la relación entre dos variables, lo cual resulta especialmente útil para construir indicadores comparativos y de seguimiento. Un ejemplo directo en encuestas de hogares es la razón **gasto/ingreso**, que ayuda a identificar patrones de consumo y niveles de sostenibilidad económica de los hogares. -->
<!-- Más allá de este caso, las razones también se utilizan en marcos internacionales. Por ejemplo, el **Indicador 2.1.1 de los Objetivos de Desarrollo Sostenible (ODS)** —prevalencia de subalimentación— se calcula a partir de la razón entre el consumo de alimentos, medido en calorías ingeridas, y los requerimientos energéticos mínimos de la dieta, determinados según edad, sexo y nivel de actividad física. -->
<!-- De esta forma, las razones constituyen una herramienta central para transformar los resultados de encuestas en indicadores significativos que facilitan el análisis de realidades socioeconómicas y poblacionales. -->
<!-- Como se puede observar, la razón entre el gasto y el ingreso es, aproximando, 0.71. Lo que implica que por cada unidad 100 unidades monetarias que le ingrese al hogar, se gastan 71 unidades, consiguiendo un intervalo de confianza al 95% de 0.65 y 0.76. -->
<!-- Si ahora el objetivo es estimar la razón entre mujeres y hombres en la base de ejemplo, se realiza de la siguiente manera: -->
<!-- ```{r} -->
<!-- diseno %>% summarise( -->
<!--     Razon =  survey_ratio( -->
<!--       numerator = (Sex == "Female"), -->
<!--       denominator = (Sex == "Male"), -->
<!--       level = 0.95, -->
<!--     vartype =  c("se", "ci") -->
<!--     )) -->
<!-- ``` -->
<!-- Como la variable sexo en la base de datos es una variable categórica, se tuvo la necesidad de generar las variables dummys para su cálculo realizando, Sex == "Female" para el caso de las mujeres y Sex == "Male" para el caso de los hombres. Los resultados del ejercicio anterior muestran que en la base de datos hay más mujeres que hombres, generando una razón de 1.13. Esto significa que, por cada 100 hombres hay aproximadamente 113 mujeres con un intervalo que varía entre 1.04 y 1.21. -->
<!-- Si se desea hacer la razón de mujeres y hombres pero en la zona rural, se haría de la siguiente manera: -->
<!-- ```{r} -->
<!-- sub_Rural %>% summarise( -->
<!--     Razon =  survey_ratio( -->
<!--       numerator = (Sex == "Female"), -->
<!--       denominator = (Sex == "Male"), -->
<!--       level = 0.95, -->
<!--     vartype =  c("se", "ci") -->
<!--     )) -->
<!-- ``` -->
<!-- Obteniendo nuevamente que hay más mujeres que hombres. Ahora bien, otro análisis de interés es estimar la razón de gastos pero solo en la población femenina. A continuación, se presentan los códigos computacionales. -->
<!-- ```{r} -->
<!-- sub_Mujer %>% summarise( -->
<!--     Razon =  survey_ratio( -->
<!--       numerator = Expenditure, -->
<!--       denominator = Income, -->
<!--       level = 0.95, -->
<!--     vartype =  c("se", "ci") -->
<!--     )) -->
<!-- ``` -->
<!-- Dando como resultado que por cada 100 unidades monetarias que le ingresan a las mujeres se gastan 70 con un intervalo de confianza entre 0.65 y 0.76. Por último, análogamente para los hombres, la razón de gastos resulta muy similar que para las mujeres. -->
<!-- ```{r} -->
<!-- sub_Hombre %>% summarise( -->
<!--     Razon =  survey_ratio( -->
<!--       numerator = Expenditure, -->
<!--       denominator = Income, -->
<!--       level = 0.95, -->
<!--     vartype =  c("se", "ci") -->
<!--     )) -->
<!-- ``` -->
<!-- ## Estimando contrastes en encuestas de hogares -->
<!-- En muchas ocasiones, en encuestas de hogares se requiere comparar más de dos poblaciones al mismo tiempo, por ejemplo, comparar los ingresos medios de los hogares en 3 regiones o municipalidades en la postpandemia con el fin de verificar y sectorizar aquellas municipalidades o regiones donde más impacto en el desempleo y falta de ingresos tuvo el Covid-19 en los hogares. En casos como estos la diferencia de media que estudiamos en capítulos anteriores se queda corta dado que permite solo comprar parejas de poblaciones y por ende que, hacer contraste resulta una muy buena alternativa para abordar este tipo de problemas. -->
<!-- Recurriendo en las definiciones que se han trabajado en este capítulo, un contraste es una combinación lineal de parámetros de la forma: -->
<!-- \begin{eqnarray*} -->
<!-- f\left(\theta _{1},\theta_{2},...,\theta_{j}\right) & = & \sum_{j=1}^{J}a_{j}\theta_{j} -->
<!-- \end{eqnarray*} -->
<!-- Una estimación de esta función está dada por: -->
<!-- \begin{eqnarray*} -->
<!-- f\left(\hat{\theta}_{1},\hat{\theta}_{2},...,\hat{\theta}_{j}\right) & = & \sum_{j=1}^{J}a_{j}\hat{\theta}_{j} -->
<!-- \end{eqnarray*} -->
<!-- cuya varianza del estimador se calcula como sigue: -->
<!-- \begin{eqnarray*} -->
<!-- var\left(\sum_{j=1}^{J}a_{j}\hat{\theta}_{j}\right) & = & \sum_{j=1}^{J}a_{j}^{2}var\left(\hat{\theta}_{j}\right)+2\times\sum_{j=1}^{J-1}\sum_{k>j}^{J}a_{j}a_{k}\,cov\left(\hat{\theta}_{j},\hat{\theta}_{k}\right) -->
<!-- \end{eqnarray*} -->
<!-- Los procedimientos metodológicos para implementar los contrastes en diseños de muestreo complejos están desarrolladas en la función `svycontrast`. A continuación, se muestra el uso de dicha función para el cálculo de contraste en la base de datos de ejemplo, comparando el promedio de ingresos por región. -->
<!-- Como primer ejemplo, se realizará la comparación de dos poblaciones, las regiones Norte y Sur ($\bar{Y}_{Norte} - \bar{Y}_{Sur}$) y luego sí se compararán todas las regiones.  -->
<!-- Puesto que esto es un contraste en donde hay 5 regiones y solo se construirá el contraste para la región Norte y la Sur, el contraste queda definido de la siguiente manera: -->
<!-- \begin{eqnarray*} -->
<!--  & 1\times\hat{\bar{Y}}_{Norte}+\left(-1\right)\times\hat{\bar{Y}}_{Sur}+0\times\hat{\bar{Y}}_{Centro}+0\times\hat{\bar{Y}}_{Occidente}+0\times\hat{\bar{Y}}_{Oriente} -->
<!-- \end{eqnarray*} -->
<!-- que de forma matricial queda de la siguiente manera: -->
<!-- \begin{eqnarray*} -->
<!--  & \left[1,\,-1,\,0,\,0,\,0\right]\times\left[\begin{array}{c} -->
<!-- \hat{\bar{Y}}_{Norte}\\ -->
<!-- \hat{\bar{Y}}_{Sur}\\ -->
<!-- \hat{\bar{Y}}_{Centro}\\ -->
<!-- \hat{\bar{Y}}_{Occidente}\\ -->
<!-- \hat{\bar{Y}}_{Oriente} -->
<!-- \end{array}\right] -->
<!-- \end{eqnarray*} -->
<!-- Como se puede observar, en este caso el vector de contraste es $\left[1,\,-1,\,0,\,0,\,0\right]$. -->
<!-- Ahora bien, para realizar el procesos de la construcción del estimador del contraste y su varianza estimada paso a paso se inicia con calcular las medias estimadas por región con la función `svyby` como se muestra a continuación: -->
<!-- ```{r, eval =T} -->
<!-- prom_region <- svyby(formula = ~Income,  -->
<!--                       by = ~Region,  -->
<!--                       design = diseno,  -->
<!--                       FUN = svymean,  -->
<!--                       na.rm=T,  -->
<!--                       covmat = TRUE,  -->
<!--                       vartype = c("se", "ci")) -->
<!-- prom_region -->
<!-- ``` -->
<!-- La función `svyby` permite aplicar una función, en este caso la media (svymean) por región (by) utilizando el diseño muestral empleado (design). Las demás componentes de la función ya se han utilizado previamente. Como resultado de aplicar esta función se obtienen las medias estimadas de los ingresos por región. Se tomarán solo los ingresos medios estimados de las regiones Norte y Sur y calcularemos su diferencia: -->
<!-- ```{r, eval=TRUE} -->
<!-- # Paso 1: diferencia de estimaciones (Norte - Sur)  -->
<!-- 552.4 - 625.8 -->
<!-- ``` -->
<!-- El paso siguiente es calcular la matriz de varianzas y covarianzas y de allí extraer las varianzas y covarianzas de las regiones Norte y Sur: -->
<!-- ```{r,contr1_var,eval=T} -->
<!-- # Paso 2: Matriz de varianzas y covarianzas -->
<!-- vcov(prom_region) -->
<!-- ``` -->
<!-- Para calcular el error estándar de la diferencia (contraste) se usará las propiedades de la varianza como es  -->
<!-- $se\left(\hat{\bar{y}}_{Norte}-\hat{\bar{y}}_{Sur}\right)=\sqrt{var\left(\hat{\bar{y}}_{Norte}\right)+var\left(\hat{\bar{y}}_{Sur}\right)-2\,cov\left(\hat{\bar{y}}_{Norte},\hat{\bar{y}}_{Sur}\right)}$ tenemos: -->
<!-- ```{r} -->
<!-- sqrt(3065 + 3894 - 2*0) -->
<!-- ``` -->
<!-- Finalmente, la función `svycontrast` nos devuelve el contraste estimado y su error estándar. Los argumentos de esta función son los promedios de los ingresos estimados (stat) y las constantes de contraste (contrasts). -->
<!-- ```{r} -->
<!-- svycontrast(stat = prom_region,  -->
<!--             contrasts = list(diff_NS = c(1, -1, 0, 0, 0))) %>% -->
<!--             data.frame() -->
<!-- ``` -->
<!-- Obteniendo como resultado que los ingresos medios estimados para la región Sur es 73.4 unidades monetarias mayor que los ingresos en la región Norte con un error estándar de 83.42 unidades. -->
<!-- Ahora bien, si el objetivo es estimar los siguientes contrastes: -->
<!-- -   $\bar{Y}_{Norte} - \bar{Y}_{Centro}$,  -->
<!-- -   $\bar{Y}_{Sur}-\bar{Y}_{Centro}$    -->
<!-- -   $\bar{Y}_{Occidente}-\bar{Y}_{Oriente}$     -->
<!-- Que escritas de forma matricial se tiene:  -->
<!-- $$ -->
<!-- \left[\begin{array}{ccccc} -->
<!-- 1 & 0 & -1 & 0 & 0\\ -->
<!-- 0 & 1 & -1 & 0 & 0\\ -->
<!-- 0 & 0 & 0 & 1 & -1 -->
<!-- \end{array}\right] -->
<!-- $$ -->
<!-- Ahora, aplicando la función `svycontrast` en R se obtiene: -->
<!-- ```{r, eval=TRUE} -->
<!-- svycontrast(stat = prom_region,  -->
<!--             contrasts = list( -->
<!--                              Norte_sur = c(1, 0, -1, 0, 0), -->
<!--                              Sur_centro = c(0, 1, -1, 0, 0), -->
<!--                              Occidente_Oriente = c(0, 0, 0, 1, -1))) %>%                               data.frame() -->
<!-- ``` -->
<!-- De lo cual se puede concluir que, las regiones con los ingresos medios de los hogares más similares son la región sur y la región centro. -->
<!-- También es posible construir contraste en variables que estén correlacionadas. Por ejemplo, Ingreso y Sexo. Como se hizo en el ejemplo anterior, se inicia con el promedio estimado por sexo. -->
<!-- ```{r, eval=T} -->
<!-- prom_sexo <- svyby(formula = ~Income,  -->
<!--                    by = ~Sex,  -->
<!--                    design = diseno, -->
<!--                    FUN = svymean,  -->
<!--                    na.rm=T, -->
<!--                    covmat = TRUE, -->
<!--                    vartype = c("se", "ci")) -->
<!-- prom_sexo -->
<!-- ``` -->
<!-- El contraste a estimar es: -->
<!-- $$ \bar{Y}_{F} - \bar{Y}_{M}$$ -->
<!-- Por tanto, usando la función `svycontrast` se obtiene el contraste estimado:  -->
<!-- ```{r} -->
<!-- svycontrast(stat = prom_sexo, -->
<!--             contrasts = list(diff_Sexo = c(1, -1))) %>%  -->
<!--             data.frame() -->
<!-- ``` -->
<!-- Obteniendo como resultado que, en promedio, los hombres obtienen 28.3 unidades monetarias más que las mujeres con una desviación de 20.76. -->
<!-- Otra posibilidad es poder obtener resultados agregados, por ejemplo:  -->
<!-- $\hat{\bar{y}}_{Norte}+\hat{\bar{y}}_{Sur} +\hat{\bar{y}}_{Centro}$ -->
<!-- ```{r} -->
<!-- sum_region <- svyby( ~ Income,  ~ Region, -->
<!--                      diseno, svytotal, na.rm = T, -->
<!--                      covmat = TRUE, -->
<!--                      vartype = c("se", "ci")) -->
<!-- sum_region -->
<!-- ``` -->
<!-- La matriz de contraste queda como:  -->
<!-- $$ -->
<!-- \left[\begin{array}{cccccc} -->
<!-- 1 & 1 & 1 & 0 & 0 -->
<!-- \end{array}\right] -->
<!-- $$ -->
<!-- el procedimiento en R es: -->
<!-- ```{r, eval=T} -->
<!-- svycontrast(stat = sum_region, -->
<!--             contrasts = list( -->
<!--                              Agregado_NCS = c(1, 1, 1, 0, 0))) %>%                        data.frame() -->
<!-- ``` -->
<!-- Por otro lado, si se desean obtener los promedios por categorías. Por ejemplo: -->
<!-- $$ -->
<!-- \hat{\bar{y}}_{Edad} = \frac{1}{k}\sum_{k=1}^K\hat{\bar{y}}_{k} -->
<!-- $$ -->
<!-- donde $K$ es el número de categorías de la variable. En R se hace de la siguiente manera: -->
<!-- ```{r, eval=TRUE} -->
<!-- prom_edad <- svyby(formula = ~Income,  -->
<!--                    by = ~CatAge, -->
<!--                    design =  diseno,  -->
<!--                    FUN = svymean,  -->
<!--                    na.rm=T, -->
<!--                    covmat = TRUE) -->
<!-- prom_edad -->
<!-- ``` -->
<!-- Cuya matriz de contraste estaría dada por: -->
<!-- $$ -->
<!-- \left[\begin{array}{cccccc} -->
<!-- \frac{1}{6} & \frac{1}{6} & \frac{1}{6} & \frac{1}{6} & \frac{1}{6} & \frac{1}{6} -->
<!-- \end{array}\right] -->
<!-- $$ -->
<!-- El procedimiento en R es:  -->
<!-- ```{r, eval=TRUE} -->
<!-- svycontrast(stat = prom_edad,  -->
<!--             contrasts = list( -->
<!--                              agregado_edad = c(1/6, 1/6, 1/6, 1/6, 1/6, 1/6)))             %>% data.frame() -->
<!-- ``` -->
<!-- Puesto que los contrastes, como ya se mencionó, es una función lineal de parámetros, se puede también realizar contraste con parámetros tipo razón. Por ejemplo, la relación de gastos contra ingresos por sexo. A continuación, se muestran los códigos computacionales: -->
<!-- ```{r,c2, echo=TRUE, eval=T} -->
<!-- razon_sexo <- svyby( formula = ~Income,  -->
<!--                      by = ~Sex, -->
<!--                      denominator = ~Expenditure, -->
<!--                      design = diseno,  -->
<!--                      FUN = svyratio,  -->
<!--                      na.rm=T, covmat = TRUE,  -->
<!--                      vartype = c("se", "ci")) -->
<!-- razon_sexo -->
<!-- ``` -->
<!-- Cuya estimación de contraste sería: -->
<!-- ```{r} -->
<!-- svycontrast(stat = razon_sexo,  -->
<!--             contrasts = list( -->
<!--                              diff_sexo = c(1, -1))) %>% data.frame() -->
<!-- ``` -->
<!-- de lo que se puede concluir que la diferencia de las proporciones es 0.045 en favor de los hombres. -->

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="análisis-gráfico-histogramas-y-boxplot.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="referencias.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": true,
    "facebook": false,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/psirusteam/2021ASDA/04-Continuas_v0.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["Análisis de encuestas con R.pdf", "Análisis de encuestas con R.epub", "Análisis de encuestas con R.mobi"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  },
  "tconfig": null
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
