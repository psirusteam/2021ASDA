<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 10 Imputación múltiple en encuestas de hogares | Análisis de encuestas con R</title>
  <meta name="description" content="Este es el repositorio del libro Análisis de encuestas con R." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 10 Imputación múltiple en encuestas de hogares | Análisis de encuestas con R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Este es el repositorio del libro Análisis de encuestas con R." />
  <meta name="github-repo" content="psirusteam/HHS-Handbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 10 Imputación múltiple en encuestas de hogares | Análisis de encuestas con R" />
  
  <meta name="twitter:description" content="Este es el repositorio del libro Análisis de encuestas con R." />
  

<meta name="author" content="Andrés Gutiérrez, Cristian Téllez, Stalyn Guerrero" />


<meta name="date" content="2023-03-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelo-multinomial.html"/>
<link rel="next" href="imputación-por-la-media-no-condicional..html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Análisis de encuestas con R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefacio</a></li>
<li class="chapter" data-level="1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="conceptos-básicos-en-encuestas-de-hogares.html"><a href="conceptos-básicos-en-encuestas-de-hogares.html"><i class="fa fa-check"></i><b>2</b> Conceptos básicos en encuestas de hogares</a>
<ul>
<li class="chapter" data-level="2.1" data-path="universo-de-estudio-y-población-objetivo.html"><a href="universo-de-estudio-y-población-objetivo.html"><i class="fa fa-check"></i><b>2.1</b> Universo de estudio y población objetivo</a></li>
<li class="chapter" data-level="2.2" data-path="unidades-de-análisis.html"><a href="unidades-de-análisis.html"><i class="fa fa-check"></i><b>2.2</b> Unidades de análisis</a></li>
<li class="chapter" data-level="2.3" data-path="unidades-de-muestreo.html"><a href="unidades-de-muestreo.html"><i class="fa fa-check"></i><b>2.3</b> Unidades de muestreo</a></li>
<li class="chapter" data-level="2.4" data-path="marcos-de-muestreo.html"><a href="marcos-de-muestreo.html"><i class="fa fa-check"></i><b>2.4</b> Marcos de muestreo</a></li>
<li class="chapter" data-level="2.5" data-path="selección-de-una-muestra.html"><a href="selección-de-una-muestra.html"><i class="fa fa-check"></i><b>2.5</b> Selección de una muestra</a></li>
<li class="chapter" data-level="2.6" data-path="motivación.html"><a href="motivación.html"><i class="fa fa-check"></i><b>2.6</b> Motivación</a></li>
<li class="chapter" data-level="2.7" data-path="muestreo-aleatorio-simple-en-dos-etapas-estratificado.html"><a href="muestreo-aleatorio-simple-en-dos-etapas-estratificado.html"><i class="fa fa-check"></i><b>2.7</b> Muestreo aleatorio simple en dos etapas estratificado</a></li>
<li class="chapter" data-level="2.8" data-path="práctica-en-r.html"><a href="práctica-en-r.html"><i class="fa fa-check"></i><b>2.8</b> Práctica en <code>R</code></a></li>
<li class="chapter" data-level="2.9" data-path="calibrando-con-r.html"><a href="calibrando-con-r.html"><i class="fa fa-check"></i><b>2.9</b> Calibrando con <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manejando-una-base-de-encuestas-de-hogares-con-r.html"><a href="manejando-una-base-de-encuestas-de-hogares-con-r.html"><i class="fa fa-check"></i><b>3</b> Manejando una base de encuestas de hogares con R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="fundamentos-básicos-de-r-y-rstudio.html"><a href="fundamentos-básicos-de-r-y-rstudio.html"><i class="fa fa-check"></i><b>3.1</b> Fundamentos básicos de R y Rstudio</a></li>
<li class="chapter" data-level="3.2" data-path="algunas-librerías-de-interés.html"><a href="algunas-librerías-de-interés.html"><i class="fa fa-check"></i><b>3.2</b> Algunas librerías de interés</a></li>
<li class="chapter" data-level="3.3" data-path="cración-de-proyectos-en-r.html"><a href="cración-de-proyectos-en-r.html"><i class="fa fa-check"></i><b>3.3</b> Cración de proyectos en <code>R</code></a></li>
<li class="chapter" data-level="3.4" data-path="lectura-de-las-bases-de-datos-y-manipulación.html"><a href="lectura-de-las-bases-de-datos-y-manipulación.html"><i class="fa fa-check"></i><b>3.4</b> Lectura de las bases de datos y manipulación</a></li>
<li class="chapter" data-level="3.5" data-path="el-operador-pipe.html"><a href="el-operador-pipe.html"><i class="fa fa-check"></i><b>3.5</b> El operador <code>pipe</code></a></li>
<li class="chapter" data-level="3.6" data-path="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html"><i class="fa fa-check"></i><b>3.6</b> Funciones <strong>mutate, summarise y group_by</strong> en encuestas de hogares</a></li>
<li class="chapter" data-level="3.7" data-path="medidas-descriptivos-y-reflexiones.html"><a href="medidas-descriptivos-y-reflexiones.html"><i class="fa fa-check"></i><b>3.7</b> Medidas descriptivos y reflexiones</a></li>
<li class="chapter" data-level="3.8" data-path="algunas-reflexiones-generales.html"><a href="algunas-reflexiones-generales.html"><i class="fa fa-check"></i><b>3.8</b> Algunas reflexiones generales</a></li>
<li class="chapter" data-level="3.9" data-path="observación-importante.html"><a href="observación-importante.html"><i class="fa fa-check"></i><b>3.9</b> <strong>¡Observación importante!</strong></a></li>
<li class="chapter" data-level="3.10" data-path="medias-y-totales.html"><a href="medias-y-totales.html"><i class="fa fa-check"></i><b>3.10</b> Medias y totales</a></li>
<li class="chapter" data-level="3.11" data-path="medianas-y-percentiles.html"><a href="medianas-y-percentiles.html"><i class="fa fa-check"></i><b>3.11</b> Medianas y percentiles</a></li>
<li class="chapter" data-level="3.12" data-path="varianza-desviación-estándar-y-rangos.html"><a href="varianza-desviación-estándar-y-rangos.html"><i class="fa fa-check"></i><b>3.12</b> Varianza, desviación estándar y rangos</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="análisis-de-las-variables-continuas-en-encuestas-de-hogares.html"><a href="análisis-de-las-variables-continuas-en-encuestas-de-hogares.html"><i class="fa fa-check"></i><b>4</b> Análisis de las variables continuas en encuestas de hogares</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lectura-de-bases-de-datos-y-definición-del-diseño-muestral.html"><a href="lectura-de-bases-de-datos-y-definición-del-diseño-muestral.html"><i class="fa fa-check"></i><b>4.1</b> Lectura de bases de datos y definición del diseño muestral</a></li>
<li class="chapter" data-level="4.2" data-path="análisis-gráfico-histogramas-y-boxplot.html"><a href="análisis-gráfico-histogramas-y-boxplot.html"><i class="fa fa-check"></i><b>4.2</b> Análisis gráfico: Histogramas y Boxplot</a></li>
<li class="chapter" data-level="4.3" data-path="estimación-puntual.html"><a href="estimación-puntual.html"><i class="fa fa-check"></i><b>4.3</b> Estimación puntual</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="estimación-puntual.html"><a href="estimación-puntual.html#estimación-de-totales-e-intervalos-de-confianza"><i class="fa fa-check"></i><b>4.3.1</b> Estimación de totales e intervalos de confianza</a></li>
<li class="chapter" data-level="4.3.2" data-path="estimación-puntual.html"><a href="estimación-puntual.html#estimación-de-la-media-e-intervalo-de-confianza"><i class="fa fa-check"></i><b>4.3.2</b> Estimación de la media e intervalo de confianza</a></li>
<li class="chapter" data-level="4.3.3" data-path="estimación-puntual.html"><a href="estimación-puntual.html#estimación-de-medidas-de-dispersión-y-localización"><i class="fa fa-check"></i><b>4.3.3</b> Estimación de medidas de dispersión y localización</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="estimación-del-coeficiente-de-ginni-en-encuestas-de-hogares.html"><a href="estimación-del-coeficiente-de-ginni-en-encuestas-de-hogares.html"><i class="fa fa-check"></i><b>4.4</b> Estimación del coeficiente de Ginni en encuestas de hogares</a></li>
<li class="chapter" data-level="4.5" data-path="análisis-de-la-relación-entre-dos-variable-continuas.html"><a href="análisis-de-la-relación-entre-dos-variable-continuas.html"><i class="fa fa-check"></i><b>4.5</b> Análisis de la relación entre dos variable continuas</a></li>
<li class="chapter" data-level="4.6" data-path="prueba-de-hipótesis-para-la-diferencia-de-medias-en-encuestas-de-hogares.html"><a href="prueba-de-hipótesis-para-la-diferencia-de-medias-en-encuestas-de-hogares.html"><i class="fa fa-check"></i><b>4.6</b> Prueba de hipótesis para la diferencia de medias en encuestas de hogares</a></li>
<li class="chapter" data-level="4.7" data-path="estimando-razones-en-encuestas-de-hogares.html"><a href="estimando-razones-en-encuestas-de-hogares.html"><i class="fa fa-check"></i><b>4.7</b> Estimando razones en encuestas de hogares</a></li>
<li class="chapter" data-level="4.8" data-path="estimando-contrastes-en-encuestas-de-hogares.html"><a href="estimando-contrastes-en-encuestas-de-hogares.html"><i class="fa fa-check"></i><b>4.8</b> Estimando contrastes en encuestas de hogares</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="análisis-de-variables-categóricas-en-encuestas-de-hogares.html"><a href="análisis-de-variables-categóricas-en-encuestas-de-hogares.html"><i class="fa fa-check"></i><b>5</b> Análisis de variables categóricas en encuestas de hogares</a>
<ul>
<li class="chapter" data-level="5.1" data-path="estimaciones-de-totales.html"><a href="estimaciones-de-totales.html"><i class="fa fa-check"></i><b>5.1</b> Estimaciones de totales</a></li>
<li class="chapter" data-level="5.2" data-path="estimación-de-proporciones.html"><a href="estimación-de-proporciones.html"><i class="fa fa-check"></i><b>5.2</b> Estimación de proporciones</a></li>
<li class="chapter" data-level="5.3" data-path="tablas-cruzadas..html"><a href="tablas-cruzadas..html"><i class="fa fa-check"></i><b>5.3</b> Tablas cruzadas.</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modelos-de-regresión-bajo-diseños-de-muestreo-complejos.html"><a href="modelos-de-regresión-bajo-diseños-de-muestreo-complejos.html"><i class="fa fa-check"></i><b>6</b> Modelos de regresión bajo diseños de muestreo complejos</a>
<ul>
<li class="chapter" data-level="6.1" data-path="estimación-de-los-parámetros-en-un-modelo-de-regresión-con-muestras-complejas..html"><a href="estimación-de-los-parámetros-en-un-modelo-de-regresión-con-muestras-complejas..html"><i class="fa fa-check"></i><b>6.1</b> Estimación de los parámetros en un modelo de regresión con muestras complejas.</a></li>
<li class="chapter" data-level="6.2" data-path="diagnóstico-del-modelo.html"><a href="diagnóstico-del-modelo.html"><i class="fa fa-check"></i><b>6.2</b> Diagnóstico del modelo</a></li>
<li class="chapter" data-level="6.3" data-path="inferencia-sobre-los-parámetros-del-modelo.html"><a href="inferencia-sobre-los-parámetros-del-modelo.html"><i class="fa fa-check"></i><b>6.3</b> Inferencia sobre los parámetros del Modelo</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="gráficas-en-r.html"><a href="gráficas-en-r.html"><i class="fa fa-check"></i><b>7</b> Gráficas en R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="histogramas-para-graficar-variables-continuas..html"><a href="histogramas-para-graficar-variables-continuas..html"><i class="fa fa-check"></i><b>7.1</b> Histogramas para graficar variables continuas.</a></li>
<li class="chapter" data-level="7.2" data-path="agregando-densidades-y-graficando-boxplot.html"><a href="agregando-densidades-y-graficando-boxplot.html"><i class="fa fa-check"></i><b>7.2</b> Agregando densidades y graficando Boxplot</a></li>
<li class="chapter" data-level="7.3" data-path="scaterplot.html"><a href="scaterplot.html"><i class="fa fa-check"></i><b>7.3</b> Scaterplot</a></li>
<li class="chapter" data-level="7.4" data-path="diagrama-de-barras-para-variables-categoricas.html"><a href="diagrama-de-barras-para-variables-categoricas.html"><i class="fa fa-check"></i><b>7.4</b> Diagrama de barras para variables categoricas</a></li>
<li class="chapter" data-level="7.5" data-path="creando-mapas.html"><a href="creando-mapas.html"><i class="fa fa-check"></i><b>7.5</b> Creando mapas</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modelos-lineales-generalizados-en-encuestas-de-hogares.html"><a href="modelos-lineales-generalizados-en-encuestas-de-hogares.html"><i class="fa fa-check"></i><b>8</b> Modelos lineales generalizados en encuestas de hogares</a>
<ul>
<li class="chapter" data-level="8.1" data-path="prueba-de-independencia-f.html"><a href="prueba-de-independencia-f.html"><i class="fa fa-check"></i><b>8.1</b> Prueba de independencia F</a></li>
<li class="chapter" data-level="8.2" data-path="estadístico-de-wald.html"><a href="estadístico-de-wald.html"><i class="fa fa-check"></i><b>8.2</b> Estadístico de Wald</a></li>
<li class="chapter" data-level="8.3" data-path="modelo-log-lineal-para-tablas-de-contingencia.html"><a href="modelo-log-lineal-para-tablas-de-contingencia.html"><i class="fa fa-check"></i><b>8.3</b> Modelo log lineal para tablas de contingencia</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modelos-lineales-generalizados-introducción-a-la-pseudo-máxima-verosimilitud.html"><a href="modelos-lineales-generalizados-introducción-a-la-pseudo-máxima-verosimilitud.html"><i class="fa fa-check"></i><b>9</b> Modelos lineales generalizados: Introducción a la pseudo máxima verosimilitud</a>
<ul>
<li class="chapter" data-level="9.1" data-path="acerca-de-las-muestras-aleatorias-y-su-análisis.html"><a href="acerca-de-las-muestras-aleatorias-y-su-análisis.html"><i class="fa fa-check"></i><b>9.1</b> Acerca de las muestras aleatorias y su análisis</a></li>
<li class="chapter" data-level="9.2" data-path="método-de-máxima-verosimilitud.html"><a href="método-de-máxima-verosimilitud.html"><i class="fa fa-check"></i><b>9.2</b> Método de Máxima Verosimilitud</a></li>
<li class="chapter" data-level="9.3" data-path="método-de-máxima-pseudo-verosimilitud.html"><a href="método-de-máxima-pseudo-verosimilitud.html"><i class="fa fa-check"></i><b>9.3</b> Método de Máxima Pseudo-Verosimilitud</a></li>
<li class="chapter" data-level="9.4" data-path="modelo-multinomial.html"><a href="modelo-multinomial.html"><i class="fa fa-check"></i><b>9.4</b> Modelo multinomial</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="imputación-múltiple-en-encuestas-de-hogares.html"><a href="imputación-múltiple-en-encuestas-de-hogares.html"><i class="fa fa-check"></i><b>10</b> Imputación múltiple en encuestas de hogares</a>
<ul>
<li class="chapter" data-level="10.1" data-path="imputación-por-la-media-no-condicional..html"><a href="imputación-por-la-media-no-condicional..html"><i class="fa fa-check"></i><b>10.1</b> Imputación por la media no condicional.</a></li>
<li class="chapter" data-level="10.2" data-path="imputación-por-la-media-condicional.html"><a href="imputación-por-la-media-condicional.html"><i class="fa fa-check"></i><b>10.2</b> Imputación por la media condicional</a></li>
<li class="chapter" data-level="10.3" data-path="imputación-por-hot-deck-y-cold-deck.html"><a href="imputación-por-hot-deck-y-cold-deck.html"><i class="fa fa-check"></i><b>10.3</b> Imputación por Hot-deck y Cold-deck</a></li>
<li class="chapter" data-level="10.4" data-path="imputación-por-regresión.html"><a href="imputación-por-regresión.html"><i class="fa fa-check"></i><b>10.4</b> Imputación por regresión</a></li>
<li class="chapter" data-level="10.5" data-path="imputación-por-el-vecino-más-cercano.html"><a href="imputación-por-el-vecino-más-cercano.html"><i class="fa fa-check"></i><b>10.5</b> Imputación por el vecino más cercano</a></li>
<li class="chapter" data-level="10.6" data-path="imputación-por-el-vecino-más-cercano-con-regresión.html"><a href="imputación-por-el-vecino-más-cercano-con-regresión.html"><i class="fa fa-check"></i><b>10.6</b> Imputación por el vecino más cercano con regresión</a></li>
<li class="chapter" data-level="10.7" data-path="introducción-a-la-imputación-múltiple..html"><a href="introducción-a-la-imputación-múltiple..html"><i class="fa fa-check"></i><b>10.7</b> Introducción a la imputación múltiple.</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i><b>11</b> Referencias</a></li>
<li class="divider"></li>
<li><a Análisis de encuestas con R </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Análisis de encuestas con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="imputación-múltiple-en-encuestas-de-hogares" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Capítulo 10</span> Imputación múltiple en encuestas de hogares<a href="imputación-múltiple-en-encuestas-de-hogares.html#imputación-múltiple-en-encuestas-de-hogares" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>La no respuesta en encuestas de hogares es un fenómenos que desde siempre ha sucedido, más ahora después de la pandemia del Covid -19. Esto sucede por muchas razones, por ejemplo, la longitud de los cuestionarios en las encuestas, el no conocer algunas características particulares del hogar, la renuencia por entregar información sensible, entre otras. Si la no respuesta en algún indicador del estudio es muy alto, puede poner en riesgo la calidad de las estimaciones que se obtienen utilizando los estimadores clásicos.</p>
<p>Debido a este problema, se ha avanzado en la literatura especializada metodologías que permiten atacar este problema, el cual es una realidad en todas las encuestas de hogares en los distintos países. 427</p>
<p>En este sentido, alguno de los avances en la teoría de los métodos en el contexto de muestras comlejas son: imputación múltiple (MI; Van Buuren, 2012; Carpenter y Kenward, 2013; Berglund y Heeringa, 2014; Stata Corp, 2015; Raghunathan, 2016). También se encuentra en la literatura métodos como el de imputación fraccional (FI; Kim y Fuller, 2004; Kim y Shao, 2014), el Bootstrap Bayesiano de Población Finita (Zhou et al., 2016a,b), y métodos de máxima verosimilitud como los de Chambers et al., (2012).</p>
<p>El objetivo principal de este capítulo es abordar el problema de la falta de datos en encuestas de hogares, revisar las posibles causas, el impacto que tiene en la estimación de los indicadores, y mostrar algunas soluciones a la falta de datos en las encuesta.</p>
<p>Siguiendo las ideas anteriores, sea <span class="math inline">\(\boldsymbol{X}_{n \times p} = x_{ij}\)</span> una matriz completa (sin valores perdidos) de tal forma que <span class="math inline">\(X_{ij}\)</span> es el valor de la variable <span class="math inline">\(j\)</span> con <span class="math inline">\(j=1, \dots, p\)</span> e <span class="math inline">\(i\)</span> con <span class="math inline">\(i=1, \dots, n\)</span>. Adicionalmente, se define <span class="math inline">\(\boldsymbol{M}_{n \times p} = m_{ij}\)</span> una matriz indicadoradonde <span class="math inline">\(m_{ij} = 1\)</span> si el valor de <span class="math inline">\(x_{ij}\)</span> es un dato perdido y <span class="math inline">\(m_{ij}=0\)</span> si <span class="math inline">\(x_{ij}\)</span> está presente.</p>
<p>Ahora bie, note que la matriz <span class="math inline">\(M\)</span> describe el patrón de missing (datos faltantes), y su media marginal de columna puede ser interpretada como la probabilidad de que <span class="math inline">\(x_{ij}\)</span> sea missing. A continuación, se describen alguna de las particularidades de la matriz <span class="math inline">\(\boldsymbol{M}_{n \times p}\)</span>:</p>
<ul>
<li><p>La matriz <span class="math inline">\(\boldsymbol{M}_{n \times p}\)</span> presenta un comportamiento completamente al azar (MCAR): si la probabilidad de respuesta es independiente de las variables observadas y de las no observadas completamente. El mecanismo de pérdida es ignorable tanto para inferencias basadas en muestreo como en máxima verosimilitud.</p></li>
<li><p>Los valores de la matriz <span class="math inline">\(\boldsymbol{M}_{n \times p}\)</span> son al azar (MAR): si la probabilidad de respuesta es independiente de las variables no observadas completamente y no de las observadas. El mecanismo de pérdida es ignorable para inferencias basadas en máxima verosimilitud.</p></li>
<li><p>Los datos no están perdidos al azar (MNAR): si la probabilidad de respuesta no es independiente de las variables no observadas completamente y posiblemente, también, de las observadas. El mecanismo de pérdida es no ignorable.</p></li>
</ul>
<p>En las dos figuras siguientes, se ilustran los casos de observaciones perdidas de manera aleatoria y con un patrón identificado:</p>
<p><img src="Imagenes/Cap%208/fig1.png" width="250" />
<img src="Imagenes/Cap%208/fig2.png" width="250" /></p>
<p>Como se ha venido trabajando en los capítulos anteriores, primero carguemos la base de datos con la muestra seleccionada y con el fin de poder ejemplificar el tratamiento de datos faltantes, se incluiran manualmente “valores perdidos”. En este sentido, la lectura de la base se hará a continuación:</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb479-1" aria-hidden="true" tabindex="-1"></a>encuesta <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;Data/encuesta.rds&quot;</span>) </span></code></pre></div>
<p>Se filtran encuestados mayores a 15 años y se calcula la proporción de la población desempleada, inactiva y empleada antes de generar los valores faltantes. Pero antes de eso, se cargan todas las librerías que se utilizarán en este capítulo:</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb480-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">cache =</span> <span class="cn">FALSE</span>, <span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">message =</span> <span class="cn">FALSE</span>, <span class="at">error =</span> <span class="cn">FALSE</span>)</span>
<span id="cb480-2"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb480-2" aria-hidden="true" tabindex="-1"></a><span class="co">#options(digits = 4)</span></span>
<span id="cb480-3"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb480-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">tinytex.verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb480-4"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb480-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (survey)</span>
<span id="cb480-5"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb480-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(srvyr)</span>
<span id="cb480-6"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb480-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(convey)</span>
<span id="cb480-7"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb480-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TeachingSampling)</span>
<span id="cb480-8"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb480-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(printr)</span>
<span id="cb480-9"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb480-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb480-10"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb480-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb480-11"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb480-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jtools)</span>
<span id="cb480-12"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb480-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb480-13"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb480-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb480-14"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb480-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>Cálculo de las proprociones de personas desempleadas, inactivas y empleados:</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb481-1" aria-hidden="true" tabindex="-1"></a>encuesta<span class="ot">&lt;-</span> encuesta <span class="sc">|&gt;</span> <span class="fu">filter</span>(Age <span class="sc">&gt;=</span> <span class="dv">15</span>)</span>
<span id="cb481-2"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb481-2" aria-hidden="true" tabindex="-1"></a>(tab_antes <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">table</span>(encuesta<span class="sc">$</span>Employment)))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Unemployed</th>
<th align="right">Inactive</th>
<th align="right">Employed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0409792</td>
<td align="right">0.373603</td>
<td align="right">0.5854178</td>
</tr>
</tbody>
</table>
<p>También se calcula el promedio de ingresos en al muestra:</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb482-1" aria-hidden="true" tabindex="-1"></a>(med_antes <span class="ot">&lt;-</span> <span class="fu">mean</span>(encuesta<span class="sc">$</span>Income, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## [1] 604.2494</code></pre>
<p>Luego de los conteos anteriores, se genera un 20% de valores faltantes siguiendo un esquema MCAR como sigue:</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb484-2"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb484-2" aria-hidden="true" tabindex="-1"></a>encuesta_MCAR <span class="ot">&lt;-</span>  <span class="fu">sample_frac</span>(encuesta, <span class="fl">0.8</span> )</span>
<span id="cb484-3"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb484-3" aria-hidden="true" tabindex="-1"></a>dat_plot <span class="ot">&lt;-</span>       <span class="fu">bind_rows</span>(</span>
<span id="cb484-4"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb484-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">encuesta_MCAR =</span> encuesta_MCAR, </span>
<span id="cb484-5"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb484-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">encuesta =</span> encuesta), <span class="at">.id =</span> <span class="st">&quot;Caso&quot;</span>  )</span></code></pre></div>
<p>Ahora bien, para poder ver el efecto de la inclusión de datos faltantes de manera gráfica por zona y sexo para la variable ingreso, se realizan las siguientes gráficas:</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb485-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_plot, <span class="fu">aes</span>(<span class="at">x=</span>Zone, <span class="at">y =</span> Income)) <span class="sc">+</span> </span>
<span id="cb485-2"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb485-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">facet_grid</span>(.<span class="sc">~</span>Caso) <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb485-3"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb485-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(encuesta<span class="sc">$</span>Income), </span>
<span id="cb485-4"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb485-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb485-5"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb485-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb485-6"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb485-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_plot, <span class="fu">aes</span>(<span class="at">x=</span>Sex, <span class="at">y =</span> Income)) <span class="sc">+</span> </span>
<span id="cb485-7"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb485-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">facet_grid</span>(.<span class="sc">~</span>Caso) <span class="sc">+</span><span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb485-8"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb485-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(encuesta<span class="sc">$</span>Income), </span>
<span id="cb485-9"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb485-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb485-10"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb485-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb485-11"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb485-11" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">|</span>p2</span></code></pre></div>
<p><img src="11-Imputaci%C3%B3n_files/figure-html/unnamed-chunk-6-1.svg" width="672" /></p>
<p>Como se puede observar en las gráficas anteriores, la distribución de los ingresos por Zona y Sexo se mantiene similar con o sin presencia de la no respuesta. Esto se debe a que la no respuesta que se incluyó no depende de la variable de estudio.</p>
<p>Ahora bien, analizando la variable de interés se tiene que tampoco hay cambios distribucionales notables entre las distribuciones con y sin datos faltantes por sexo, como se puede observar a continuación:</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb486-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_plot, <span class="fu">aes</span>(<span class="at">x =</span> Income, <span class="at">fill =</span> Caso)) <span class="sc">+</span> </span>
<span id="cb486-2"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb486-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb486-3"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb486-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb486-4"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb486-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(encuesta<span class="sc">$</span>Income), </span>
<span id="cb486-5"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb486-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb486-6"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb486-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb486-7"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb486-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_plot, <span class="fu">aes</span>(<span class="at">x =</span> Income, <span class="at">fill =</span> Caso)) <span class="sc">+</span> </span>
<span id="cb486-8"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb486-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> <span class="fu">facet_grid</span>(.<span class="sc">~</span>Sex) <span class="sc">+</span> </span>
<span id="cb486-9"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb486-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span> </span>
<span id="cb486-10"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb486-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(encuesta<span class="sc">$</span>Income), </span>
<span id="cb486-11"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb486-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb486-12"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb486-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb486-13"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb486-13" aria-hidden="true" tabindex="-1"></a>(p1<span class="sc">/</span>p2)</span></code></pre></div>
<p><img src="11-Imputaci%C3%B3n_files/figure-html/unnamed-chunk-7-1.svg" width="672" /></p>
<p>Si graficamos ahora la varibale gastos, se tienen los mismos resultados que para ingresos.</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb487-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_plot, <span class="fu">aes</span>(<span class="at">x =</span> Expenditure, <span class="at">fill =</span> Caso)) <span class="sc">+</span> </span>
<span id="cb487-2"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb487-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb487-3"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb487-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb487-4"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb487-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(encuesta<span class="sc">$</span>Expenditure), </span>
<span id="cb487-5"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb487-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb487-6"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb487-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-7"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb487-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_plot, <span class="fu">aes</span>(<span class="at">x =</span> Expenditure, <span class="at">fill =</span> Caso)) <span class="sc">+</span> </span>
<span id="cb487-8"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb487-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> <span class="fu">facet_grid</span>(.<span class="sc">~</span>Sex) <span class="sc">+</span> </span>
<span id="cb487-9"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb487-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span> </span>
<span id="cb487-10"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb487-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(encuesta<span class="sc">$</span>Expenditure), </span>
<span id="cb487-11"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb487-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb487-12"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb487-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb487-13"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb487-13" aria-hidden="true" tabindex="-1"></a>(p1<span class="sc">/</span>p2)</span></code></pre></div>
<p><img src="11-Imputaci%C3%B3n_files/figure-html/unnamed-chunk-8-1.svg" width="672" /></p>
<p>Por otro lado, simulemos ahora una pérdida de información MAR como sigue:</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TeachingSampling)</span>
<span id="cb488-2"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb488-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb488-3"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb488-3" aria-hidden="true" tabindex="-1"></a>temp_estrato <span class="ot">&lt;-</span> <span class="fu">paste0</span>(encuesta<span class="sc">$</span>Zone, encuesta<span class="sc">$</span>Sex) </span>
<span id="cb488-4"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb488-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(temp_estrato)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">RuralFemale</th>
<th align="right">RuralMale</th>
<th align="right">UrbanFemale</th>
<th align="right">UrbanMale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">481</td>
<td align="right">428</td>
<td align="right">531</td>
<td align="right">439</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb489-1" aria-hidden="true" tabindex="-1"></a>sel <span class="ot">&lt;-</span> <span class="fu">S.STSI</span>(<span class="at">S =</span> temp_estrato, </span>
<span id="cb489-2"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb489-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">Nh =</span> <span class="fu">c</span>(<span class="dv">481</span>,<span class="dv">428</span>,<span class="dv">531</span>,<span class="dv">439</span>),</span>
<span id="cb489-3"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb489-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">nh =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">380</span>, <span class="dv">20</span>,<span class="dv">280</span>))</span>
<span id="cb489-4"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb489-4" aria-hidden="true" tabindex="-1"></a>encuesta_MAR <span class="ot">&lt;-</span> encuesta[<span class="sc">-</span>sel,]</span>
<span id="cb489-5"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb489-5" aria-hidden="true" tabindex="-1"></a>dat_plot2 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb489-6"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb489-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">encuesta_MAR =</span> encuesta_MAR,</span>
<span id="cb489-7"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb489-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">encuesta =</span> encuesta), <span class="at">.id =</span> <span class="st">&quot;Caso&quot;</span>  )</span></code></pre></div>
<p>El código anterior utiliza la librería <em>TeachingSampling</em> para realizar un muestreo aleatorio estratificado. Primero, se establece la semilla aleatoria en 1234 para asegurarse de que los resultados sean reproducibles. A continuación, se crea una variable llamada <em>temp_estrato</em> que combina dos variables de la encuesta “Zone” y “Sex” utilizando la función “paste0” para crear grupos de estratos. La función <em>table</em> se usa para mostrar la frecuencia de cada estrato.</p>
<p>Luego, se realiza el muestreo estratificado utilizando la función <em>S.STSI</em> que toma los siguientes argumentos:</p>
<ul>
<li>“S”: el vector de estratos creado anteriormente</li>
<li>“Nh”: el número de unidades en cada estrato (en este caso, 469, 411, 510 y 390)</li>
<li>“nh”: el tamaño de muestra deseado para cada estrato (en este caso, 20, 380, 20 y 280)</li>
</ul>
<p>El resultado del muestreo estratificado es un vector de índices de fila que corresponden a las observaciones seleccionadas para la muestra. Luego, se crea un nuevo conjunto de datos llamado “encuesta_MAR” que excluye las observaciones seleccionadas en la muestra.</p>
<p>Finalmente, se usa la función <em>bind_rows</em> del paquete <em>dplyr</em> para unir los dos conjuntos de datos, “encuesta” y “encuesta_MAR”, en un solo conjunto de datos llamado “dat_plot2”, con una nueva variable “Caso” que indica el caso de cada observación en el conjunto de datos.</p>
<p>Observemos gráficamente el efecto de la perdida de dinformación en una encuesta en un esquema MAR:</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb490-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_plot2, <span class="fu">aes</span>(<span class="at">x=</span> Caso, <span class="at">y =</span> Expenditure)) <span class="sc">+</span> </span>
<span id="cb490-2"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb490-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(encuesta<span class="sc">$</span>Expenditure), </span>
<span id="cb490-3"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb490-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb490-4"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb490-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb490-5"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb490-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Zone<span class="sc">~</span>Sex) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb490-6"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb490-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-7"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb490-7" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="11-Imputaci%C3%B3n_files/figure-html/unnamed-chunk-10-1.svg" width="672" /></p>
<p>En el gráfico anterior se logra observar un cambio en la distribución de los datos en las distintas desagregaciones cuando en la encuesta no se tiene pérdida de información y cuando sí se tiene con un esquema MAR. Naturalmente, esto afectaría en las estimaciones finales que se hagan de los parámetros estudiados.</p>
<p>Con mayor claridad, se puede ver el cambio distribucional en la siguiente gráfica:</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb491-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_plot2, <span class="fu">aes</span>(<span class="at">x =</span> Income, <span class="at">fill =</span> Caso)) <span class="sc">+</span> </span>
<span id="cb491-2"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb491-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb491-3"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb491-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb491-4"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb491-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(encuesta<span class="sc">$</span>Income), </span>
<span id="cb491-5"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb491-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb491-6"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb491-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-7"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb491-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_plot2, <span class="fu">aes</span>(<span class="at">x =</span> Income, <span class="at">fill =</span> Caso)) <span class="sc">+</span> </span>
<span id="cb491-8"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb491-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Sex) <span class="sc">+</span></span>
<span id="cb491-9"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb491-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb491-10"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb491-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb491-11"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb491-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(encuesta<span class="sc">$</span>Income), </span>
<span id="cb491-12"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb491-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb491-13"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb491-13" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">/</span>p2</span></code></pre></div>
<p><img src="11-Imputaci%C3%B3n_files/figure-html/MAR2-1.svg" width="672" /></p>
<p>Este comportamiento es natural que suceda en un esquema MAR de datos faltantes puesto que, como se mencionó anteriormente, cuando se dice que los datos faltantes están “missing at random” (MAR), significa que la probabilidad de que los datos estén ausentes está relacionada con los valores observados en otras variables del conjunto de datos. En otras palabras, la probabilidad de que un valor esté ausente no está relacionada con el valor real del dato en sí mismo, sino que depende de la distribución de los datos en otras variables.</p>
<p>La ventaja que tienen los mecanismo de missing MAR es que se puede estimar el valor real de los datos faltantes utilizando la información de otras variables disponibles en el conjunto de datos. Esto puede mejorar la calidad de los resultados de los análisis y evitar la necesidad de descartar observaciones con datos faltantes.</p>
<p>Otra gráfica en donde se evidencia el cambio de distribución de los gastos entre hombres y mujeres.</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb492-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_plot2, </span>
<span id="cb492-2"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb492-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Expenditure, <span class="at">fill =</span> Caso)) <span class="sc">+</span> </span>
<span id="cb492-3"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb492-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb492-4"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb492-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb492-5"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb492-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb492-6"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb492-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> <span class="fu">mean</span>(encuesta<span class="sc">$</span>Expenditure), </span>
<span id="cb492-7"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb492-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb492-8"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb492-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb492-9"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb492-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_plot2, </span>
<span id="cb492-10"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb492-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Expenditure, <span class="at">fill =</span> Caso)) <span class="sc">+</span> </span>
<span id="cb492-11"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb492-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Sex) <span class="sc">+</span></span>
<span id="cb492-12"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb492-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb492-13"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb492-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb492-14"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb492-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb492-15"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb492-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> <span class="fu">mean</span>(encuesta<span class="sc">$</span>Expenditure), </span>
<span id="cb492-16"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb492-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb492-17"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb492-17" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">/</span>p2</span></code></pre></div>
<p><img src="11-Imputaci%C3%B3n_files/figure-html/MAR3-1.svg" width="672" /></p>
<p>Ahora bien, para seguir con la ejemplificación de los esquemas de datos faltantes, generemos ahora un esquema de pérdida de información en una encuesta NMAR (siglas en inglés de “Not Missing at Random”). Como se mencionó al inicio de este capítulo, en este tipo de esquema, la probabilidad de que un dato falte está relacionada con el propio valor de ese dato, es decir, la probabilidad de que falte un dato no es aleatoria y depende de alguna característica o variable del propio dato.</p>
<p>En otras palabras, en un esquema aleatorio NMAR, la probabilidad de que falte un dato no es independiente del valor de ese dato, sino que está influenciada por algún factor que puede estar relacionado con el fenómeno que se está estudiando. Esto puede llevar a que los datos faltantes introduzcan un sesgo en los resultados del análisis estadístico, lo que hace que el manejo adecuado de los datos faltantes en este tipo de esquemas sea particularmente importante en la investigación.</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb493-1" aria-hidden="true" tabindex="-1"></a>encuesta_MNAR <span class="ot">&lt;-</span> encuesta <span class="sc">%&gt;%</span> </span>
<span id="cb493-2"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb493-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>((Income)) <span class="sc">%&gt;%</span> </span>
<span id="cb493-3"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb493-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span>1300L)</span>
<span id="cb493-4"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb493-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-5"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb493-5" aria-hidden="true" tabindex="-1"></a>dat_plot3 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb493-6"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb493-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">encuesta_MNAR =</span> encuesta_MNAR,</span>
<span id="cb493-7"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb493-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">encuesta =</span> encuesta), <span class="at">.id =</span> <span class="st">&quot;Caso&quot;</span>  )</span></code></pre></div>
<p>El código anterior tiene como objetivo crear un nuevo conjunto de datos llamado <em>encuesta_MNAR</em> que contiene las primeras 1300 observaciones del conjunto de datos original <em>encuesta</em>, ordenadas por la variable <em>Income</em>. Luego, el código une el conjunto de datos original <em>encuesta</em> con el conjunto de datos <em>encuesta_MNAR</em> usando la función <em>bind_rows()</em>, y crea una nueva variable llamada “Caso” que indica la fuente de los datos.</p>
<p>Ahora bien, para ver el efecto que tiene en una encuesta el tener datos faltante con esquema NMAR, se ilustran los siguientes gráficos:</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb494-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_plot3, <span class="fu">aes</span>(<span class="at">x =</span> Income, <span class="at">fill =</span> Caso)) <span class="sc">+</span> </span>
<span id="cb494-2"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb494-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb494-3"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb494-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb494-4"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb494-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb494-5"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb494-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> <span class="fu">mean</span>(encuesta<span class="sc">$</span>Income), </span>
<span id="cb494-6"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb494-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb494-7"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb494-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb494-8"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb494-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> <span class="fu">mean</span>(encuesta_MNAR<span class="sc">$</span>Income), </span>
<span id="cb494-9"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb494-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb494-10"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb494-10" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="11-Imputaci%C3%B3n_files/figure-html/MNAR1-1.svg" width="672" /></p>
<p>Como se puede observar en la gráfica anterior, la distribución de los ingresos cambia notablemente cuando se tienen datos faltantes con esquema NMAR, lo mismo sucede con la variable gastos, como se puede observar en la siguiente gráfica:</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb495-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_plot3, </span>
<span id="cb495-2"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb495-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Expenditure, <span class="at">fill =</span> Caso)) <span class="sc">+</span> </span>
<span id="cb495-3"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb495-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb495-4"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb495-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb495-5"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb495-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb495-6"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb495-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> <span class="fu">mean</span>(encuesta<span class="sc">$</span>Expenditure), </span>
<span id="cb495-7"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb495-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb495-8"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb495-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb495-9"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb495-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> <span class="fu">mean</span>(encuesta_MNAR<span class="sc">$</span>Expenditure), </span>
<span id="cb495-10"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb495-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb495-11"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb495-11" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="11-Imputaci%C3%B3n_files/figure-html/MNAR2-1.svg" width="672" /></p>
<p>Para ver más al detalle el impacto que tiene la no respuesta con un esquema NMAR, a continuación se muestra una gráfica del ingreso discriminada por sexo y por zona. También se nota un cambio en la distribución de los ingresos significativos.</p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb496-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_plot3, <span class="fu">aes</span>(<span class="at">x=</span> Caso, <span class="at">y =</span> Income)) <span class="sc">+</span> </span>
<span id="cb496-2"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb496-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(encuesta<span class="sc">$</span>Income),</span>
<span id="cb496-3"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb496-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb496-4"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb496-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Zone<span class="sc">~</span>Sex) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb496-5"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb496-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb496-6"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb496-6" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="11-Imputaci%C3%B3n_files/figure-html/MNAR3-1.svg" width="672" /></p>
<p>Para efectos de ejemplificar la solución del problema a los datos faltantes en una encuesta de hogares, generemos la siguiente base de datos:</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb497-1" aria-hidden="true" tabindex="-1"></a>encuesta <span class="ot">&lt;-</span> <span class="fu">full_join</span>(</span>
<span id="cb497-2"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb497-2" aria-hidden="true" tabindex="-1"></a>  encuesta,</span>
<span id="cb497-3"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb497-3" aria-hidden="true" tabindex="-1"></a>  encuesta_MCAR <span class="sc">%&gt;%</span> </span>
<span id="cb497-4"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb497-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(HHID, PersonID, Income, Employment) <span class="sc">%&gt;%</span></span>
<span id="cb497-5"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb497-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb497-6"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb497-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">Income_missin =</span> Income,</span>
<span id="cb497-7"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb497-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">Employment_missin =</span> Employment,</span>
<span id="cb497-8"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb497-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">Employment =</span> <span class="cn">NULL</span>,</span>
<span id="cb497-9"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb497-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">Income =</span> <span class="cn">NULL</span></span>
<span id="cb497-10"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb497-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb497-11"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb497-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>El código anterior utiliza la función <em>full_join()</em> de la librería <em>dplyr</em> de ´R´ para combinar dos conjuntos de datos: encuesta y encuesta_MCAR. La combinación se realiza mediante la unión completa (o full join), que devuelve todas las filas de ambas tablas, uniendo las filas con valores coincidentes y rellenando con valores faltantes para las columnas que no tienen una coincidencia en ambas tablas.</p>
<p>La segunda Base de datos, encuesta_MCAR, se transforma previamente con las siguientes operaciones:</p>
<ul>
<li><p>Se seleccionan las columnas HHID, PersonID, Income y Employment mediante la función <em>dplyr::select()</em>.</p></li>
<li><p>Se agregan dos nuevas columnas, Income_missin y Employment_missin, utilizando la función mutate().</p></li>
</ul>
<p>Los valores de estas columnas son idénticos a los de las columnas Income y Employment, respectivamente. Las columnas Income y Employment se eliminan del conjunto de datos utilizando la función <em>mutate()</em> y asignando el valor NULL a ambas columnas. Finalmente, el resultado de la unión completa se asigna a la variable encuesta.</p>
<p>Ahora bien, para tener como referencia el porcentaje de datos faltantes, se ejecuta el siguiente comando:</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb498-1" aria-hidden="true" tabindex="-1"></a>encuesta <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Zone) <span class="sc">%&gt;%</span> </span>
<span id="cb498-2"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb498-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Income =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(Income_missin) <span class="sc">/</span> <span class="fu">n</span>()))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Zone</th>
<th align="right">Income</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Rural</td>
<td align="right">0.2079208</td>
</tr>
<tr class="even">
<td align="left">Urban</td>
<td align="right">0.1927835</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb499-1" aria-hidden="true" tabindex="-1"></a>encuesta <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Sex) <span class="sc">%&gt;%</span> </span>
<span id="cb499-2"><a href="imputación-múltiple-en-encuestas-de-hogares.html#cb499-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Income =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(Income_missin) <span class="sc">/</span> <span class="fu">n</span>()))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Sex</th>
<th align="right">Income</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Female</td>
<td align="right">0.1837945</td>
</tr>
<tr class="even">
<td align="left">Male</td>
<td align="right">0.2191465</td>
</tr>
</tbody>
</table>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelo-multinomial.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="imputación-por-la-media-no-condicional..html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psirusteam/2021ASDA/11-Imputación.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Análisis de encuestas con R.pdf", "Análisis de encuestas con R.epub", "Análisis de encuestas con R.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"tconfig": null
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
