<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8.3 Método de Máxima Pseudo-Verosimilitud | Análisis de encuestas con R</title>
  <meta name="description" content="Este es el repositorio del libro Análisis de encuestas con R." />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content="8.3 Método de Máxima Pseudo-Verosimilitud | Análisis de encuestas con R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Este es el repositorio del libro Análisis de encuestas con R." />
  <meta name="github-repo" content="psirusteam/2021ASDA" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8.3 Método de Máxima Pseudo-Verosimilitud | Análisis de encuestas con R" />
  
  <meta name="twitter:description" content="Este es el repositorio del libro Análisis de encuestas con R." />
  

<meta name="author" content="Andrés Gutiérrez,Stalyn Guerrero, Cristian Téllez, Giovany Babativa" />


<meta name="date" content="2025-09-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="método-de-máxima-verosimilitud.html"/>
<link rel="next" href="modelo-multinomial.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Análisis de encuestas con R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefacio</a></li>
<li class="chapter" data-level="1" data-path="09-Generalizados2.html"><a href="#introducci%C3%B3n"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="09-Generalizados2.html"><a href="#conceptos-b%C3%A1sicos-en-encuestas-de-hogares"><i class="fa fa-check"></i><b>2</b> Conceptos básicos en encuestas de hogares</a>
<ul>
<li class="chapter" data-level="2.1" data-path="09-Generalizados2.html"><a href="#universo-de-estudio-y-poblaci%C3%B3n-objetivo"><i class="fa fa-check"></i><b>2.1</b> Universo de estudio y población objetivo</a></li>
<li class="chapter" data-level="2.2" data-path="09-Generalizados2.html"><a href="#unidades-de-an%C3%A1lisis"><i class="fa fa-check"></i><b>2.2</b> Unidades de análisis</a></li>
<li class="chapter" data-level="2.3" data-path="unidades-de-muestreo.html"><a href="unidades-de-muestreo.html"><i class="fa fa-check"></i><b>2.3</b> Unidades de muestreo</a></li>
<li class="chapter" data-level="2.4" data-path="marcos-de-muestreo.html"><a href="marcos-de-muestreo.html"><i class="fa fa-check"></i><b>2.4</b> Marcos de muestreo</a></li>
<li class="chapter" data-level="2.5" data-path="09-Generalizados2.html"><a href="#motivaci%C3%B3n"><i class="fa fa-check"></i><b>2.5</b> Motivación</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="09-Generalizados2.html"><a href="#la-importancia-de-considerar-el-dise%C3%B1o-muestral"><i class="fa fa-check"></i><b>2.5.1</b> La importancia de considerar el diseño muestral</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="09-Generalizados2.html"><a href="#par%C3%A1metros-y-estimadores"><i class="fa fa-check"></i><b>2.6</b> Parámetros y Estimadores</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="parámetros-y-estimadores.html"><a href="parámetros-y-estimadores.html"><i class="fa fa-check"></i><b>2.6.1</b> Ajustes Adicionales de los Pesos</a></li>
<li class="chapter" data-level="2.6.2" data-path="parámetros-y-estimadores.html"><a href="parámetros-y-estimadores.html#importancia-de-los-ajustes"><i class="fa fa-check"></i><b>2.6.2</b> Importancia de los Ajustes</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="09-Generalizados2.html"><a href="#estimaci%C3%B3n-de-totales"><i class="fa fa-check"></i><b>2.7</b> Estimación de totales</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="estimación-de-totales.html"><a href="estimación-de-totales.html"><i class="fa fa-check"></i><b>2.7.1</b> Ejemplo ilustrativo</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="09-Generalizados2.html"><a href="#efecto-del-dise%C3%B1o-deff"><i class="fa fa-check"></i><b>2.8</b> Efecto del diseño (DEFF)</a></li>
<li class="chapter" data-level="2.9" data-path="muestreo-aleatorio-simple-en-dos-etapas-estratificado.html"><a href="muestreo-aleatorio-simple-en-dos-etapas-estratificado.html"><i class="fa fa-check"></i><b>2.9</b> Muestreo aleatorio simple en dos etapas estratificado</a></li>
<li class="chapter" data-level="2.10" data-path="09-Generalizados2.html"><a href="#pr%C3%A1ctica-en-r"><i class="fa fa-check"></i><b>2.10</b> Práctica en <code>R</code></a></li>
<li class="chapter" data-level="2.11" data-path="calibrando-con-r.html"><a href="calibrando-con-r.html"><i class="fa fa-check"></i><b>2.11</b> Calibrando con <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manejando-una-base-de-encuestas-de-hogares-con-r.html"><a href="manejando-una-base-de-encuestas-de-hogares-con-r.html"><i class="fa fa-check"></i><b>3</b> Manejando una base de encuestas de hogares con R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="09-Generalizados2.html"><a href="#fundamentos-b%C3%A1sicos-de-r-y-rstudio"><i class="fa fa-check"></i><b>3.1</b> Fundamentos básicos de R y Rstudio</a></li>
<li class="chapter" data-level="3.2" data-path="09-Generalizados2.html"><a href="#algunas-librer%C3%ADas-de-inter%C3%A9s"><i class="fa fa-check"></i><b>3.2</b> Algunas librerías de interés</a></li>
<li class="chapter" data-level="3.3" data-path="09-Generalizados2.html"><a href="#craci%C3%B3n-de-proyectos-en-r"><i class="fa fa-check"></i><b>3.3</b> Cración de proyectos en <code>R</code></a></li>
<li class="chapter" data-level="3.4" data-path="09-Generalizados2.html"><a href="#lectura-de-las-bases-de-datos-y-manipulaci%C3%B3n"><i class="fa fa-check"></i><b>3.4</b> Lectura de las bases de datos y manipulación</a></li>
<li class="chapter" data-level="3.5" data-path="el-operador-pipe.html"><a href="el-operador-pipe.html"><i class="fa fa-check"></i><b>3.5</b> El operador <code>pipe</code></a></li>
<li class="chapter" data-level="3.6" data-path="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html"><a href="funciones-mutate-summarise-y-group_by-en-encuestas-de-hogares.html"><i class="fa fa-check"></i><b>3.6</b> Funciones <strong>mutate, summarise y group_by</strong> en encuestas de hogares</a></li>
<li class="chapter" data-level="3.7" data-path="medidas-descriptivos-y-reflexiones.html"><a href="medidas-descriptivos-y-reflexiones.html"><i class="fa fa-check"></i><b>3.7</b> Medidas descriptivos y reflexiones</a></li>
<li class="chapter" data-level="3.8" data-path="algunas-reflexiones-generales.html"><a href="algunas-reflexiones-generales.html"><i class="fa fa-check"></i><b>3.8</b> Algunas reflexiones generales</a></li>
<li class="chapter" data-level="3.9" data-path="09-Generalizados2.html"><a href="#observaci%C3%B3n-importante"><i class="fa fa-check"></i><b>3.9</b> <strong>¡Observación importante!</strong></a></li>
<li class="chapter" data-level="3.10" data-path="medias-y-totales.html"><a href="medias-y-totales.html"><i class="fa fa-check"></i><b>3.10</b> Medias y totales</a></li>
<li class="chapter" data-level="3.11" data-path="medianas-y-percentiles.html"><a href="medianas-y-percentiles.html"><i class="fa fa-check"></i><b>3.11</b> Medianas y percentiles</a></li>
<li class="chapter" data-level="3.12" data-path="09-Generalizados2.html"><a href="#varianza-desviaci%C3%B3n-est%C3%A1ndar-y-rangos"><i class="fa fa-check"></i><b>3.12</b> Varianza, desviación estándar y rangos</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="09-Generalizados2.html"><a href="#an%C3%A1lisis-de-las-variables-continuas-en-encuestas-de-hogares"><i class="fa fa-check"></i><b>4</b> Análisis de las variables continuas en encuestas de hogares</a>
<ul>
<li class="chapter" data-level="4.1" data-path="09-Generalizados2.html"><a href="#lectura-de-bases-de-datos-y-definici%C3%B3n-del-dise%C3%B1o-muestral"><i class="fa fa-check"></i><b>4.1</b> Lectura de bases de datos y definición del diseño muestral</a></li>
<li class="chapter" data-level="4.2" data-path="09-Generalizados2.html"><a href="#an%C3%A1lisis-gr%C3%A1fico-histogramas-y-boxplot"><i class="fa fa-check"></i><b>4.2</b> Análisis gráfico: Histogramas y Boxplot</a></li>
<li class="chapter" data-level="4.3" data-path="09-Generalizados2.html"><a href="#estimaci%C3%B3n-de-totales-medias-y-razones"><i class="fa fa-check"></i><b>4.3</b> Estimación de totales, medias y razones</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="09-Generalizados2.html"><a href="#estimaci%C3%B3n-puntual"><i class="fa fa-check"></i><b>4.3.1</b> Estimación puntual</a></li>
<li class="chapter" data-level="4.3.2" data-path="09-Generalizados2.html"><a href="#estimaci%C3%B3n-de-totales-e-intervalos-de-confianza"><i class="fa fa-check"></i><b>4.3.2</b> Estimación de totales e intervalos de confianza</a></li>
<li class="chapter" data-level="4.3.3" data-path="09-Generalizados2.html"><a href="#estimaci%C3%B3n-de-la-media-e-intervalo-de-confianza"><i class="fa fa-check"></i><b>4.3.3</b> Estimación de la media e intervalo de confianza</a></li>
<li class="chapter" data-level="4.3.4" data-path="09-Generalizados2.html"><a href="#estimaci%C3%B3n-de-medidas-de-dispersi%C3%B3n-y-localizaci%C3%B3n"><i class="fa fa-check"></i><b>4.3.4</b> Estimación de medidas de dispersión y localización</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="09-Generalizados2.html"><a href="#estimaci%C3%B3n-del-coeficiente-de-gini-en-encuestas-de-hogares"><i class="fa fa-check"></i><b>4.4</b> Estimación del coeficiente de Gini en encuestas de hogares</a></li>
<li class="chapter" data-level="4.5" data-path="09-Generalizados2.html"><a href="#an%C3%A1lisis-de-correlaci%C3%B3n-en-encuestas-de-hogares"><i class="fa fa-check"></i><b>4.5</b> Análisis de correlación en encuestas de hogares</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="09-Generalizados2.html"><a href="#ajuste-al-dise%C3%B1o-muestral"><i class="fa fa-check"></i><b>4.5.1</b> Ajuste al diseño muestral</a></li>
<li class="chapter" data-level="4.5.2" data-path="09-Generalizados2.html"><a href="#expresi%C3%B3n-formal"><i class="fa fa-check"></i><b>4.5.2</b> Expresión formal</a></li>
<li class="chapter" data-level="4.5.3" data-path="09-Generalizados2.html"><a href="#implementaci%C3%B3n-en-r"><i class="fa fa-check"></i><b>4.5.3</b> Implementación en R</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="09-Generalizados2.html"><a href="#an%C3%A1lisis-de-la-relaci%C3%B3n-entre-dos-variable-continuas"><i class="fa fa-check"></i><b>4.6</b> Análisis de la relación entre dos variable continuas</a></li>
<li class="chapter" data-level="4.7" data-path="09-Generalizados2.html"><a href="#pruebas-para-la-comparaci%C3%B3n-de-grupos"><i class="fa fa-check"></i><b>4.7</b> Pruebas para la comparación de grupos</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="09-Generalizados2.html"><a href="#planteamiento-general-de-hip%C3%B3tesis"><i class="fa fa-check"></i><b>4.7.1</b> Planteamiento general de hipótesis</a></li>
<li class="chapter" data-level="4.7.2" data-path="pruebas-para-la-comparación-de-grupos.html"><a href="pruebas-para-la-comparación-de-grupos.html"><i class="fa fa-check"></i><b>4.7.2</b> Diferencia de medias poblacionales</a></li>
<li class="chapter" data-level="4.7.3" data-path="09-Generalizados2.html"><a href="#estad%C3%ADstico-de-prueba-e-intervalo-de-confianza"><i class="fa fa-check"></i><b>4.7.3</b> Estadístico de prueba e intervalo de confianza</a></li>
<li class="chapter" data-level="4.7.4" data-path="pruebas-para-la-comparación-de-grupos.html"><a href="pruebas-para-la-comparación-de-grupos.html#ejemplo-aplicado-en-r"><i class="fa fa-check"></i><b>4.7.4</b> Ejemplo aplicado en <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="estimando-razones-en-encuestas-de-hogares.html"><a href="estimando-razones-en-encuestas-de-hogares.html"><i class="fa fa-check"></i><b>4.8</b> Estimando razones en encuestas de hogares</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#implementaci%C3%B3n-computacional-en-r"><i class="fa fa-check"></i>Implementación computacional en <code>R</code></a></li>
<li class="chapter" data-level="" data-path=""><a href="#interpretaci%C3%B3n-aplicada"><i class="fa fa-check"></i>Interpretación aplicada</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="estimando-contrastes-en-encuestas-de-hogares.html"><a href="estimando-contrastes-en-encuestas-de-hogares.html"><i class="fa fa-check"></i><b>4.9</b> Estimando contrastes en encuestas de hogares</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="09-Generalizados2.html"><a href="#an%C3%A1lisis-de-variables-categ%C3%B3ricas-en-encuestas-de-hogares"><i class="fa fa-check"></i><b>5</b> Análisis de variables categóricas en encuestas de hogares</a>
<ul>
<li class="chapter" data-level="5.1" data-path="09-Generalizados2.html"><a href="#tama%C3%B1o-de-poblaci%C3%B3n-y-subpoblaciones-en-encuestas-de-hogares"><i class="fa fa-check"></i><b>5.1</b> Tamaño de población y subpoblaciones en encuestas de hogares</a>
<ul>
<li class="chapter" data-level="" data-path="tamaño-de-población-y-subpoblaciones-en-encuestas-de-hogares.html"><a href="tamaño-de-población-y-subpoblaciones-en-encuestas-de-hogares.html"><i class="fa fa-check"></i>Estimaciones de totales en <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="09-Generalizados2.html"><a href="#estimaci%C3%B3n-de-proporciones"><i class="fa fa-check"></i><b>5.2</b> Estimación de proporciones</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="09-Generalizados2.html"><a href="#estimaci%C3%B3n-de-proporciones-en-r"><i class="fa fa-check"></i><b>5.2.1</b> Estimación de proporciones en <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="tablas-cruzadas.html"><a href="tablas-cruzadas.html"><i class="fa fa-check"></i><b>5.3</b> Tablas cruzadas</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="09-Generalizados2.html"><a href="#definici%C3%B3n-y-notaci%C3%B3n"><i class="fa fa-check"></i><b>5.3.1</b> Definición y notación</a></li>
<li class="chapter" data-level="5.3.2" data-path="tablas-cruzadas.html"><a href="tablas-cruzadas.html#tablas-de-doble-entrada"><i class="fa fa-check"></i><b>5.3.2</b> Tablas de doble entrada</a></li>
<li class="chapter" data-level="5.3.3" data-path="tablas-cruzadas.html"><a href="tablas-cruzadas.html#extensiones-y-aplicaciones"><i class="fa fa-check"></i><b>5.3.3</b> Extensiones y aplicaciones</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="09-Generalizados2.html"><a href="#estimaci%C3%B3n-de-proporciones-y-tablas-cruzadas"><i class="fa fa-check"></i><b>5.4</b> Estimación de proporciones y tablas cruzadas</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="estimación-de-proporciones-y-tablas-cruzadas.html"><a href="estimación-de-proporciones-y-tablas-cruzadas.html"><i class="fa fa-check"></i><b>5.4.1</b> Proporciones para variables binarias</a></li>
<li class="chapter" data-level="5.4.2" data-path="estimación-de-proporciones-y-tablas-cruzadas.html"><a href="estimación-de-proporciones-y-tablas-cruzadas.html#proporciones-para-variables-multinomiales"><i class="fa fa-check"></i><b>5.4.2</b> Proporciones para variables multinomiales</a></li>
<li class="chapter" data-level="5.4.3" data-path="estimación-de-proporciones-y-tablas-cruzadas.html"><a href="estimación-de-proporciones-y-tablas-cruzadas.html#tablas-cruzadas-o-de-contingencia"><i class="fa fa-check"></i><b>5.4.3</b> Tablas cruzadas o de contingencia</a></li>
<li class="chapter" data-level="5.4.4" data-path="estimación-de-proporciones-y-tablas-cruzadas.html"><a href="estimación-de-proporciones-y-tablas-cruzadas.html#prueba-de-independencia-chi2"><i class="fa fa-check"></i><b>5.4.4</b> Prueba de independencia <span class="math inline">\(\chi^{2}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="09-Generalizados2.html"><a href="#modelos-de-regresi%C3%B3n-en-encuestas-de-hogares"><i class="fa fa-check"></i><b>5.5</b> Modelos de regresión en encuestas de hogares</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="09-Generalizados2.html"><a href="#antecedentes-hist%C3%B3ricos-y-desarrollos-metodol%C3%B3gicos"><i class="fa fa-check"></i><b>5.5.1</b> Antecedentes históricos y desarrollos metodológicos</a></li>
<li class="chapter" data-level="5.5.2" data-path="09-Generalizados2.html"><a href="#relevancia-pr%C3%A1ctica"><i class="fa fa-check"></i><b>5.5.2</b> Relevancia práctica</a></li>
<li class="chapter" data-level="5.5.3" data-path="modelos-de-regresión-en-encuestas-de-hogares.html"><a href="modelos-de-regresión-en-encuestas-de-hogares.html"><i class="fa fa-check"></i><b>5.5.3</b> ¿Aplicar o no aplicar ponderaciones?</a></li>
<li class="chapter" data-level="5.5.4" data-path="09-Generalizados2.html"><a href="#enfoques-inferenciales-para-el-an%C3%A1lisis-de-datos"><i class="fa fa-check"></i><b>5.5.4</b> Enfoques inferenciales para el análisis de datos</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="09-Generalizados2.html"><a href="#estimaci%C3%B3n-de-los-par%C3%A1metros-en-un-modelo-de-regresi%C3%B3n-con-muestras-complejas"><i class="fa fa-check"></i><b>5.6</b> Estimación de los parámetros en un modelo de regresión con muestras complejas</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="09-Generalizados2.html"><a href="#estimaci%C3%B3n-de-par%C3%A1metros"><i class="fa fa-check"></i><b>5.6.1</b> Estimación de parámetros</a></li>
<li class="chapter" data-level="5.6.2" data-path="estimación-de-los-parámetros-en-un-modelo-de-regresión-con-muestras-complejas.html"><a href="estimación-de-los-parámetros-en-un-modelo-de-regresión-con-muestras-complejas.html"><i class="fa fa-check"></i><b>5.6.2</b> Uso de ponderaciones</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="09-Generalizados2.html"><a href="#diagn%C3%B3stico-del-modelo"><i class="fa fa-check"></i><b>5.7</b> Diagnóstico del modelo</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="09-Generalizados2.html"><a href="#coeficiente-de-determinaci%C3%B3n"><i class="fa fa-check"></i><b>5.7.1</b> Coeficiente de determinación</a></li>
<li class="chapter" data-level="5.7.2" data-path="09-Generalizados2.html"><a href="#diagn%C3%B3stico-de-los-residuales"><i class="fa fa-check"></i><b>5.7.2</b> Diagnóstico de los residuales</a></li>
<li class="chapter" data-level="5.7.3" data-path="diagnóstico-del-modelo.html"><a href="diagnóstico-del-modelo.html"><i class="fa fa-check"></i><b>5.7.3</b> Observaciones influyentes</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="09-Generalizados2.html"><a href="#inferencia-sobre-los-par%C3%A1metros-del-modelo"><i class="fa fa-check"></i><b>5.8</b> Inferencia sobre los parámetros del modelo</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="09-Generalizados2.html"><a href="#visualizaci%C3%B3n-de-datos"><i class="fa fa-check"></i><b>6</b> Visualización de datos</a>
<ul>
<li class="chapter" data-level="6.1" data-path="09-Generalizados2.html"><a href="#gr%C3%A1ficas-en-r"><i class="fa fa-check"></i><b>6.1</b> Gráficas en <code>R</code></a></li>
<li class="chapter" data-level="6.2" data-path="histogramas-para-graficar-variables-continuas.html"><a href="histogramas-para-graficar-variables-continuas.html"><i class="fa fa-check"></i><b>6.2</b> Histogramas para graficar variables continuas</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="histogramas-para-graficar-variables-continuas.html"><a href="histogramas-para-graficar-variables-continuas.html#histogramas-ponderados-y-no-ponderados"><i class="fa fa-check"></i><b>6.2.1</b> Histogramas ponderados y no ponderados</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="agregando-densidades-y-graficando-boxplot.html"><a href="agregando-densidades-y-graficando-boxplot.html"><i class="fa fa-check"></i><b>6.3</b> Agregando densidades y graficando Boxplot</a></li>
<li class="chapter" data-level="6.4" data-path="09-Generalizados2.html"><a href="#diagramas-de-dispersi%C3%B3n-scatterplots"><i class="fa fa-check"></i><b>6.4</b> Diagramas de dispersión (Scatterplots)</a></li>
<li class="chapter" data-level="6.5" data-path="diagrama-de-barras-para-variables-categoricas.html"><a href="diagrama-de-barras-para-variables-categoricas.html"><i class="fa fa-check"></i><b>6.5</b> Diagrama de barras para variables categoricas</a></li>
<li class="chapter" data-level="6.6" data-path="creando-mapas.html"><a href="creando-mapas.html"><i class="fa fa-check"></i><b>6.6</b> Creando mapas</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="modelos-lineales-generalizados-en-encuestas-de-hogares.html"><a href="modelos-lineales-generalizados-en-encuestas-de-hogares.html"><i class="fa fa-check"></i><b>7</b> Modelos lineales generalizados en encuestas de hogares</a>
<ul>
<li class="chapter" data-level="7.1" data-path="prueba-de-independencia-f.html"><a href="prueba-de-independencia-f.html"><i class="fa fa-check"></i><b>7.1</b> Prueba de independencia F</a></li>
<li class="chapter" data-level="7.2" data-path="09-Generalizados2.html"><a href="#estad%C3%ADstico-de-wald"><i class="fa fa-check"></i><b>7.2</b> Estadístico de Wald</a></li>
<li class="chapter" data-level="7.3" data-path="modelo-log-lineal-para-tablas-de-contingencia.html"><a href="modelo-log-lineal-para-tablas-de-contingencia.html"><i class="fa fa-check"></i><b>7.3</b> Modelo log lineal para tablas de contingencia</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="09-Generalizados2.html"><a href="#modelos-lineales-generalizados-introducci%C3%B3n-a-la-pseudo-m%C3%A1xima-verosimilitud"><i class="fa fa-check"></i><b>8</b> Modelos lineales generalizados: Introducción a la pseudo máxima verosimilitud</a>
<ul>
<li class="chapter" data-level="8.1" data-path="09-Generalizados2.html"><a href="#acerca-de-las-muestras-aleatorias-y-su-an%C3%A1lisis"><i class="fa fa-check"></i><b>8.1</b> Acerca de las muestras aleatorias y su análisis</a></li>
<li class="chapter" data-level="8.2" data-path="09-Generalizados2.html"><a href="#m%C3%A9todo-de-m%C3%A1xima-verosimilitud"><i class="fa fa-check"></i><b>8.2</b> Método de Máxima Verosimilitud</a></li>
<li class="chapter" data-level="8.3" data-path="09-Generalizados2.html"><a href="#m%C3%A9todo-de-m%C3%A1xima-pseudo-verosimilitud"><i class="fa fa-check"></i><b>8.3</b> Método de Máxima Pseudo-Verosimilitud</a></li>
<li class="chapter" data-level="8.4" data-path="modelo-multinomial.html"><a href="modelo-multinomial.html"><i class="fa fa-check"></i><b>8.4</b> Modelo multinomial</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modelos-multinivel-en-el-contexto-de-encuestas-de-hogares.html"><a href="modelos-multinivel-en-el-contexto-de-encuestas-de-hogares.html"><i class="fa fa-check"></i><b>9</b> Modelos multinivel en el contexto de encuestas de hogares</a>
<ul>
<li class="chapter" data-level="9.1" data-path="modelos-multinivel-en-muestras-complejas.html"><a href="modelos-multinivel-en-muestras-complejas.html"><i class="fa fa-check"></i><b>9.1</b> Modelos multinivel en muestras complejas</a></li>
<li class="chapter" data-level="9.2" data-path="09-Generalizados2.html"><a href="#estimaci%C3%B3n-de-pseudo-m%C3%A1xima-verosimilitud"><i class="fa fa-check"></i><b>9.2</b> Estimación de pseudo máxima verosimilitud</a></li>
<li class="chapter" data-level="9.3" data-path="09-Generalizados2.html"><a href="#introducci%C3%B3n-a-los-modelos-log%C3%ADstico-multinivel."><i class="fa fa-check"></i><b>9.3</b> Introducción a los modelos logístico multinivel.</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="09-Generalizados2.html"><a href="#imputaci%C3%B3n-m%C3%BAltiple-en-encuestas-de-hogares"><i class="fa fa-check"></i><b>10</b> Imputación múltiple en encuestas de hogares</a>
<ul>
<li class="chapter" data-level="10.1" data-path="09-Generalizados2.html"><a href="#imputaci%C3%B3n-por-la-media-no-condicional."><i class="fa fa-check"></i><b>10.1</b> Imputación por la media no condicional.</a></li>
<li class="chapter" data-level="10.2" data-path="09-Generalizados2.html"><a href="#imputaci%C3%B3n-por-la-media-condicional"><i class="fa fa-check"></i><b>10.2</b> Imputación por la media condicional</a></li>
<li class="chapter" data-level="10.3" data-path="09-Generalizados2.html"><a href="#imputaci%C3%B3n-por-hot-deck-y-cold-deck"><i class="fa fa-check"></i><b>10.3</b> Imputación por Hot-deck y Cold-deck</a></li>
<li class="chapter" data-level="10.4" data-path="09-Generalizados2.html"><a href="#imputaci%C3%B3n-por-regresi%C3%B3n"><i class="fa fa-check"></i><b>10.4</b> Imputación por regresión</a></li>
<li class="chapter" data-level="10.5" data-path="09-Generalizados2.html"><a href="#imputaci%C3%B3n-por-el-vecino-m%C3%A1s-cercano"><i class="fa fa-check"></i><b>10.5</b> Imputación por el vecino más cercano</a></li>
<li class="chapter" data-level="10.6" data-path="09-Generalizados2.html"><a href="#imputaci%C3%B3n-por-el-vecino-m%C3%A1s-cercano-con-regresi%C3%B3n"><i class="fa fa-check"></i><b>10.6</b> Imputación por el vecino más cercano con regresión</a></li>
<li class="chapter" data-level="10.7" data-path="09-Generalizados2.html"><a href="#introducci%C3%B3n-a-la-imputaci%C3%B3n-m%C3%BAltiple."><i class="fa fa-check"></i><b>10.7</b> Introducción a la imputación múltiple.</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i><b>11</b> Referencias</a></li>
<li class="divider"></li>
<li><a Análisis de encuestas con R </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Análisis de encuestas con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="método-de-máxima-pseudo-verosimilitud" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Método de Máxima Pseudo-Verosimilitud<a href="#m%C3%A9todo-de-m%C3%A1xima-pseudo-verosimilitud" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El anterior método tiene la particularidad de que <span class="math inline">\(y_{i}\)</span> son IID, en la vida real muchas veces no es posible poder cumplir ese supuesto. En los procedimientos actuales se recurre a obtener una muestra compleja mediante la realización de conglomerados que tengan alguna relación particular de aglomeración para luego estratificarlos y llegar al individuo de interés que nos proporcione información sobre el estudio. Con esa muestra compleja cumplimos con que todos los individuos tienen una probabilidad de inclusión desigual sin la necesidad de utilizar un marco muestral.</p>
<p>A partir de eso <em>Pfeffermann(1993)</em> discutió la posibilidad de hacer inferencia en la población partiendo de la información de una muestra, para esto se propuso crear un pseudo-parámetro que tenga en cuenta el diseño muestral, es decir, que el score <span class="math inline">\(u_{i}\)</span> sea ponderado por el inverso de la probabilidad de inclusión que denominaremos <span class="math inline">\(u_{i}\)</span>. Este método es conocido como Máxima Pseudo Verosimilitud(MPV).</p>
<p><span class="math display">\[
L(\theta)=\prod_{i=1}^{n}w_{i}f(y_{i},\theta)
\]</span>
Para un mejor manejo de esta función se sugiere aplicar propiedades de los logaritmos generando la siguiente función:</p>
<p><span class="math display">\[
l(\theta)=\sum_{i=1}^{n}\ln[w_{i}f(y_{i},\theta)]
\]</span></p>
<p>Calculando las derivadas parciales de <span class="math inline">\(L(\theta)\)</span> con respecto a <span class="math inline">\(\theta\)</span> e igualando a cero tenemos un sistema de ecuaciones como sigue:</p>
<p><span class="math display">\[
\dfrac{\partial l(\theta)}{\partial\theta}=\sum_{i=1}^{n}w_{i}u_{i}(\theta)=0
\]</span></p>
<p>donde <span class="math inline">\(ui=\partial\ln[f(y_{i},\theta)]/\partial\theta\)</span> es el vector de “score” de elementos <span class="math inline">\(i,i\in n\)</span> ponderado por <span class="math inline">\(w_{i}\)</span>, ahora definiremos <span class="math inline">\(T\)</span> como:</p>
<p><span class="math display">\[
T=\sum_{i=1}^{n}w_{i}u_{i}(\theta)=0
\]</span>
Mediante la linealización de Taylor y considerando los resultados de <em>Binder(1983)</em>, podemos obtener una varianza asintóticamente insesgada de la siguiente forma:</p>
<p><span class="math display">\[
V_{p}(\hat{\theta}_{M}PV)\cong[J(\theta_{U})]^{-1}V_{p}(T)[J(\theta_{U})]^{-1}
\]</span></p>
<p>donde,</p>
<p><span class="math display">\[
J(\theta_{U})=\sum_{i\in U}\dfrac{\partial u_{i}(\theta)}{\partial(\theta)}\mid_{\theta=\theta_{U}}
\]</span></p>
<p>La estimación de la varianza anterior está definida por:</p>
<p><span class="math display">\[
\hat{V}_{p}(\hat{\theta}_{MPV})\cong[\hat{J}(\hat{\theta}_{MPV})]^{-1}\hat{V}_{p}(T)[\hat{J}(\hat{\theta}_{MPV})]^{-1}
\]</span>
donde,</p>
<p><span class="math display">\[
\hat{J}(\theta_{MPV})=\sum_{i\in U}w_{i}\dfrac{\partial u_{i}(\theta)}{\partial(\theta)}\mid_{\theta=\theta_{MPV}}
\]</span></p>
<p><em>MPV para una distribución Bernoulli</em></p>
<p>Las ecuaciones de verosimilitud dadas anteriormente, conllevan a aplicar la técnica de pseudo-verosimilitud, para la cual, en primer lugar, se definen:</p>
<p><span class="math display">\[
u_{k}(\theta)=\frac{y_{k}-\theta}{\theta(1-\theta)}
\]</span>
Luego, las ecuaciones de pseudo-verosimilitud son:</p>
<p><span class="math display">\[
\sum_{k=1}^{n}w_{k}u_{k}(\theta)=\sum_{k=1}^{n}w_{k}\frac{y_{k}-\theta}{\theta(1-\theta)}
\]</span></p>
<p>Por lo tanto, al igualar a cero, se tiene que:</p>
<p><span class="math display">\[
\sum_{k=1}^{n}w_{k}y_{k}-\theta\sum_{k=1}^{n}w_{k}=0
\]</span></p>
<p>Por lo anterior, al despejar, se tiene que el estimador de máxima pseudo-verosimilitud, está dado por:</p>
<p><span class="math display">\[
\hat{\theta}_{MPV}=\frac{\sum_{k=1}^{n}w_{k}y_{k}}{\sum_{k=1}^{n}w_{k}}=\frac{\hat{t}_{y,\pi}}{\hat{N}}=\tilde{y}_{S}=\tilde{p}_{d}
\]</span></p>
<p>Luego, el estimador de la varianza de <span class="math inline">\(\hat{\theta}_{MPV}\)</span> es:</p>
<p><span class="math display">\[
\hat{V}_{p}(\hat{\theta}_{MPV})\cong[\hat{J}(\hat{\theta}_{MPV})]^{-1}\hat{V}_{p}(\hat{t}_{u\pi})[\hat{J}(\hat{\theta}_{MPV})]^{-1}
\]</span></p>
<p>donde</p>
<p><span class="math display">\[
\hat{J}(\theta_{MPV})=\sum_{i\in U}w_{i}\dfrac{\partial u_{i}(\theta)}{\partial(\theta)}\mid_{\theta=\hat{\theta_{MPV}}}=\frac{\hat{N}}{\tilde{y}_{S}(1-\tilde{y}_{S})}=\frac{\hat{N}}{\tilde{p}_{d}(1-\tilde{p}_{d})}
\]</span></p>
<p>Por ejemplo, bajo un muestreo aleatorio simple sin reemplazo, se tiene que el estimador de máxima pseudo-verosimilitud es <span class="math inline">\(\hat{\theta}_{MPV}=\bar{y}_{S}\)</span>. Además, la estimación de su varianza es:</p>
<p><span class="math display">\[
\hat{V}_{MAS}(\hat{t}_{u\pi})=\frac{N^{2}}{n}\left(1-\frac{n}{N}\right)S_{\hat{u}_{S}}^{2}=\frac{N^{2}}{n}\left(1-\frac{n}{N}\right)\frac{1}{n-1}\sum_{k=1}^{n}(\hat{u}_{k}-\bar{\hat{u}})^{2}
\]</span></p>
<p>Luego, teniendo en cuenta que bajo este diseño de muestreo, se tiene que <span class="math inline">\(\bar{\hat{u}}=0\)</span> y que <span class="math inline">\(\hat{N}=N\)</span>, entonces el estimador de la varianza de <span class="math inline">\(\hat{\theta}_{MPV}\)</span> es:</p>
<p><span class="math display">\[
\hat{V}_{MAS}(\hat{\theta}_{MPV})\cong\frac{1}{n}\left(1-\frac{n}{N}\right)S_{y_{S}}^{2}
\]</span>
Nótese que la anterior expresión, coincide plenamente con la estimación de la varianza de la media muestral, es decir <span class="math inline">\(\hat{V}_{MAS}(\hat{\theta}_{MPV})=\hat{V}_{MAS}(\bar{y}_{S})\)</span>.</p>
<p><em>MPV para una distribución normal</em></p>
<p>Siguiendo el mismo orden de la sección de Máxima Verosimilitud, se ilustrará el método de Máxima Pseudo Verosimilitud, suponga que <span class="math inline">\(f(y;\theta)\)</span> sigue una función de distribución normal.</p>
<p><span class="math display">\[
f(y;\theta)=\dfrac{1}{\sqrt{2\pi\sigma^{2}}}\exp\left[-\dfrac{1}{2}\left(\dfrac{y_{i}-\theta^{2}}{\sigma^{2}}\right)w_{i}\right]
\]</span></p>
<p>Aplicaremos la productoria para llegar a la probabilidad conjunta:</p>
<p><span class="math display">\[
L(\theta)=\prod_{i=1}^{n}\dfrac{1}{\sqrt{2\pi\sigma^{2}}}\exp\left[-\dfrac{1}{2}\left(\dfrac{y_{i}-\theta^{2}}{\sigma^{2}}\right)w_{i}\right]
\]</span></p>
<p>Con algo de algebra llegamos a:</p>
<p><span class="math display">\[
L(\theta)=(2\pi\sigma^{2})^{-n/2}\exp[(-\dfrac{1}{2\sigma^{2}}\sum_{i=1}^{n}(y_{i}-\theta^{2})w_{i}]
\]</span></p>
<p>Utilizamos logaritmos tenemos:</p>
<p><span class="math display">\[
l(\theta)=ln(2\pi\sigma^{2})^{-n/2}[-\dfrac{1}{2\sigma^{2}}\sum_{i=1}^{n}(y_{i}-\theta^{2})w_{i}]
\]</span>
Maximizamos la anterior expresión con derivadas parciales tenemos:</p>
<p><span class="math display">\[
\partial l(\theta)/\partial\theta=\dfrac{1}{\sigma^{2}}\sum_{i=1}^{n}(y_{i}-\theta^{2})w_{i}=0
\]</span></p>
<p>Despejando <span class="math inline">\(\theta\)</span>, se llega a un resultado interesante:</p>
<p><span class="math display">\[
\theta=\dfrac{\sum_{i=1}^{n}y_{i}}{\sum_{i=1}^{n}w_{i}}=\dfrac{\hat{t}_{y\pi}}{\hat{N}}=\tilde{Y}
\]</span></p>
<p>Esto nos conlleva que, para la función <span class="math inline">\(\theta\)</span> una estimación es el promedio muestral ponderado.</p>
<p><em>MPV para una regresión múltiple</em></p>
<p>Con el modelo de la forma <span class="math inline">\(X&#39;\beta\)</span> se tiene una matriz <span class="math inline">\(X\)</span> de dimensión <span class="math inline">\(n\times i\)</span>, donde <span class="math inline">\(n\)</span> es el tamaño de la muestra e <span class="math inline">\(i\)</span> es el número de variables predictoras, también una matriz <span class="math inline">\(W\)</span> diagonal, con los <span class="math inline">\(w_{i}\)</span>, de tamaño <span class="math inline">\(n\times n\)</span>, y, por último, se define dos vectores, uno <span class="math inline">\(Y\)</span> de tamaño <span class="math inline">\(n\)</span> como la variable de interés y otro <span class="math inline">\(\beta\)</span> de tamaño <span class="math inline">\(i\)</span>. Con estas condiciones se puede definir una función de verosimilitud de la siguiente manera. Conociendo la función de distribución normal de <span class="math inline">\(X\)</span></p>
<p><span class="math display">\[
f(Y;X\beta)=\dfrac{1}{\sqrt{2\pi\sigma^{2}}}\exp\left[-\dfrac{1}{2\sigma^{2}}(Y-X\beta)&#39;W(Y-X\beta)\right]
\]</span></p>
<p>Se halla la probabilidad conjunta matricialmente:</p>
<p><span class="math display">\[
L(Y;X\beta)=\prod_{i=1}^{n}\dfrac{1}{\sqrt{2\pi\sigma^{2}}}\exp\left[-\dfrac{1}{2\sigma^{2}}(Y-X\beta)&#39;W(Y-X\beta)\right]
\]</span>
Simplificando la anterior expresión se llega a:</p>
<p><span class="math display">\[
L(Y;X\beta)=(2\pi\sigma^{2})^{-N/2}-\exp\left[\dfrac{1}{2\sigma^{2}}(Y&#39;WY-Y&#39;WX\beta-(X\beta)&#39;WY+(X\beta)&#39;WX\beta)\right]
\]</span></p>
<p>Para poder derivar mejor, se aplica propiedades de los logaritmos:</p>
<p><span class="math display">\[
l(Y;X\beta)=ln(2\pi\sigma^{2})^{-N/2}-\dfrac{1}{2\sigma^{2}}(Y&#39;WY-Y&#39;WX\beta-(X\beta)&#39;WY+(X\beta)&#39;WX\beta)
\]</span>
Maximizando el anterior resultado conoceremos el score <span class="math inline">\(T\)</span>:</p>
<p><span class="math display">\[
T=\dfrac{\partial l(Y;X\beta)}{\partial\beta}=-\dfrac{1}{2\sigma^{2}}(-2X&#39;WY+2X&#39;WX\beta)
\]</span></p>
<p>Despejando <span class="math inline">\(\beta\)</span> tenemos el siguiente resultado:</p>
<p><span class="math display">\[
\beta=(X&#39;WX)^{-1}(X&#39;Y)
\]</span>
Con este <span class="math inline">\(\beta\)</span> podemos estimar un modelo partiendo de una muestra probabilística compleja.</p>
<p>A continuación, se ejemplifican los códigos computacionales para los modelos lineales generalizado. Inicialmente, se carga la base de datos como sigue:</p>
<p>Cargue de las bases de datos,</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="método-de-máxima-pseudo-verosimilitud.html#cb456-1" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb456-2"><a href="método-de-máxima-pseudo-verosimilitud.html#cb456-2" tabindex="-1"></a><span class="fu">library</span>(srvyr)</span>
<span id="cb456-3"><a href="método-de-máxima-pseudo-verosimilitud.html#cb456-3" tabindex="-1"></a>encuesta <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;Data/encuesta.rds&quot;</span>)</span>
<span id="cb456-4"><a href="método-de-máxima-pseudo-verosimilitud.html#cb456-4" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BigCity&quot;</span>, <span class="at">package =</span> <span class="st">&quot;TeachingSampling&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="método-de-máxima-pseudo-verosimilitud.html#cb457-1" tabindex="-1"></a>diseno <span class="ot">&lt;-</span> encuesta <span class="sc">%&gt;%</span></span>
<span id="cb457-2"><a href="método-de-máxima-pseudo-verosimilitud.html#cb457-2" tabindex="-1"></a>  <span class="fu">as_survey_design</span>(</span>
<span id="cb457-3"><a href="método-de-máxima-pseudo-verosimilitud.html#cb457-3" tabindex="-1"></a>    <span class="at">strata =</span> Stratum,</span>
<span id="cb457-4"><a href="método-de-máxima-pseudo-verosimilitud.html#cb457-4" tabindex="-1"></a>    <span class="at">ids =</span> PSU,</span>
<span id="cb457-5"><a href="método-de-máxima-pseudo-verosimilitud.html#cb457-5" tabindex="-1"></a>    <span class="at">weights =</span> wk,</span>
<span id="cb457-6"><a href="método-de-máxima-pseudo-verosimilitud.html#cb457-6" tabindex="-1"></a>    <span class="at">nest =</span> T</span>
<span id="cb457-7"><a href="método-de-máxima-pseudo-verosimilitud.html#cb457-7" tabindex="-1"></a>  )</span></code></pre></div>
<p>Luego, se define la variable pobreza con los datos de la base como sigue:</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="método-de-máxima-pseudo-verosimilitud.html#cb458-1" tabindex="-1"></a>diseno <span class="ot">&lt;-</span> diseno <span class="sc">%&gt;%</span> </span>
<span id="cb458-2"><a href="método-de-máxima-pseudo-verosimilitud.html#cb458-2" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb458-3"><a href="método-de-máxima-pseudo-verosimilitud.html#cb458-3" tabindex="-1"></a>  <span class="at">pobreza =</span> <span class="fu">ifelse</span>(Poverty <span class="sc">!=</span> <span class="st">&quot;NotPoor&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb458-4"><a href="método-de-máxima-pseudo-verosimilitud.html#cb458-4" tabindex="-1"></a>  <span class="at">desempleo =</span> <span class="fu">ifelse</span>(Employment <span class="sc">==</span> <span class="st">&quot;Unemployed&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span></code></pre></div>
<p>A continuación, se carga el tema de la CEPAL con el que se realizarán las gráficas:</p>
<p>Para la ejemplificación de la metodología de este capítulo, se definirá primero el modelo Gamma.</p>
<p><em>Modelo gamma para variable continua</em></p>
<p>La función de enlace <span class="math inline">\(g(\cdot)\)</span> para el GLM con una variable dependiente distribuida por un modelo Gamma es el recíproco, <span class="math inline">\(\frac{1}{\mu_{i}}\)</span>. Eso significa que el valor esperado de <span class="math inline">\(y_i\)</span> observado, (<span class="math inline">\(E(y_i) = \mu_i\)</span>), está relacionado con sus variables de entrada como, por ejemplo,</p>
<p><span class="math display">\[
\frac{1}{\mu_{i}} = B_0 + B_1x_1
\]</span>
o, similarmente:</p>
<p><span class="math display">\[
\mu_{i} = \frac{1}{B_0 + B_1x_1}
\]</span>
Ahora bien, para el ajuste del modelo Gamma, primero se definen los pesos qweigth como sigue:</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="método-de-máxima-pseudo-verosimilitud.html#cb459-1" tabindex="-1"></a>mod_qw <span class="ot">&lt;-</span> <span class="fu">lm</span>(wk <span class="sc">~</span> Age <span class="sc">+</span> Sex <span class="sc">+</span> Region <span class="sc">+</span> Zone,</span>
<span id="cb459-2"><a href="método-de-máxima-pseudo-verosimilitud.html#cb459-2" tabindex="-1"></a>             <span class="at">data =</span> encuesta)</span>
<span id="cb459-3"><a href="método-de-máxima-pseudo-verosimilitud.html#cb459-3" tabindex="-1"></a></span>
<span id="cb459-4"><a href="método-de-máxima-pseudo-verosimilitud.html#cb459-4" tabindex="-1"></a>encuesta<span class="sc">$</span>wk2 <span class="ot">&lt;-</span>   encuesta<span class="sc">$</span>wk<span class="sc">/</span><span class="fu">predict</span>(mod_qw)</span>
<span id="cb459-5"><a href="método-de-máxima-pseudo-verosimilitud.html#cb459-5" tabindex="-1"></a></span>
<span id="cb459-6"><a href="método-de-máxima-pseudo-verosimilitud.html#cb459-6" tabindex="-1"></a>diseno <span class="ot">&lt;-</span> encuesta <span class="sc">%&gt;%</span></span>
<span id="cb459-7"><a href="método-de-máxima-pseudo-verosimilitud.html#cb459-7" tabindex="-1"></a>  <span class="fu">as_survey_design</span>( <span class="at">strata =</span> Stratum,</span>
<span id="cb459-8"><a href="método-de-máxima-pseudo-verosimilitud.html#cb459-8" tabindex="-1"></a>    <span class="at">ids =</span> PSU, <span class="at">weights =</span> wk2,</span>
<span id="cb459-9"><a href="método-de-máxima-pseudo-verosimilitud.html#cb459-9" tabindex="-1"></a>    <span class="at">nest =</span> T)</span></code></pre></div>
<p>El modelo ajustado es el siguiente:</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="método-de-máxima-pseudo-verosimilitud.html#cb460-1" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(<span class="at">formula =</span> Income <span class="sc">~</span> Age <span class="sc">+</span> Sex <span class="sc">+</span></span>
<span id="cb460-2"><a href="método-de-máxima-pseudo-verosimilitud.html#cb460-2" tabindex="-1"></a>                   Region <span class="sc">+</span> Zone,</span>
<span id="cb460-3"><a href="método-de-máxima-pseudo-verosimilitud.html#cb460-3" tabindex="-1"></a>                   <span class="at">design =</span> diseno, </span>
<span id="cb460-4"><a href="método-de-máxima-pseudo-verosimilitud.html#cb460-4" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">&quot;inverse&quot;</span>)) </span>
<span id="cb460-5"><a href="método-de-máxima-pseudo-verosimilitud.html#cb460-5" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(modelo)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.0024054</td>
<td align="right">0.0002192</td>
<td align="right">10.9726242</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">Age</td>
<td align="right">-0.0000018</td>
<td align="right">0.0000014</td>
<td align="right">-1.2837541</td>
<td align="right">0.2018776</td>
</tr>
<tr class="odd">
<td align="left">SexMale</td>
<td align="right">-0.0000910</td>
<td align="right">0.0000494</td>
<td align="right">-1.8422509</td>
<td align="right">0.0680837</td>
</tr>
<tr class="even">
<td align="left">RegionSur</td>
<td align="right">-0.0000528</td>
<td align="right">0.0002279</td>
<td align="right">-0.2315853</td>
<td align="right">0.8172827</td>
</tr>
<tr class="odd">
<td align="left">RegionCentro</td>
<td align="right">0.0000305</td>
<td align="right">0.0002202</td>
<td align="right">0.1382979</td>
<td align="right">0.8902533</td>
</tr>
<tr class="even">
<td align="left">RegionOccidente</td>
<td align="right">0.0002363</td>
<td align="right">0.0002317</td>
<td align="right">1.0196070</td>
<td align="right">0.3101123</td>
</tr>
<tr class="odd">
<td align="left">RegionOriente</td>
<td align="right">0.0000088</td>
<td align="right">0.0002747</td>
<td align="right">0.0319219</td>
<td align="right">0.9745911</td>
</tr>
<tr class="even">
<td align="left">ZoneUrban</td>
<td align="right">-0.0009295</td>
<td align="right">0.0001906</td>
<td align="right">-4.8762260</td>
<td align="right">0.0000036</td>
</tr>
</tbody>
</table>
<p>De la tabla anterior, el intercepto, la variable edad y la zona rural resultaron significativo tomando una confianza del 95%.</p>
<p>Por otro lado, es útil la estimación de la dispersión que ofrece <em>svyglm</em> de forma predeterminada dado que no tiene en cuenta la información especial sobre la dispersión que se puede calcular utilizando la distribución Gamma. <strong>No todos los GLM tienen una forma mejorada y específica del modelo para estimar</strong>.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="método-de-máxima-pseudo-verosimilitud.html#cb461-1" tabindex="-1"></a>alpha <span class="ot">=</span> MASS<span class="sc">::</span><span class="fu">gamma.dispersion</span>(modelo)</span>
<span id="cb461-2"><a href="método-de-máxima-pseudo-verosimilitud.html#cb461-2" tabindex="-1"></a>alpha</span></code></pre></div>
<pre><code>## [1] 0.4830962</code></pre>
<p>Luego, el parámetro de dispersión es:</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="método-de-máxima-pseudo-verosimilitud.html#cb463-1" tabindex="-1"></a>mod_s <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelo, <span class="at">dispersion =</span> alpha)</span>
<span id="cb463-2"><a href="método-de-máxima-pseudo-verosimilitud.html#cb463-2" tabindex="-1"></a>mod_s<span class="sc">$</span>dispersion</span></code></pre></div>
<pre><code>##      variance     SE
## [1,]  0.59097 0.0876</code></pre>
<p>Los coeficientes del modelo también se pueden obtener de la siguiente manera:</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="método-de-máxima-pseudo-verosimilitud.html#cb465-1" tabindex="-1"></a>mod_s<span class="sc">$</span>coefficients</span></code></pre></div>
<table>
<colgroup>
<col width="23%" />
<col width="16%" />
<col width="16%" />
<col width="16%" />
<col width="27%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.0024054</td>
<td align="right">0.0002192</td>
<td align="right">10.9726242</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">Age</td>
<td align="right">-0.0000018</td>
<td align="right">0.0000014</td>
<td align="right">-1.2837541</td>
<td align="right">0.2018776</td>
</tr>
<tr class="odd">
<td align="left">SexMale</td>
<td align="right">-0.0000910</td>
<td align="right">0.0000494</td>
<td align="right">-1.8422509</td>
<td align="right">0.0680837</td>
</tr>
<tr class="even">
<td align="left">RegionSur</td>
<td align="right">-0.0000528</td>
<td align="right">0.0002279</td>
<td align="right">-0.2315853</td>
<td align="right">0.8172827</td>
</tr>
<tr class="odd">
<td align="left">RegionCentro</td>
<td align="right">0.0000305</td>
<td align="right">0.0002202</td>
<td align="right">0.1382979</td>
<td align="right">0.8902533</td>
</tr>
<tr class="even">
<td align="left">RegionOccidente</td>
<td align="right">0.0002363</td>
<td align="right">0.0002317</td>
<td align="right">1.0196070</td>
<td align="right">0.3101123</td>
</tr>
<tr class="odd">
<td align="left">RegionOriente</td>
<td align="right">0.0000088</td>
<td align="right">0.0002747</td>
<td align="right">0.0319219</td>
<td align="right">0.9745911</td>
</tr>
<tr class="even">
<td align="left">ZoneUrban</td>
<td align="right">-0.0009295</td>
<td align="right">0.0001906</td>
<td align="right">-4.8762260</td>
<td align="right">0.0000036</td>
</tr>
</tbody>
</table>
<p>Una vez estimado los coeficientes, se estiman los intervalos de confianza para la predicción como sigue:</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="método-de-máxima-pseudo-verosimilitud.html#cb466-1" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">predict</span>(modelo, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, <span class="at">se =</span> T))</span>
<span id="cb466-2"><a href="método-de-máxima-pseudo-verosimilitud.html#cb466-2" tabindex="-1"></a></span>
<span id="cb466-3"><a href="método-de-máxima-pseudo-verosimilitud.html#cb466-3" tabindex="-1"></a>pred_IC <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">confint</span>(<span class="fu">predict</span>(modelo, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, <span class="at">se =</span> T)))</span>
<span id="cb466-4"><a href="método-de-máxima-pseudo-verosimilitud.html#cb466-4" tabindex="-1"></a><span class="fu">colnames</span>(pred_IC) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Lim_Inf&quot;</span>, <span class="st">&quot;Lim_Sup&quot;</span>)</span>
<span id="cb466-5"><a href="método-de-máxima-pseudo-verosimilitud.html#cb466-5" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(pred, pred_IC)</span>
<span id="cb466-6"><a href="método-de-máxima-pseudo-verosimilitud.html#cb466-6" tabindex="-1"></a>pred<span class="sc">$</span>Income <span class="ot">&lt;-</span> encuesta<span class="sc">$</span>Income</span>
<span id="cb466-7"><a href="método-de-máxima-pseudo-verosimilitud.html#cb466-7" tabindex="-1"></a>pred<span class="sc">$</span>Age <span class="ot">&lt;-</span> encuesta<span class="sc">$</span>Age</span>
<span id="cb466-8"><a href="método-de-máxima-pseudo-verosimilitud.html#cb466-8" tabindex="-1"></a>pred <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span><span class="dt">L</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">response</th>
<th align="right">SE</th>
<th align="right">Lim_Inf</th>
<th align="right">Lim_Sup</th>
<th align="right">Income</th>
<th align="right">Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">456.8271</td>
<td align="right">41.80366</td>
<td align="right">374.8934</td>
<td align="right">538.7607</td>
<td align="right">409.87</td>
<td align="right">68</td>
</tr>
<tr class="even">
<td align="right">434.3813</td>
<td align="right">38.07031</td>
<td align="right">359.7649</td>
<td align="right">508.9977</td>
<td align="right">409.87</td>
<td align="right">56</td>
</tr>
<tr class="odd">
<td align="right">423.5225</td>
<td align="right">37.33444</td>
<td align="right">350.3483</td>
<td align="right">496.6966</td>
<td align="right">409.87</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="right">441.2123</td>
<td align="right">39.35438</td>
<td align="right">364.0792</td>
<td align="right">518.3455</td>
<td align="right">409.87</td>
<td align="right">26</td>
</tr>
<tr class="odd">
<td align="right">416.6866</td>
<td align="right">37.77570</td>
<td align="right">342.6476</td>
<td align="right">490.7257</td>
<td align="right">409.87</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">436.1285</td>
<td align="right">38.36471</td>
<td align="right">360.9351</td>
<td align="right">511.3219</td>
<td align="right">823.75</td>
<td align="right">61</td>
</tr>
</tbody>
</table>
<p>A continuación, como se ha mostrado anteriormente, se realiza un Scaterplot de la predicción:</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="método-de-máxima-pseudo-verosimilitud.html#cb467-1" tabindex="-1"></a>pd <span class="ot">&lt;-</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.2</span>)</span>
<span id="cb467-2"><a href="método-de-máxima-pseudo-verosimilitud.html#cb467-2" tabindex="-1"></a><span class="fu">ggplot</span>(pred <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span><span class="dt">L</span>),</span>
<span id="cb467-3"><a href="método-de-máxima-pseudo-verosimilitud.html#cb467-3" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Age , <span class="at">y =</span> response)) <span class="sc">+</span></span>
<span id="cb467-4"><a href="método-de-máxima-pseudo-verosimilitud.html#cb467-4" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Lim_Inf,</span>
<span id="cb467-5"><a href="método-de-máxima-pseudo-verosimilitud.html#cb467-5" tabindex="-1"></a>                    <span class="at">ymax =</span> Lim_Sup),</span>
<span id="cb467-6"><a href="método-de-máxima-pseudo-verosimilitud.html#cb467-6" tabindex="-1"></a>                <span class="at">width =</span> .<span class="dv">1</span>,</span>
<span id="cb467-7"><a href="método-de-máxima-pseudo-verosimilitud.html#cb467-7" tabindex="-1"></a>                <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb467-8"><a href="método-de-máxima-pseudo-verosimilitud.html#cb467-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> pd) <span class="sc">+</span></span>
<span id="cb467-9"><a href="método-de-máxima-pseudo-verosimilitud.html#cb467-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="09-Generalizados2_files/figure-html/unnamed-chunk-14-1.svg" width="672" /></p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="método-de-máxima-verosimilitud.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modelo-multinomial.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": true,
    "facebook": false,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/psirusteam/2021ASDA/09-Generalizados2.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["Análisis de encuestas con R.pdf", "Análisis de encuestas con R.epub", "Análisis de encuestas con R.mobi"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  },
  "tconfig": null
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
